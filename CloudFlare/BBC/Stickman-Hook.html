<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Stickman Hook</title>
    <link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAAXNSR0IArs4c6QAADLRJREFUaEPdWguMVNUZ/s65987szCKuNVVBVox1fVSqLVGRZ9OXVaFqrTG2FZZYJQQQBKTWKgZ00YhpfQWS+qDVlPogFSVWtIZiYny0qNsCSuWhlcpj3WV32dnZ2Z2595z2/885d+4uq+0uY2J7EzIzcGfu+c73f9//OIhss9b4P7jE/xQQ2nJx6K5fWQV87oEIoSD9CJACwgOE0IDQKOYCCCFQ5wHrj/ycA/HCLiDwDIBAQHsC0idWFAQ0olDiDpXC7MwnAGHU0rLIVFoZaQEV9cNtpTWmFGSxB5AawhOALwEPkBaM8DSkBBYKiXnCx4S2XkBosXQDUQkInygEA5JSQ0sNKAFVlFBF7zMFJApFiGIRIpDQtBYLRvC6BOAJNKQ8zJESj+oIi9pkWSNClSCkhufRounLhMCIi3+I6CRAxI4STFKxI11pLoCSAg528WJp1xEA8Om9gA4kCMydWR+zAg+vaoVpOkRLURggIgohVYm/bERFr5o/C0kgymCYbhtqOpQodqbiyKsIqmIE0ZrnZxMbkjY0EMwEkXFZdYDlQ3zktcaZxQjgyIkgqvcWtYiIDbNgBsMAKKwIEPh9zJBU7BoERggg6vFQ6goqB6Yngm7utOFE+iiDGV3l4YGaAE1a4/JCxOzwWskMsu/nNKOW4JDyaCdohRYM3aSlpdaCExYMa0oAqiRRzKUqQgh6Quh9nSacAhvePvCltI/fHJfGXqUxN1dCCy2eTcBEkKjemePVSF9Ck1tRbJIEmA2ilBgxwJixfsKMcBcOpNnXD/vqDqH25GJGKKTOzHr4fW0W7Vpjwv4CSr6E9Eg70jBG2qne3qnL4SOYFfPZAEmGGVPJIehCj+LTeLpSAqWDFRB/pIHmLqiuIjwpMPnoFBqGV6FLAWP/2QWPhGI1YzZaINIpiOptHdqI3CzSCN28J9dgZhx9xBjtAruZA2M0oyOgVCkXK4RQTXncOjyNGcek8Vo+wjV7CsgT4QSC1uTA+B4iEUBkt3Zo0gElHCPuBBhrgSbMDEvmXssWa8mUDVooqIKPqJtuOPxrRSpC/VAPL3eUMP2DAppp7+yzOcvTRlf50Kk0e6jIbjlIFmTdipKfRWxFzkIiQTtfd0Bj4Bag0Ah7BKICxd/AryyAKNJI+8CCrMANGeCjkkJdYwc/n+XHecRudEpAD62OHyQymw+ySfGO0xtKQBw2prYxNmwsmGItZqSXRZv7IgLSDyOEeZSncawHvFR0WcisgbxuQgBctKMRX//rm2gZdQZGnjMOr4XANTnjLzpXhC5QiqANl8DQtHlNXCLT2G7FbmFTqPQTZsyM0wznFRtuLswk2bCHqLv3A26vBvy2Fqy/fzmGSWD7iDpcMv1aPNQN7FXAiqCAD558DEc/uxb1+5ux9ugarP/5Mrww6jyUBkCsyGxq09p6MlPoEmECTDmnSFOmsGY0BDNkdEJsUR0WlcpAllQDG+ovRe2BA1jytTHQzR+javt2XH3qSZh90xJ8ua4OF48djXnaw/dDIC0E6k+uRd2K1bgHmQHAABhIr4xuw4z/jmsck3SMwGnxRjMUdhxyHoEDJ9Gwh+LSXBcEGl+9fwmmrl2H4cOOR/DIwwhvWQz19tvYDI0XL/wOtr31Fh5raUdJA/t0hAUjazH/yXW4rUvj9XBgOUlU/blVH1KeMDOkEVdjWYHxztsc4wzCftZCIgoNEOLkyv27MGHZTbj4vV3IkuZOPRXo7ITes4fvWatKGCN8fEEAa8IetEyahHTDPVhcTJnKYoCXqHqtVbOF9q21mBmb/gmALVtMjnEAndtJKB1Aa7MAgrNqy5/QOn8epnr9J8kCgNWqiFczaUyeMxeNEy/AQ5kvIhwgAHe7qHr1gOlSnDMlC0cbQi5/kKsZTVA9ZpoetmY/gKJawV4EZM07G7H7+utxlSyHWy+XAXAJerB60xZcnQNeGoiy+wErMo0dmqyNje6TmHHlvQsrZwQWlPJp18vhQKT9aFcjRt26CFNb2pDpZ2KwTpUw7qk1OKmmDv4gQqkvFpFt0lo1dQKddktcfkgw48wgZsbmFEpQKpWyVmd+enJK45uBQMvWRrxyxy1Y+eFejGA/L1+7tMLzk8ajedFtWJE5CsKPTCnOrbSppgd6mSmK0tCtBaCtBxzmnN3JiawWbINlPtseYEgVtMf1CT9zWbXGlEDj5oXXoWnXDjQUIhzT1objhYBv0hqz9j4U7j2tDj+4byWuyx6JJnYHClN6QwYqoPhec3/UGfxXbfUh4yC1OwehqXbSEMqMXjiLpshmqVuTwBFVXMqMLuUxv9CCcb7AlG9NwtnVQ3Cjn8IwLU1LbENqq1a4JgA6h1TjvhUPo+OkkzGTuju7aaYGoYGHgWHahXInSp9LHSloJfhPf9cnzrV0KQI6igyKxX1ECsIvh8gsr4iR9yzFvnXPok5I/FCaxqodGs+pEN+WEsfBwwFoLExLjL/zF9g4+jz8MTTFtus+zaJdEWryFIOiP8xQeRBKSwk7U1DhoaE36AHd/qocbhg/Fg/4lIE1tukIy0sFFKVEHhqr/AyOgMCcfDumPPIo7j79XLyraIBBC5cmqSad0vY53LjRvIAA8CsRlJjq0iSnJE17nbgGDeQNP4eLxpwFlQ4Q6AiPP/gYRtSegEUL52LVzg8RQKChVMC0Z9bh3OoRCLUqd520QAuGyxtbTVAi5MKVwoqAcZiZsVQSDLUNCkCxtVzGDBpItQCeGgpo8goAv27rwjm/ugsTn3kOZ7ABCPw2CjHs9qW4e+x38Vbo5mR2KuM6zSQztmHj6tuVSvTrfZgx/qK5SC11pkAhN2ggSVpvzGoEy36GietfxDnCx/KoGycKiStkgDUqxEdz5uBvl9Xj+Z6Iv8Z1mi2Dei3aVg1xA0LMOOFz89aHGQClfICo6B0+kHkZjQNLF+LClzbgQunj5qgbkx9YiQWzZuBOvwrfkAHeGHYsNq36HZZGaUi7oLj3Z/8gBoypuDBzYJLMmAFhH81owYPCw2LkKKGxpHMfVtdfjhdzReyGwuKwB1sR4U2fej6JVmjMOOVETH7wCSzqoOaIhG52t9cgg8PJtAim77ENng0zNob+NEOhqRIj04FmUjLbue0fIdNwE36y+V1e2OKoGz+WKYwRHvZphb8EHjZPHIfM1dfh78eegGcKockVtoejlBBPa/jvCAQFvBuAWGuONWMtuU+Y8fcGe9CzKujCuzOno/69nTheeJjpKwyvqcHslnYcBeCOk0/E0OkzsO2MMXhapaDcLlNw2AmMcSg7qeGC1IZZrBXbEzjk1s3csCNpzYMCQiVESzqHFRPHY56XxrQwj0tvvQ2px5/A9z7YjTOjPO7asAnXtgMFl+F5rGTDiXOEsVpzcENgKHaUGc1azcTTG86gjp2ENVs348Q5GEY2HKkx9aw6bM3WYJfSWFo7DPMfX4dX/vA0Xl77BGq/cjZGXrsADa3FRKZ2gqaWwdZeNrQ4ObJm6N9cdqdypWwArJFPY2YwQDbWAFeNPh1bUtX4aakL57/wMq74OIOzsgLnD/WxMa/wJlltPMSzo9ZkbRWXIm6cZO6JR7VchZTba7beRJ4xUx9jzzRTGxQjp0hg5fbXce/cWbhs5mz8cso0bNlbMDtmz1SMosutsVsIvVLBaTpOazEJAziEmQSYvtZscpEFNBhG6PHUD57mAe9EgD5YhO4o2CTndGDbAZe5e4G0LNBcwNZ/rlikzWA3Y61YzQjTkZoNMJtD5QxHKG/cIDVyiFU35XmAFs+P6cG8U66ytQ8kEXPSSzhXAgxvfixsqgBMcemGh3xa4Cah9jdcCzCo0OoLRDd3AfmiWbnbJXfSFevC6sTOkd0RBZ/NWNZYFW7OTKWM+w33HUbq7jGgYjMbbGj1AtMTQu3tjBOdWwAfpHJYfEqYOX30CTMWttU7WTMnSmvZjm06oKVQ5Kq5EkB47ruj3YaAISYuQWLb7A0mdjRTKJczvDML7hbNQuM8Ew8ISUdWMzSqpWdUAghtnNpJh92W+lgbZS24MHAlijlQsuW6vZ8ze8IUHIhyE2ZO1cy00zAdD9krBUTvaEsUgn2EnhBsuU+3BmCLRA6jWMj2VNnWX+X/vGCmn8kWwBlExRhBKYT6R87sEruLbWd5B202d05mFx3nnL7MuEF6P2HGIctu5oYVdrRbKUbooF/vyUHTa9w09WXGnXA5ISdK9v8QZnHVzG5WLiZdmFWOEQ2ejenW7tht4rNGK2hajAPpXInYMr2HcyXbw7vxbJz0bOhZGTlmXH9fOSCseM2soDsyIzYuR0wWdk7GU35XLDqLTeaWJDOJIww7Bii3APQ4m1PUv8+9/gXlbZN6sbpX9wAAAABJRU5ErkJggg==">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
    <style>
      html,
      body {
        position: absolute;
        top: 0px;
        left: 0px;
        margin: 0;
        padding: 0;
        border: 0;
        overflow: hidden;
        width: 100vw;
        height: 100vh;
        background-color: black;
      }
      canvas {
        width: 100%;
      }
    </style>
    <script>
! function(e) {
    var n = {};

    function t(o) {
        if (n[o]) return n[o].exports;
        var r = n[o] = {
            i: o,
            l: !1,
            exports: {}
        };
        return e[o].call(r.exports, r, r.exports, t), r.l = !0, r.exports
    }
    t.m = e, t.c = n, t.d = function(e, n, o) {
        t.o(e, n) || Object.defineProperty(e, n, {
            enumerable: !0,
            get: o
        })
    }, t.r = function(e) {
        "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {
            value: "Module"
        }), Object.defineProperty(e, "__esModule", {
            value: !0
        })
    }, t.t = function(e, n) {
        if (1 & n && (e = t(e)), 8 & n) return e;
        if (4 & n && "object" == typeof e && e && e.__esModule) return e;
        var o = Object.create(null);
        if (t.r(o), Object.defineProperty(o, "default", {
                enumerable: !0,
                value: e
            }), 2 & n && "string" != typeof e)
            for (var r in e) t.d(o, r, function(n) {
                return e[n]
            }.bind(null, r));
        return o
    }, t.n = function(e) {
        var n = e && e.__esModule ? function() {
            return e.default
        } : function() {
            return e
        };
        return t.d(n, "a", n), n
    }, t.o = function(e, n) {
        return Object.prototype.hasOwnProperty.call(e, n)
    }, t.p = "", t(t.s = 68)
}({
    68: function(e, n, t) {
        var o = new(function() {
            function e() {
                var e = this;
                this.queue = [], this.init = function(n) {
                    return void 0 === n && (n = {}), new Promise((function(t, o) {
                        e.enqueue("init", n, t, o)
                    }))
                }, this.rewardedBreak = function() {
                    return new Promise((function(e) {
                        e(!1)
                    }))
                }, this.noArguments = function(n) {
                    return function() {
                        e.enqueue(n)
                    }
                }, this.oneArgument = function(n) {
                    return function(t) {
                        e.enqueue(n, t)
                    }
                }, this.handleAutoResolvePromise = function() {
                    return new Promise((function(e) {
                        e()
                    }))
                }, this.handleAutoResolvePromiseObj = function() {
                    return new Promise((function(e) {
                        e()
                    }))
                }, this.throwNotLoaded = function() {
                    console.debug("PokiSDK is not loaded yet. Not all methods are available.")
                }
            }
            return e.prototype.enqueue = function(e, n, t, o) {
                var r = {
                    fn: e,
                    options: n,
                    resolveFn: t,
                    rejectFn: o
                };
                this.queue.push(r)
            }, e.prototype.dequeue = function() {
                for (var e = function() {
                        var e = n.queue.shift(),
                            t = e,
                            o = t.fn,
                            r = t.options;
                        "function" == typeof window.PokiSDK[o] ? (null == e ? void 0 : e.resolveFn) || (null == e ? void 0 : e.rejectFn) ? window.PokiSDK[o](r).then((function() {
                            for (var n = [], t = 0; t < arguments.length; t++) n[t] = arguments[t];
                            "function" == typeof e.resolveFn && e.resolveFn.apply(e, n)
                        })).catch((function() {
                            for (var n = [], t = 0; t < arguments.length; t++) n[t] = arguments[t];
                            "function" == typeof e.rejectFn && e.rejectFn.apply(e, n)
                        })) : void 0 !== (null == e ? void 0 : e.fn) && window.PokiSDK[o](r) : console.error("Cannot execute " + e.fn)
                    }, n = this; this.queue.length > 0;) e()
            }, e
        }());
        window.PokiSDK = {
            init: o.init,
            initWithVideoHB: o.init,
            customEvent: o.throwNotLoaded,
            commercialBreak: o.handleAutoResolvePromise,
            rewardedBreak: o.rewardedBreak,
            displayAd: o.throwNotLoaded,
            destroyAd: o.throwNotLoaded,
            getLeaderboard: o.handleAutoResolvePromiseObj
        }, ["disableProgrammatic", "gameLoadingStart", "gameLoadingFinished", "gameInteractive", "roundStart", "roundEnd", "muteAd"].forEach((function(e) {
            window.PokiSDK[e] = o.noArguments(e)
        })), ["setDebug", "gameplayStart", "gameplayStop", "gameLoadingProgress", "happyTime", "setPlayerAge", "togglePlayerAdvertisingConsent", "toggleNonPersonalized", "setConsentString", "logError", "sendHighscore", "setDebugTouchOverlayController"].forEach((function(e) {
            window.PokiSDK[e] = o.oneArgument(e)
        }));
        var r = function() {
                var e, n = window.pokiSDKVersion;
                n || (n = (e = RegExp("[?&]" + "ab" + "=([^&]*)").exec(window.location.search)) && decodeURIComponent(e[1].replace(/\+/g, " ")) || "v2");
                return "data:text/javascript;base64,ISBmdW5jdGlvbih0KSB7CiAgICB2YXIgbiA9IHt9OwoKICAgIGZ1bmN0aW9uIGUoaSkgewogICAgICAgIGlmIChuW2ldKSByZXR1cm4gbltpXS5leHBvcnRzOwogICAgICAgIHZhciByID0gbltpXSA9IHsKICAgICAgICAgICAgaTogaSwKICAgICAgICAgICAgbDogITEsCiAgICAgICAgICAgIGV4cG9ydHM6IHt9CiAgICAgICAgfTsKICAgICAgICByZXR1cm4gdFtpXS5jYWxsKHIuZXhwb3J0cywgciwgci5leHBvcnRzLCBlKSwgci5sID0gITAsIHIuZXhwb3J0cwogICAgfQogICAgZS5tID0gdCwgZS5jID0gbiwgZS5kID0gZnVuY3Rpb24odCwgbiwgaSkgewogICAgICAgIGUubyh0LCBuKSB8fCBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgbiwgewogICAgICAgICAgICBlbnVtZXJhYmxlOiAhMCwKICAgICAgICAgICAgZ2V0OiBpCiAgICAgICAgfSkKICAgIH0sIGUuciA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAidW5kZWZpbmVkIiAhPSB0eXBlb2YgU3ltYm9sICYmIFN5bWJvbC50b1N0cmluZ1RhZyAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgU3ltYm9sLnRvU3RyaW5nVGFnLCB7CiAgICAgICAgICAgIHZhbHVlOiAiTW9kdWxlIgogICAgICAgIH0pLCBPYmplY3QuZGVmaW5lUHJvcGVydHkodCwgIl9fZXNNb2R1bGUiLCB7CiAgICAgICAgICAgIHZhbHVlOiAhMAogICAgICAgIH0pCiAgICB9LCBlLnQgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgaWYgKDEgJiBuICYmICh0ID0gZSh0KSksIDggJiBuKSByZXR1cm4gdDsKICAgICAgICBpZiAoNCAmIG4gJiYgIm9iamVjdCIgPT0gdHlwZW9mIHQgJiYgdCAmJiB0Ll9fZXNNb2R1bGUpIHJldHVybiB0OwogICAgICAgIHZhciBpID0gT2JqZWN0LmNyZWF0ZShudWxsKTsKICAgICAgICBpZiAoZS5yKGkpLCBPYmplY3QuZGVmaW5lUHJvcGVydHkoaSwgImRlZmF1bHQiLCB7CiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiAhMCwKICAgICAgICAgICAgICAgIHZhbHVlOiB0CiAgICAgICAgICAgIH0pLCAyICYgbiAmJiAic3RyaW5nIiAhPSB0eXBlb2YgdCkKICAgICAgICAgICAgZm9yICh2YXIgciBpbiB0KSBlLmQoaSwgciwgZnVuY3Rpb24obikgewogICAgICAgICAgICAgICAgcmV0dXJuIHRbbl0KICAgICAgICAgICAgfS5iaW5kKG51bGwsIHIpKTsKICAgICAgICByZXR1cm4gaQogICAgfSwgZS5uID0gZnVuY3Rpb24odCkgewogICAgICAgIHZhciBuID0gdCAmJiB0Ll9fZXNNb2R1bGUgPyBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIHQuZGVmYXVsdAogICAgICAgIH0gOiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIHQKICAgICAgICB9OwogICAgICAgIHJldHVybiBlLmQobiwgImEiLCBuKSwgbgogICAgfSwgZS5vID0gZnVuY3Rpb24odCwgbikgewogICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCwgbikKICAgIH0sIGUucCA9ICIiLCBlKGUucyA9IDExMCkKfShbZnVuY3Rpb24odCwgbiwgZSkgewogICAgKGZ1bmN0aW9uKG4pIHsKICAgICAgICB2YXIgZSA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgcmV0dXJuIHQgJiYgdC5NYXRoID09IE1hdGggJiYgdAogICAgICAgIH07CiAgICAgICAgdC5leHBvcnRzID0gZSgib2JqZWN0IiA9PSB0eXBlb2YgZ2xvYmFsVGhpcyAmJiBnbG9iYWxUaGlzKSB8fCBlKCJvYmplY3QiID09IHR5cGVvZiB3aW5kb3cgJiYgd2luZG93KSB8fCBlKCJvYmplY3QiID09IHR5cGVvZiBzZWxmICYmIHNlbGYpIHx8IGUoIm9iamVjdCIgPT0gdHlwZW9mIG4gJiYgbikgfHwgRnVuY3Rpb24oInJldHVybiB0aGlzIikoKQogICAgfSkuY2FsbCh0aGlzLCBlKDM3KSkKfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGkgPSBlKDApLAogICAgICAgIHIgPSBlKDQzKSwKICAgICAgICBvID0gZSgzKSwKICAgICAgICBhID0gZSg0NCksCiAgICAgICAgcyA9IGUoNTEpLAogICAgICAgIGQgPSBlKDgwKSwKICAgICAgICBjID0gcigid2tzIiksCiAgICAgICAgdSA9IGkuU3ltYm9sLAogICAgICAgIGwgPSBkID8gdSA6IHUgJiYgdS53aXRob3V0U2V0dGVyIHx8IGE7CiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgcmV0dXJuIG8oYywgdCkgfHwgKHMgJiYgbyh1LCB0KSA/IGNbdF0gPSB1W3RdIDogY1t0XSA9IGwoIlN5bWJvbC4iICsgdCkpLCBjW3RdCiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4pIHsKICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4gISF0KCkKICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgIHJldHVybiAhMAogICAgICAgIH0KICAgIH0KfSwgZnVuY3Rpb24odCwgbikgewogICAgdmFyIGUgPSB7fS5oYXNPd25Qcm9wZXJ0eTsKICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICByZXR1cm4gZS5jYWxsKHQsIG4pCiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSg4KTsKICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICBpZiAoIWkodCkpIHRocm93IFR5cGVFcnJvcihTdHJpbmcodCkgKyAiIGlzIG5vdCBhbiBvYmplY3QiKTsKICAgICAgICByZXR1cm4gdAogICAgfQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSA9IGUoMCksCiAgICAgICAgciA9IGUoMjMpLmYsCiAgICAgICAgbyA9IGUoNyksCiAgICAgICAgYSA9IGUoMTIpLAogICAgICAgIHMgPSBlKDI2KSwKICAgICAgICBkID0gZSg3MiksCiAgICAgICAgYyA9IGUoNDgpOwogICAgdC5leHBvcnRzID0gZnVuY3Rpb24odCwgbikgewogICAgICAgIHZhciBlLCB1LCBsLCBBLCBtLCBmID0gdC50YXJnZXQsCiAgICAgICAgICAgIHAgPSB0Lmdsb2JhbCwKICAgICAgICAgICAgZyA9IHQuc3RhdDsKICAgICAgICBpZiAoZSA9IHAgPyBpIDogZyA/IGlbZl0gfHwgcyhmLCB7fSkgOiAoaVtmXSB8fCB7fSkucHJvdG90eXBlKQogICAgICAgICAgICBmb3IgKHUgaW4gbikgewogICAgICAgICAgICAgICAgaWYgKEEgPSBuW3VdLCBsID0gdC5ub1RhcmdldEdldCA/IChtID0gcihlLCB1KSkgJiYgbS52YWx1ZSA6IGVbdV0sICFjKHAgPyB1IDogZiArIChnID8gIi4iIDogIiMiKSArIHUsIHQuZm9yY2VkKSAmJiB2b2lkIDAgIT09IGwpIHsKICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIEEgPT0gdHlwZW9mIGwpIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgIGQoQSwgbCkKICAgICAgICAgICAgICAgIH0odC5zaGFtIHx8IGwgJiYgbC5zaGFtKSAmJiBvKEEsICJzaGFtIiwgITApLCBhKGUsIHUsIEEsIHQpCiAgICAgICAgICAgIH0KICAgIH0KfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGkgPSBlKDIpOwogICAgdC5leHBvcnRzID0gIWkoKGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiA3ICE9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh7fSwgMSwgewogICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIDcKICAgICAgICAgICAgfQogICAgICAgIH0pWzFdCiAgICB9KSkKfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGkgPSBlKDYpLAogICAgICAgIHIgPSBlKDkpLAogICAgICAgIG8gPSBlKDE5KTsKICAgIHQuZXhwb3J0cyA9IGkgPyBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICAgICAgcmV0dXJuIHIuZih0LCBuLCBvKDEsIGUpKQogICAgfSA6IGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgICAgICByZXR1cm4gdFtuXSA9IGUsIHQKICAgIH0KfSwgZnVuY3Rpb24odCwgbikgewogICAgdC5leHBvcnRzID0gZnVuY3Rpb24odCkgewogICAgICAgIHJldHVybiAib2JqZWN0IiA9PSB0eXBlb2YgdCA/IG51bGwgIT09IHQgOiAiZnVuY3Rpb24iID09IHR5cGVvZiB0CiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSg2KSwKICAgICAgICByID0gZSg0MSksCiAgICAgICAgbyA9IGUoNCksCiAgICAgICAgYSA9IGUoNDApLAogICAgICAgIHMgPSBPYmplY3QuZGVmaW5lUHJvcGVydHk7CiAgICBuLmYgPSBpID8gcyA6IGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgICAgICBpZiAobyh0KSwgbiA9IGEobiwgITApLCBvKGUpLCByKSB0cnkgewogICAgICAgICAgICByZXR1cm4gcyh0LCBuLCBlKQogICAgICAgIH0gY2F0Y2ggKHQpIHt9CiAgICAgICAgaWYgKCJnZXQiIGluIGUgfHwgInNldCIgaW4gZSkgdGhyb3cgVHlwZUVycm9yKCJBY2Nlc3NvcnMgbm90IHN1cHBvcnRlZCIpOwogICAgICAgIHJldHVybiAidmFsdWUiIGluIGUgJiYgKHRbbl0gPSBlLnZhbHVlKSwgdAogICAgfQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSA9IGUoMzApLAogICAgICAgIHIgPSBlKDApLAogICAgICAgIG8gPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgIHJldHVybiAiZnVuY3Rpb24iID09IHR5cGVvZiB0ID8gdCA6IHZvaWQgMAogICAgICAgIH07CiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPCAyID8gbyhpW3RdKSB8fCBvKHJbdF0pIDogaVt0XSAmJiBpW3RdW25dIHx8IHJbdF0gJiYgclt0XVtuXQogICAgfQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICAoZnVuY3Rpb24oZSkgewogICAgICAgIHZhciBpLCByLCBvOwogICAgICAgICEgZnVuY3Rpb24oZSwgYSkgewogICAgICAgICAgICBpZiAoZSkgewogICAgICAgICAgICAgICAgdmFyIHMgPSB7fSwKICAgICAgICAgICAgICAgICAgICBkID0gZS5UcmFjZUtpdCwKICAgICAgICAgICAgICAgICAgICBjID0gW10uc2xpY2UsCiAgICAgICAgICAgICAgICAgICAgdSA9IC9eKD86W1V1XW5jYXVnaHQgKD86ZXhjZXB0aW9uOiApPyk/KD86KCg/OkV2YWx8SW50ZXJuYWx8UmFuZ2V8UmVmZXJlbmNlfFN5bnRheHxUeXBlfFVSSXwpRXJyb3IpOiApPyguKikkLzsKICAgICAgICAgICAgICAgIHMubm9Db25mbGljdCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBlLlRyYWNlS2l0ID0gZCwgcwogICAgICAgICAgICAgICAgfSwgcy53cmFwID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykKICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgcy5yZXBvcnQodCksIHQKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIHMucmVwb3J0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHQsIG4sIGkgPSBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgciA9IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBudWxsOwoKICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhKHQsIG4sIGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW4gfHwgcy5jb2xsZWN0V2luZG93RXJyb3JzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBvIGluIGkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGwoaSwgbykpIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlbb10odCwgbiwgZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIgPSB0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIpIHRocm93IHIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZChuLCBlLCBpLCByLCBkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvKSBzLmNvbXB1dGVTdGFja1RyYWNlLmF1Z21lbnRTdGFja1RyYWNlV2l0aEluaXRpYWxFbGVtZW50KG8sIGUsIGksIG4pLCBjKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGQpIGEocy5jb21wdXRlU3RhY2tUcmFjZShkKSwgITAsIGQpOwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsLCBBID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmU6IGksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbjogcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbSA9IG47CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIltvYmplY3QgU3RyaW5nXSIgPT09IHt9LnRvU3RyaW5nLmNhbGwobikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IG4ubWF0Y2godSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZiAmJiAobCA9IGZbMV0sIG0gPSBmWzJdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQS5mdW5jID0gcy5jb21wdXRlU3RhY2tUcmFjZS5ndWVzc0Z1bmN0aW9uTmFtZShBLnVybCwgQS5saW5lKSwgQS5jb250ZXh0ID0gcy5jb21wdXRlU3RhY2tUcmFjZS5nYXRoZXJDb250ZXh0KEEudXJsLCBBLmxpbmUpLCBhKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBsLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZTogIm9uZXJyb3IiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrOiBbQV0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sICEwLCBudWxsKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhIXQgJiYgdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBjKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdCA9IG8sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuID0gcjsKICAgICAgICAgICAgICAgICAgICAgICAgbyA9IG51bGwsIHIgPSBudWxsLCBhKHQsICExLCBuKQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gQSh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAociA9PT0gdCkgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYygpCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBzLmNvbXB1dGVTdGFja1RyYWNlKHQpOwogICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBvID0gbiwgciA9IHQsIHNldFRpbWVvdXQoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgciA9PT0gdCAmJiBjKCkKICAgICAgICAgICAgICAgICAgICAgICAgfSksIG4uaW5jb21wbGV0ZSA/IDJlMyA6IDApLCB0CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHJldHVybiBBLnN1YnNjcmliZSA9IGZ1bmN0aW9uKHIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgISBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghMCA9PT0gbikgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdCA9IGUub25lcnJvciwgZS5vbmVycm9yID0gZCwgbiA9ICEwCiAgICAgICAgICAgICAgICAgICAgICAgIH0oKSwgaS5wdXNoKHIpCiAgICAgICAgICAgICAgICAgICAgfSwgQS51bnN1YnNjcmliZSA9IGZ1bmN0aW9uKHIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbyA9IGkubGVuZ3RoIC0gMTsgbyA+PSAwOyAtLW8pIGlbb10gPT09IHIgJiYgaS5zcGxpY2UobywgMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIDAgPT09IGkubGVuZ3RoICYmIChlLm9uZXJyb3IgPSB0LCBuID0gITEpCiAgICAgICAgICAgICAgICAgICAgfSwgQQogICAgICAgICAgICAgICAgfSgpLCBzLmNvbXB1dGVTdGFja1RyYWNlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSB7fTsKCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gbihuKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgic3RyaW5nIiAhPSB0eXBlb2YgbikgcmV0dXJuIFtdOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWwodCwgbikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgciA9ICIiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByID0gZS5kb2N1bWVudC5kb21haW4KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHt9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbyA9IC8oLiopXDpcL1wvKFteOlwvXSspKFs6XGRdKilcL3swLDF9KFtcc1xTXSopLy5leGVjKG4pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbyAmJiBvWzJdID09PSByICYmIChpID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghcy5yZW1vdGVGZXRjaGluZykgcmV0dXJuICIiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgZS5YTUxIdHRwUmVxdWVzdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgZS5BY3RpdmVYT2JqZWN0KCJNaWNyb3NvZnQuWE1MSFRUUCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0oKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4ub3BlbigiR0VUIiwgdCwgITEpLCBuLnNlbmQoIiIpLCBuLnJlc3BvbnNlVGV4dAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICIiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfShuKSksIHRbbl0gPSBpID8gaS5zcGxpdCgiXG4iKSA6IFtdCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRbbl0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGkodCwgZSkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSwgciA9IC9mdW5jdGlvbiAoW14oXSopXCgoW14pXSopXCkvLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbyA9IC9bJyJdPyhbMC05QS1aYS16JF9dKylbJyJdP1xzKls6PV1ccyooZnVuY3Rpb258ZXZhbHxuZXcgRnVuY3Rpb24pLywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHMgPSBuKHQpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXMubGVuZ3RoKSByZXR1cm4gIj8iOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBkID0gMDsgZCA8IDEwOyArK2QpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUEoYSA9IHNbZSAtIGRdICsgYSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9IG8uZXhlYyhhKSkgcmV0dXJuIGlbMV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPSByLmV4ZWMoYSkpIHJldHVybiBpWzFdCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiPyIKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHIodCwgZSkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IG4odCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaS5sZW5ndGgpIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9IFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbyA9IE1hdGguZmxvb3Iocy5saW5lc09mQ29udGV4dCAvIDIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IG8gKyBzLmxpbmVzT2ZDb250ZXh0ICUgMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBNYXRoLm1heCgwLCBlIC0gbyAtIDEpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYyA9IE1hdGgubWluKGkubGVuZ3RoLCBlICsgYSAtIDEpOwogICAgICAgICAgICAgICAgICAgICAgICBlIC09IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHUgPSBkOyB1IDwgYzsgKyt1KSBBKGlbdV0pIHx8IHIucHVzaChpW3VdKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHIubGVuZ3RoID4gMCA/IHIgOiBudWxsCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBvKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQucmVwbGFjZSgvW1wtXFtcXXt9KCkqKz8uLFxcXF4kfCNdL2csICJcXCQmIikKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEodCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbyh0KS5yZXBsYWNlKCI8IiwgIig/Ojx8Jmx0OykiKS5yZXBsYWNlKCI+IiwgIig/Oj58Jmd0OykiKS5yZXBsYWNlKCImIiwgIig/OiZ8JmFtcDspIikucmVwbGFjZSgnIicsICcoPzoifCZxdW90OyknKS5yZXBsYWNlKC9ccysvZywgIlxccysiKQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZCh0LCBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGksIHIsIG8gPSAwLCBhID0gZS5sZW5ndGg7IG8gPCBhOyArK28pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGkgPSBuKGVbb10pKS5sZW5ndGggJiYgKGkgPSBpLmpvaW4oIlxuIiksIHIgPSB0LmV4ZWMoaSkpKSByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogZVtvXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lOiBpLnN1YnN0cmluZygwLCByLmluZGV4KS5zcGxpdCgiXG4iKS5sZW5ndGgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uOiByLmluZGV4IC0gaS5sYXN0SW5kZXhPZigiXG4iLCByLmluZGV4KSAtIDEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsCiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBjKHQsIGUsIGkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHIsIGEgPSBuKGUpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcyA9IG5ldyBSZWdFeHAoIlxcYiIgKyBvKHQpICsgIlxcYiIpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaSAtPSAxLCBhICYmIGEubGVuZ3RoID4gaSAmJiAociA9IHMuZXhlYyhhW2ldKSkgPyByLmluZGV4IDogbnVsbAogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gdSh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghQShlICYmIGUuZG9jdW1lbnQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBuLCBpLCByLCBzLCBjID0gW2UubG9jYXRpb24uaHJlZl0sIHUgPSBlLmRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJzY3JpcHQiKSwgbCA9ICIiICsgdCwgbSA9IDA7IG0gPCB1Lmxlbmd0aDsgKyttKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSB1W21dOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYuc3JjICYmIGMucHVzaChmLnNyYykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyID0gL15mdW5jdGlvbig/OlxzKyhbXHckXSspKT9ccypcKChbXHdccyxdKilcKVxzKlx7XHMqKFxTW1xzXFNdKlxTKVxzKlx9XHMqJC8uZXhlYyhsKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwID0gclsxXSA/ICJcXHMrIiArIHJbMV0gOiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IHJbMl0uc3BsaXQoIiwiKS5qb2luKCJcXHMqLFxccyoiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuID0gbyhyWzNdKS5yZXBsYWNlKC87JC8sICI7PyIpLCBpID0gbmV3IFJlZ0V4cCgiZnVuY3Rpb24iICsgcCArICJcXHMqXFwoXFxzKiIgKyBnICsgIlxccypcXClcXHMqe1xccyoiICsgbiArICJcXHMqfSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaSA9IG5ldyBSZWdFeHAobyhsKS5yZXBsYWNlKC9ccysvZywgIlxccysiKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocyA9IGQoaSwgYykpIHJldHVybiBzOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIgPSAvXmZ1bmN0aW9uIG9uKFtcdyRdKylccypcKGV2ZW50XClccypce1xzKihcU1tcc1xTXSpcUylccypcfVxzKiQvLmV4ZWMobCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaCA9IHJbMV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4gPSBhKHJbMl0pLCBzID0gZChpID0gbmV3IFJlZ0V4cCgib24iICsgaCArICI9W1xcJ1wiXVxccyoiICsgbiArICJcXHMqW1xcJ1wiXSIsICJpIiksIGNbMF0pKSByZXR1cm4gczsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocyA9IGQoaSA9IG5ldyBSZWdFeHAobiksIGMpKSByZXR1cm4gcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGwKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gbSh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdC5zdGFjaykgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG4sIGUsIG8sIGEgPSAvXlxzKmF0ICguKj8pID9cKCgoPzpmaWxlfGh0dHBzP3xibG9ifGNocm9tZS1leHRlbnNpb258bmF0aXZlfGV2YWx8d2VicGFja3w8YW5vbnltb3VzPnxcLykuKj8pKD86OihcZCspKT8oPzo6KFxkKykpP1wpP1xzKiQvaSwgcyA9IC9eXHMqKC4qPykoPzpcKCguKj8pXCkpPyg/Ol58QCkoKD86ZmlsZXxodHRwcz98YmxvYnxjaHJvbWV8d2VicGFja3xyZXNvdXJjZXxcW25hdGl2ZSkuKj98W15AXSpidW5kbGUpKD86OihcZCspKT8oPzo6KFxkKykpP1xzKiQvaSwgZCA9IC9eXHMqYXQgKD86KCg/Olxbb2JqZWN0IG9iamVjdFxdKT8uKykgKT9cKD8oKD86ZmlsZXxtcy1hcHB4fGh0dHBzP3x3ZWJwYWNrfGJsb2IpOi4qPyk6KFxkKykoPzo6KFxkKykpP1wpP1xzKiQvaSwgdSA9IC8oXFMrKSBsaW5lIChcZCspKD86ID4gZXZhbCBsaW5lIFxkKykqID4gZXZhbC9pLCBsID0gL1woKFxTKikoPzo6KFxkKykpKD86OihcZCspKVwpLywgbSA9IHQuc3RhY2suc3BsaXQoIlxuIiksIGYgPSBbXSwgcCA9IC9eKC4qKSBpcyB1bmRlZmluZWQkLy5leGVjKHQubWVzc2FnZSksIGcgPSAwLCBoID0gbS5sZW5ndGg7IGcgPCBoOyArK2cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlID0gYS5leGVjKG1bZ10pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHcgPSBlWzJdICYmIDAgPT09IGVbMl0uaW5kZXhPZigibmF0aXZlIik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZVsyXSAmJiAwID09PSBlWzJdLmluZGV4T2YoImV2YWwiKSAmJiAobiA9IGwuZXhlYyhlWzJdKSkgJiYgKGVbMl0gPSBuWzFdLCBlWzNdID0gblsyXSwgZVs0XSA9IG5bM10pLCBvID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHcgPyBudWxsIDogZVsyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuYzogZVsxXSB8fCAiPyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IHcgPyBbZVsyXV0gOiBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZTogZVszXSA/ICtlWzNdIDogbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uOiBlWzRdID8gK2VbNF0gOiBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlID0gZC5leGVjKG1bZ10pKSBvID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogZVsyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jOiBlWzFdIHx8ICI/IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lOiArZVszXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW46IGVbNF0gPyArZVs0XSA6IG51bGwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShlID0gcy5leGVjKG1bZ10pKSkgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZVszXSAmJiBlWzNdLmluZGV4T2YoIiA+IGV2YWwiKSA+IC0xICYmIChuID0gdS5leGVjKGVbM10pKSA/IChlWzNdID0gblsxXSwgZVs0XSA9IG5bMl0sIGVbNV0gPSBudWxsKSA6IDAgIT09IGcgfHwgZVs1XSB8fCBBKHQuY29sdW1uTnVtYmVyKSB8fCAoZlswXS5jb2x1bW4gPSB0LmNvbHVtbk51bWJlciArIDEpLCBvID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IGVbM10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmM6IGVbMV0gfHwgIj8iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBlWzJdID8gZVsyXS5zcGxpdCgiLCIpIDogW10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmU6IGVbNF0gPyArZVs0XSA6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbjogZVs1XSA/ICtlWzVdIDogbnVsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0hby5mdW5jICYmIG8ubGluZSAmJiAoby5mdW5jID0gaShvLnVybCwgby5saW5lKSksIG8uY29udGV4dCA9IG8ubGluZSA/IHIoby51cmwsIG8ubGluZSkgOiBudWxsLCBmLnB1c2gobykKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZi5sZW5ndGggPyAoZlswXSAmJiBmWzBdLmxpbmUgJiYgIWZbMF0uY29sdW1uICYmIHAgJiYgKGZbMF0uY29sdW1uID0gYyhwWzFdLCBmWzBdLnVybCwgZlswXS5saW5lKSksIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGU6ICJzdGFjayIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0Lm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB0Lm1lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFjazogZgogICAgICAgICAgICAgICAgICAgICAgICB9KSA6IG51bGwKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGYodCwgbiwgZSwgbykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmU6IGUKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGEudXJsICYmIGEubGluZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5pbmNvbXBsZXRlID0gITEsIGEuZnVuYyB8fCAoYS5mdW5jID0gaShhLnVybCwgYS5saW5lKSksIGEuY29udGV4dCB8fCAoYS5jb250ZXh0ID0gcihhLnVybCwgYS5saW5lKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcyA9IC8gJyhbXiddKyknIC8uZXhlYyhvKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzICYmIChhLmNvbHVtbiA9IGMoc1sxXSwgYS51cmwsIGEubGluZSkpLCB0LnN0YWNrLmxlbmd0aCA+IDAgJiYgdC5zdGFja1swXS51cmwgPT09IGEudXJsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQuc3RhY2tbMF0ubGluZSA9PT0gYS5saW5lKSByZXR1cm4gITE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0LnN0YWNrWzBdLmxpbmUgJiYgdC5zdGFja1swXS5mdW5jID09PSBhLmZ1bmMpIHJldHVybiB0LnN0YWNrWzBdLmxpbmUgPSBhLmxpbmUsIHQuc3RhY2tbMF0uY29udGV4dCA9IGEuY29udGV4dCwgITEKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LnN0YWNrLnVuc2hpZnQoYSksIHQucGFydGlhbCA9ICEwLCAhMAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmluY29tcGxldGUgPSAhMCwgITEKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHAodCwgbikgewogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBlLCByLCBvLCBhID0gL2Z1bmN0aW9uXHMrKFtfJGEtekEtWlx4QTAtXHVGRkZGXVtfJGEtekEtWjAtOVx4QTAtXHVGRkZGXSopP1xzKlwoL2ksIGQgPSBbXSwgbCA9IHt9LCBBID0gITEsIG0gPSBwLmNhbGxlcjsgbSAmJiAhQTsgbSA9IG0uY2FsbGVyKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG0gIT09IGcgJiYgbSAhPT0gcy5yZXBvcnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAociA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmM6ICI/IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZTogbnVsbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbjogbnVsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBtLm5hbWUgPyByLmZ1bmMgPSBtLm5hbWUgOiAoZSA9IGEuZXhlYyhtLnRvU3RyaW5nKCkpKSAmJiAoci5mdW5jID0gZVsxXSksIHZvaWQgMCA9PT0gci5mdW5jKSB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByLmZ1bmMgPSBlLmlucHV0LnN1YnN0cmluZygwLCBlLmlucHV0LmluZGV4T2YoInsiKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7fQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvID0gdShtKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByLnVybCA9IG8udXJsLCByLmxpbmUgPSBvLmxpbmUsICI/IiA9PT0gci5mdW5jICYmIChyLmZ1bmMgPSBpKHIudXJsLCByLmxpbmUpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGggPSAvICcoW14nXSspJyAvLmV4ZWModC5tZXNzYWdlIHx8IHQuZGVzY3JpcHRpb24pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoICYmIChyLmNvbHVtbiA9IGMoaFsxXSwgby51cmwsIG8ubGluZSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxbIiIgKyBtXSA/IEEgPSAhMCA6IGxbIiIgKyBtXSA9ICEwLCBkLnB1c2gocikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgbiAmJiBkLnNwbGljZSgwLCBuKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHcgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlOiAiY2FsbGVycyIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0Lm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB0Lm1lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFjazogZAogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZih3LCB0LnNvdXJjZVVSTCB8fCB0LmZpbGVOYW1lLCB0LmxpbmUgfHwgdC5saW5lTnVtYmVyLCB0Lm1lc3NhZ2UgfHwgdC5kZXNjcmlwdGlvbiksIHcKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGcodCwgbykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcyA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBudWxsID09IG8gPyAwIDogK287CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSB0LnN0YWNrdHJhY2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBlLCBvID0gLyBsaW5lIChcZCspLipzY3JpcHQgKD86aW4gKT8oXFMrKSg/OjogaW4gZnVuY3Rpb24gKFxTKykpPyQvaSwgYSA9IC8gbGluZSAoXGQrKSwgY29sdW1uIChcZCspXHMqKD86aW4gKD86PGFub255bW91cyBmdW5jdGlvbjogKFtePl0rKT58KFteXCldKykpXCgoLiopXCkpPyBpbiAoLiopOlxzKiQvaSwgcyA9IG4uc3BsaXQoIlxuIiksIGQgPSBbXSwgYyA9IDA7IGMgPCBzLmxlbmd0aDsgYyArPSAyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHUgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoZSA9IG8uZXhlYyhzW2NdKSkgPyB1ID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBlWzJdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZTogK2VbMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW46IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jOiBlWzNdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnczogW10KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSA6IChlID0gYS5leGVjKHNbY10pKSAmJiAodSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogZVs2XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmU6ICtlWzFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uOiArZVsyXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmM6IGVbM10gfHwgZVs0XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IGVbNV0gPyBlWzVdLnNwbGl0KCIsIikgOiBbXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgdSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXUuZnVuYyAmJiB1LmxpbmUgJiYgKHUuZnVuYyA9IGkodS51cmwsIHUubGluZSkpLCB1LmxpbmUpIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1LmNvbnRleHQgPSByKHUudXJsLCB1LmxpbmUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHt9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUuY29udGV4dCB8fCAodS5jb250ZXh0ID0gW3NbYyArIDFdXSksIGQucHVzaCh1KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLmxlbmd0aCA/IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlOiAic3RhY2t0cmFjZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdC5uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHQubWVzc2FnZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFjazogZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSA6IG51bGwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0odCkpIHJldHVybiBzCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHMgPSBtKHQpKSByZXR1cm4gcwogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAwCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbyA9IHQubWVzc2FnZS5zcGxpdCgiXG4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG8ubGVuZ3RoIDwgNCkgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzLCBjID0gL15ccypMaW5lIChcZCspIG9mIGxpbmtlZCBzY3JpcHQgKCg/OmZpbGV8aHR0cHM/fGJsb2IpXFMrKSg/OjogaW4gZnVuY3Rpb24gKFxTKykpP1xzKiQvaSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUgPSAvXlxzKkxpbmUgKFxkKykgb2YgaW5saW5lIyhcZCspIHNjcmlwdCBpbiAoKD86ZmlsZXxodHRwcz98YmxvYilcUyspKD86OiBpbiBmdW5jdGlvbiAoXFMrKSk/XHMqJC9pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQSA9IC9eXHMqTGluZSAoXGQrKSBvZiBmdW5jdGlvbiBzY3JpcHRccyokL2ksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtID0gW10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gZSAmJiBlLmRvY3VtZW50ICYmIGUuZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInNjcmlwdCIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBnIGluIGYpIGwoZiwgZykgJiYgIWZbZ10uc3JjICYmIHAucHVzaChmW2ddKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaCA9IDI7IGggPCBvLmxlbmd0aDsgaCArPSAyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdyA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocyA9IGMuZXhlYyhvW2hdKSkgdyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHNbMl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuYzogc1szXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lOiArc1sxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW46IG51bGwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChzID0gdS5leGVjKG9baF0pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBzWzNdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jOiBzWzRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluZTogK3NbMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbjogbnVsbAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHkgPSArc1sxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdiA9IHBbc1syXSAtIDFdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gbih3LnVybCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgayA9IChiID0gYi5qb2luKCJcbiIpKS5pbmRleE9mKHYuaW5uZXJUZXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGsgPj0gMCAmJiAody5saW5lID0geSArIGIuc3Vic3RyaW5nKDAsIGspLnNwbGl0KCJcbiIpLmxlbmd0aCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocyA9IEEuZXhlYyhvW2hdKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBTID0gZS5sb2NhdGlvbi5ocmVmLnJlcGxhY2UoLyMuKiQvLCAiIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEUgPSBkKG5ldyBSZWdFeHAoYShvW2ggKyAxXSkpLCBbU10pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHcgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogUywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuYzogIiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lOiBFID8gRS5saW5lIDogc1sxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uOiBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3LmZ1bmMgfHwgKHcuZnVuYyA9IGkody51cmwsIHcubGluZSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4ID0gcih3LnVybCwgdy5saW5lKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVCA9IHggPyB4W01hdGguZmxvb3IoeC5sZW5ndGggLyAyKV0gOiBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHggJiYgVC5yZXBsYWNlKC9eXHMqLywgIiIpID09PSBvW2ggKyAxXS5yZXBsYWNlKC9eXHMqLywgIiIpID8gdy5jb250ZXh0ID0geCA6IHcuY29udGV4dCA9IFtvW2ggKyAxXV0sIG0ucHVzaCh3KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtLmxlbmd0aCA/IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGU6ICJtdWx0aWxpbmUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdC5uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogb1swXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YWNrOiBtCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gOiBudWxsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSh0KSkgcmV0dXJuIHMKICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgMAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocyA9IHAodCwgbyArIDEpKSByZXR1cm4gcwogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAwCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHQubmFtZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHQubWVzc2FnZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGU6ICJmYWlsZWQiCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGcuYXVnbWVudFN0YWNrVHJhY2VXaXRoSW5pdGlhbEVsZW1lbnQgPSBmLCBnLmNvbXB1dGVTdGFja1RyYWNlRnJvbVN0YWNrUHJvcCA9IG0sIGcuZ3Vlc3NGdW5jdGlvbk5hbWUgPSBpLCBnLmdhdGhlckNvbnRleHQgPSByLCBnLm9mQ2FsbGVyID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICB0ID0gMSArIChudWxsID09IHQgPyAwIDogK3QpOwogICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBnKG4sIHQgKyAxKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwgZy5nZXRTb3VyY2UgPSBuLCBnCiAgICAgICAgICAgICAgICB9KCksIHMuZXh0ZW5kVG9Bc3luY2hyb25vdXNDYWxsYmFja3MgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdCA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBlW3RdOwogICAgICAgICAgICAgICAgICAgICAgICBlW3RdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdCA9IGMuY2FsbChhcmd1bWVudHMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSB0WzBdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJmdW5jdGlvbiIgPT0gdHlwZW9mIGUgJiYgKHRbMF0gPSBzLndyYXAoZSkpLCBuLmFwcGx5ID8gbi5hcHBseSh0aGlzLCB0KSA6IG4odFswXSwgdFsxXSkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgdCgic2V0VGltZW91dCIpLCB0KCJzZXRJbnRlcnZhbCIpCiAgICAgICAgICAgICAgICB9LCBzLnJlbW90ZUZldGNoaW5nIHx8IChzLnJlbW90ZUZldGNoaW5nID0gITApLCBzLmNvbGxlY3RXaW5kb3dFcnJvcnMgfHwgKHMuY29sbGVjdFdpbmRvd0Vycm9ycyA9ICEwKSwgKCFzLmxpbmVzT2ZDb250ZXh0IHx8IHMubGluZXNPZkNvbnRleHQgPCAxKSAmJiAocy5saW5lc09mQ29udGV4dCA9IDExKSwgciA9IFtdLCB2b2lkIDAgPT09IChvID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YoaSA9IHMpID8gaS5hcHBseShuLCByKSA6IGkpIHx8ICh0LmV4cG9ydHMgPSBvKQogICAgICAgICAgICB9CgogICAgICAgICAgICBmdW5jdGlvbiBsKHQsIG4pIHsKICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCwgbikKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZnVuY3Rpb24gQSh0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdm9pZCAwID09PSB0CiAgICAgICAgICAgIH0KICAgICAgICB9KCJ1bmRlZmluZWQiICE9IHR5cGVvZiB3aW5kb3cgPyB3aW5kb3cgOiBlKQogICAgfSkuY2FsbCh0aGlzLCBlKDM3KSkKfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGkgPSBlKDApLAogICAgICAgIHIgPSBlKDcpLAogICAgICAgIG8gPSBlKDMpLAogICAgICAgIGEgPSBlKDI2KSwKICAgICAgICBzID0gZSgyNyksCiAgICAgICAgZCA9IGUoMTUpLAogICAgICAgIGMgPSBkLmdldCwKICAgICAgICB1ID0gZC5lbmZvcmNlLAogICAgICAgIGwgPSBTdHJpbmcoU3RyaW5nKS5zcGxpdCgiU3RyaW5nIik7CiAgICAodC5leHBvcnRzID0gZnVuY3Rpb24odCwgbiwgZSwgcykgewogICAgICAgIHZhciBkID0gISFzICYmICEhcy51bnNhZmUsCiAgICAgICAgICAgIGMgPSAhIXMgJiYgISFzLmVudW1lcmFibGUsCiAgICAgICAgICAgIEEgPSAhIXMgJiYgISFzLm5vVGFyZ2V0R2V0OwogICAgICAgICJmdW5jdGlvbiIgPT0gdHlwZW9mIGUgJiYgKCJzdHJpbmciICE9IHR5cGVvZiBuIHx8IG8oZSwgIm5hbWUiKSB8fCByKGUsICJuYW1lIiwgbiksIHUoZSkuc291cmNlID0gbC5qb2luKCJzdHJpbmciID09IHR5cGVvZiBuID8gbiA6ICIiKSksIHQgIT09IGkgPyAoZCA/ICFBICYmIHRbbl0gJiYgKGMgPSAhMCkgOiBkZWxldGUgdFtuXSwgYyA/IHRbbl0gPSBlIDogcih0LCBuLCBlKSkgOiBjID8gdFtuXSA9IGUgOiBhKG4sIGUpCiAgICB9KShGdW5jdGlvbi5wcm90b3R5cGUsICJ0b1N0cmluZyIsIChmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gImZ1bmN0aW9uIiA9PSB0eXBlb2YgdGhpcyAmJiBjKHRoaXMpLnNvdXJjZSB8fCBzKHRoaXMpCiAgICB9KSkKfSwgZnVuY3Rpb24odCwgbikgewogICAgdC5leHBvcnRzID0gZnVuY3Rpb24odCkgewogICAgICAgIGlmICgiZnVuY3Rpb24iICE9IHR5cGVvZiB0KSB0aHJvdyBUeXBlRXJyb3IoU3RyaW5nKHQpICsgIiBpcyBub3QgYSBmdW5jdGlvbiIpOwogICAgICAgIHJldHVybiB0CiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4pIHsKICAgIHZhciBlID0ge30udG9TdHJpbmc7CiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgcmV0dXJuIGUuY2FsbCh0KS5zbGljZSg4LCAtMSkKICAgIH0KfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGksIHIsIG8sIGEgPSBlKDcxKSwKICAgICAgICBzID0gZSgwKSwKICAgICAgICBkID0gZSg4KSwKICAgICAgICBjID0gZSg3KSwKICAgICAgICB1ID0gZSgzKSwKICAgICAgICBsID0gZSgyOCksCiAgICAgICAgQSA9IGUoMjkpLAogICAgICAgIG0gPSBzLldlYWtNYXA7CiAgICBpZiAoYSkgewogICAgICAgIHZhciBmID0gbmV3IG0sCiAgICAgICAgICAgIHAgPSBmLmdldCwKICAgICAgICAgICAgZyA9IGYuaGFzLAogICAgICAgICAgICBoID0gZi5zZXQ7CiAgICAgICAgaSA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgcmV0dXJuIGguY2FsbChmLCB0LCBuKSwgbgogICAgICAgIH0sIHIgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgIHJldHVybiBwLmNhbGwoZiwgdCkgfHwge30KICAgICAgICB9LCBvID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICByZXR1cm4gZy5jYWxsKGYsIHQpCiAgICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgICB2YXIgdyA9IGwoInN0YXRlIik7CiAgICAgICAgQVt3XSA9ICEwLCBpID0gZnVuY3Rpb24odCwgbikgewogICAgICAgICAgICByZXR1cm4gYyh0LCB3LCBuKSwgbgogICAgICAgIH0sIHIgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgIHJldHVybiB1KHQsIHcpID8gdFt3XSA6IHt9CiAgICAgICAgfSwgbyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgcmV0dXJuIHUodCwgdykKICAgICAgICB9CiAgICB9CiAgICB0LmV4cG9ydHMgPSB7CiAgICAgICAgc2V0OiBpLAogICAgICAgIGdldDogciwKICAgICAgICBoYXM6IG8sCiAgICAgICAgZW5mb3JjZTogZnVuY3Rpb24odCkgewogICAgICAgICAgICByZXR1cm4gbyh0KSA/IHIodCkgOiBpKHQsIHt9KQogICAgICAgIH0sCiAgICAgICAgZ2V0dGVyRm9yOiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihuKSB7CiAgICAgICAgICAgICAgICB2YXIgZTsKICAgICAgICAgICAgICAgIGlmICghZChuKSB8fCAoZSA9IHIobikpLnR5cGUgIT09IHQpIHRocm93IFR5cGVFcnJvcigiSW5jb21wYXRpYmxlIHJlY2VpdmVyLCAiICsgdCArICIgcmVxdWlyZWQiKTsKICAgICAgICAgICAgICAgIHJldHVybiBlCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4pIHsKICAgIHQuZXhwb3J0cyA9ICExCn0sIGZ1bmN0aW9uKHQsIG4pIHsKICAgIHQuZXhwb3J0cyA9IHt9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIHZhciBpID0gZSgxMyksCiAgICAgICAgciA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgdmFyIG4sIGU7CiAgICAgICAgICAgIHRoaXMucHJvbWlzZSA9IG5ldyB0KChmdW5jdGlvbih0LCBpKSB7CiAgICAgICAgICAgICAgICBpZiAodm9pZCAwICE9PSBuIHx8IHZvaWQgMCAhPT0gZSkgdGhyb3cgVHlwZUVycm9yKCJCYWQgUHJvbWlzZSBjb25zdHJ1Y3RvciIpOwogICAgICAgICAgICAgICAgbiA9IHQsIGUgPSBpCiAgICAgICAgICAgIH0pKSwgdGhpcy5yZXNvbHZlID0gaShuKSwgdGhpcy5yZWplY3QgPSBpKGUpCiAgICAgICAgfTsKICAgIHQuZXhwb3J0cy5mID0gZnVuY3Rpb24odCkgewogICAgICAgIHJldHVybiBuZXcgcih0KQogICAgfQp9LCBmdW5jdGlvbih0LCBuKSB7CiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgZW51bWVyYWJsZTogISgxICYgdCksCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogISgyICYgdCksCiAgICAgICAgICAgIHdyaXRhYmxlOiAhKDQgJiB0KSwKICAgICAgICAgICAgdmFsdWU6IG4KICAgICAgICB9CiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSgzOSksCiAgICAgICAgciA9IGUoMjQpOwogICAgdC5leHBvcnRzID0gZnVuY3Rpb24odCkgewogICAgICAgIHJldHVybiBpKHIodCkpCiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSg0KSwKICAgICAgICByID0gZSg5NiksCiAgICAgICAgbyA9IGUoNDYpLAogICAgICAgIGEgPSBlKDU4KSwKICAgICAgICBzID0gZSg5NyksCiAgICAgICAgZCA9IGUoOTgpLAogICAgICAgIGMgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgICAgIHRoaXMuc3RvcHBlZCA9IHQsIHRoaXMucmVzdWx0ID0gbgogICAgICAgIH07CiAgICAodC5leHBvcnRzID0gZnVuY3Rpb24odCwgbiwgZSwgdSwgbCkgewogICAgICAgIHZhciBBLCBtLCBmLCBwLCBnLCBoLCB3LCB5ID0gYShuLCBlLCB1ID8gMiA6IDEpOwogICAgICAgIGlmIChsKSBBID0gdDsKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgaWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mKG0gPSBzKHQpKSkgdGhyb3cgVHlwZUVycm9yKCJUYXJnZXQgaXMgbm90IGl0ZXJhYmxlIik7CiAgICAgICAgICAgIGlmIChyKG0pKSB7CiAgICAgICAgICAgICAgICBmb3IgKGYgPSAwLCBwID0gbyh0Lmxlbmd0aCk7IHAgPiBmOyBmKyspCiAgICAgICAgICAgICAgICAgICAgaWYgKChnID0gdSA/IHkoaSh3ID0gdFtmXSlbMF0sIHdbMV0pIDogeSh0W2ZdKSkgJiYgZyBpbnN0YW5jZW9mIGMpIHJldHVybiBnOwogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBjKCExKQogICAgICAgICAgICB9CiAgICAgICAgICAgIEEgPSBtLmNhbGwodCkKICAgICAgICB9CiAgICAgICAgZm9yIChoID0gQS5uZXh0OyAhKHcgPSBoLmNhbGwoQSkpLmRvbmU7KQogICAgICAgICAgICBpZiAoIm9iamVjdCIgPT0gdHlwZW9mKGcgPSBkKEEsIHksIHcudmFsdWUsIHUpKSAmJiBnICYmIGcgaW5zdGFuY2VvZiBjKSByZXR1cm4gZzsKICAgICAgICByZXR1cm4gbmV3IGMoITEpCiAgICB9KS5zdG9wID0gZnVuY3Rpb24odCkgewogICAgICAgIHJldHVybiBuZXcgYyghMCwgdCkKICAgIH0KfSwgZnVuY3Rpb24odCwgbikgewogICAgdC5leHBvcnRzID0gZnVuY3Rpb24odCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBlcnJvcjogITEsCiAgICAgICAgICAgICAgICB2YWx1ZTogdCgpCiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBlcnJvcjogITAsCiAgICAgICAgICAgICAgICB2YWx1ZTogdAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSA9IGUoNiksCiAgICAgICAgciA9IGUoMzgpLAogICAgICAgIG8gPSBlKDE5KSwKICAgICAgICBhID0gZSgyMCksCiAgICAgICAgcyA9IGUoNDApLAogICAgICAgIGQgPSBlKDMpLAogICAgICAgIGMgPSBlKDQxKSwKICAgICAgICB1ID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjsKICAgIG4uZiA9IGkgPyB1IDogZnVuY3Rpb24odCwgbikgewogICAgICAgIGlmICh0ID0gYSh0KSwgbiA9IHMobiwgITApLCBjKSB0cnkgewogICAgICAgICAgICByZXR1cm4gdSh0LCBuKQogICAgICAgIH0gY2F0Y2ggKHQpIHt9CiAgICAgICAgaWYgKGQodCwgbikpIHJldHVybiBvKCFyLmYuY2FsbCh0LCBuKSwgdFtuXSkKICAgIH0KfSwgZnVuY3Rpb24odCwgbikgewogICAgdC5leHBvcnRzID0gZnVuY3Rpb24odCkgewogICAgICAgIGlmIChudWxsID09IHQpIHRocm93IFR5cGVFcnJvcigiQ2FuJ3QgY2FsbCBtZXRob2Qgb24gIiArIHQpOwogICAgICAgIHJldHVybiB0CiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSgwKSwKICAgICAgICByID0gZSg4KSwKICAgICAgICBvID0gaS5kb2N1bWVudCwKICAgICAgICBhID0gcihvKSAmJiByKG8uY3JlYXRlRWxlbWVudCk7CiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgcmV0dXJuIGEgPyBvLmNyZWF0ZUVsZW1lbnQodCkgOiB7fQogICAgfQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSA9IGUoMCksCiAgICAgICAgciA9IGUoNyk7CiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgcihpLCB0LCBuKQogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgaVt0XSA9IG4KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG4KICAgIH0KfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGkgPSBlKDQyKSwKICAgICAgICByID0gRnVuY3Rpb24udG9TdHJpbmc7CiAgICAiZnVuY3Rpb24iICE9IHR5cGVvZiBpLmluc3BlY3RTb3VyY2UgJiYgKGkuaW5zcGVjdFNvdXJjZSA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICByZXR1cm4gci5jYWxsKHQpCiAgICB9KSwgdC5leHBvcnRzID0gaS5pbnNwZWN0U291cmNlCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSg0MyksCiAgICAgICAgciA9IGUoNDQpLAogICAgICAgIG8gPSBpKCJrZXlzIik7CiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgcmV0dXJuIG9bdF0gfHwgKG9bdF0gPSByKHQpKQogICAgfQp9LCBmdW5jdGlvbih0LCBuKSB7CiAgICB0LmV4cG9ydHMgPSB7fQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSA9IGUoMCk7CiAgICB0LmV4cG9ydHMgPSBpCn0sIGZ1bmN0aW9uKHQsIG4pIHsKICAgIHZhciBlID0gTWF0aC5jZWlsLAogICAgICAgIGkgPSBNYXRoLmZsb29yOwogICAgdC5leHBvcnRzID0gZnVuY3Rpb24odCkgewogICAgICAgIHJldHVybiBpc05hTih0ID0gK3QpID8gMCA6ICh0ID4gMCA/IGkgOiBlKSh0KQogICAgfQp9LCBmdW5jdGlvbih0LCBuKSB7CiAgICB0LmV4cG9ydHMgPSBbImNvbnN0cnVjdG9yIiwgImhhc093blByb3BlcnR5IiwgImlzUHJvdG90eXBlT2YiLCAicHJvcGVydHlJc0VudW1lcmFibGUiLCAidG9Mb2NhbGVTdHJpbmciLCAidG9TdHJpbmciLCAidmFsdWVPZiJdCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0ge307CiAgICBpW2UoMSkoInRvU3RyaW5nVGFnIildID0gInoiLCB0LmV4cG9ydHMgPSAiW29iamVjdCB6XSIgPT09IFN0cmluZyhpKQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSA9IGUoMyksCiAgICAgICAgciA9IGUoNTApLAogICAgICAgIG8gPSBlKDI4KSwKICAgICAgICBhID0gZSg4NSksCiAgICAgICAgcyA9IG8oIklFX1BST1RPIiksCiAgICAgICAgZCA9IE9iamVjdC5wcm90b3R5cGU7CiAgICB0LmV4cG9ydHMgPSBhID8gT2JqZWN0LmdldFByb3RvdHlwZU9mIDogZnVuY3Rpb24odCkgewogICAgICAgIHJldHVybiB0ID0gcih0KSwgaSh0LCBzKSA/IHRbc10gOiAiZnVuY3Rpb24iID09IHR5cGVvZiB0LmNvbnN0cnVjdG9yICYmIHQgaW5zdGFuY2VvZiB0LmNvbnN0cnVjdG9yID8gdC5jb25zdHJ1Y3Rvci5wcm90b3R5cGUgOiB0IGluc3RhbmNlb2YgT2JqZWN0ID8gZCA6IG51bGwKICAgIH0KfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGksIHIgPSBlKDQpLAogICAgICAgIG8gPSBlKDg2KSwKICAgICAgICBhID0gZSgzMiksCiAgICAgICAgcyA9IGUoMjkpLAogICAgICAgIGQgPSBlKDU1KSwKICAgICAgICBjID0gZSgyNSksCiAgICAgICAgdSA9IGUoMjgpLAogICAgICAgIGwgPSB1KCJJRV9QUk9UTyIpLAogICAgICAgIEEgPSBmdW5jdGlvbigpIHt9LAogICAgICAgIG0gPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgIHJldHVybiAiPHNjcmlwdD4iICsgdCArICI8XC9zY3JpcHQ+IgogICAgICAgIH0sCiAgICAgICAgZiA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaSA9IGRvY3VtZW50LmRvbWFpbiAmJiBuZXcgQWN0aXZlWE9iamVjdCgiaHRtbGZpbGUiKQogICAgICAgICAgICB9IGNhdGNoICh0KSB7fQogICAgICAgICAgICB2YXIgdCwgbjsKICAgICAgICAgICAgZiA9IGkgPyBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICB0LndyaXRlKG0oIiIpKSwgdC5jbG9zZSgpOwogICAgICAgICAgICAgICAgdmFyIG4gPSB0LnBhcmVudFdpbmRvdy5PYmplY3Q7CiAgICAgICAgICAgICAgICByZXR1cm4gdCA9IG51bGwsIG4KICAgICAgICAgICAgfShpKSA6ICgobiA9IGMoImlmcmFtZSIpKS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiLCBkLmFwcGVuZENoaWxkKG4pLCBuLnNyYyA9IFN0cmluZygiamF2YXNjcmlwdDoiKSwgKHQgPSBuLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQpLm9wZW4oKSwgdC53cml0ZShtKCJkb2N1bWVudC5GPU9iamVjdCIpKSwgdC5jbG9zZSgpLCB0LkYpOwogICAgICAgICAgICBmb3IgKHZhciBlID0gYS5sZW5ndGg7IGUtLTspIGRlbGV0ZSBmLnByb3RvdHlwZVthW2VdXTsKICAgICAgICAgICAgcmV0dXJuIGYoKQogICAgICAgIH07CiAgICBzW2xdID0gITAsIHQuZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24odCwgbikgewogICAgICAgIHZhciBlOwogICAgICAgIHJldHVybiBudWxsICE9PSB0ID8gKEEucHJvdG90eXBlID0gcih0KSwgZSA9IG5ldyBBLCBBLnByb3RvdHlwZSA9IG51bGwsIGVbbF0gPSB0KSA6IGUgPSBmKCksIHZvaWQgMCA9PT0gbiA/IGUgOiBvKGUsIG4pCiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSg5KS5mLAogICAgICAgIHIgPSBlKDMpLAogICAgICAgIG8gPSBlKDEpKCJ0b1N0cmluZ1RhZyIpOwogICAgdC5leHBvcnRzID0gZnVuY3Rpb24odCwgbiwgZSkgewogICAgICAgIHQgJiYgIXIodCA9IGUgPyB0IDogdC5wcm90b3R5cGUsIG8pICYmIGkodCwgbywgewogICAgICAgICAgICBjb25maWd1cmFibGU6ICEwLAogICAgICAgICAgICB2YWx1ZTogbgogICAgICAgIH0pCiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4pIHsKICAgIHZhciBlOwogICAgZSA9IGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzCiAgICB9KCk7CiAgICB0cnkgewogICAgICAgIGUgPSBlIHx8IG5ldyBGdW5jdGlvbigicmV0dXJuIHRoaXMiKSgpCiAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgIm9iamVjdCIgPT0gdHlwZW9mIHdpbmRvdyAmJiAoZSA9IHdpbmRvdykKICAgIH0KICAgIHQuZXhwb3J0cyA9IGUKfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgInVzZSBzdHJpY3QiOwogICAgdmFyIGkgPSB7fS5wcm9wZXJ0eUlzRW51bWVyYWJsZSwKICAgICAgICByID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvciwKICAgICAgICBvID0gciAmJiAhaS5jYWxsKHsKICAgICAgICAgICAgMTogMgogICAgICAgIH0sIDEpOwogICAgbi5mID0gbyA/IGZ1bmN0aW9uKHQpIHsKICAgICAgICB2YXIgbiA9IHIodGhpcywgdCk7CiAgICAgICAgcmV0dXJuICEhbiAmJiBuLmVudW1lcmFibGUKICAgIH0gOiBpCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSgyKSwKICAgICAgICByID0gZSgxNCksCiAgICAgICAgbyA9ICIiLnNwbGl0OwogICAgdC5leHBvcnRzID0gaSgoZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuICFPYmplY3QoInoiKS5wcm9wZXJ0eUlzRW51bWVyYWJsZSgwKQogICAgfSkpID8gZnVuY3Rpb24odCkgewogICAgICAgIHJldHVybiAiU3RyaW5nIiA9PSByKHQpID8gby5jYWxsKHQsICIiKSA6IE9iamVjdCh0KQogICAgfSA6IE9iamVjdAp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSA9IGUoOCk7CiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgaWYgKCFpKHQpKSByZXR1cm4gdDsKICAgICAgICB2YXIgZSwgcjsKICAgICAgICBpZiAobiAmJiAiZnVuY3Rpb24iID09IHR5cGVvZihlID0gdC50b1N0cmluZykgJiYgIWkociA9IGUuY2FsbCh0KSkpIHJldHVybiByOwogICAgICAgIGlmICgiZnVuY3Rpb24iID09IHR5cGVvZihlID0gdC52YWx1ZU9mKSAmJiAhaShyID0gZS5jYWxsKHQpKSkgcmV0dXJuIHI7CiAgICAgICAgaWYgKCFuICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mKGUgPSB0LnRvU3RyaW5nKSAmJiAhaShyID0gZS5jYWxsKHQpKSkgcmV0dXJuIHI7CiAgICAgICAgdGhyb3cgVHlwZUVycm9yKCJDYW4ndCBjb252ZXJ0IG9iamVjdCB0byBwcmltaXRpdmUgdmFsdWUiKQogICAgfQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSA9IGUoNiksCiAgICAgICAgciA9IGUoMiksCiAgICAgICAgbyA9IGUoMjUpOwogICAgdC5leHBvcnRzID0gIWkgJiYgIXIoKGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiA3ICE9IE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvKCJkaXYiKSwgImEiLCB7CiAgICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gNwogICAgICAgICAgICB9CiAgICAgICAgfSkuYQogICAgfSkpCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSgwKSwKICAgICAgICByID0gZSgyNiksCiAgICAgICAgbyA9IGlbIl9fY29yZS1qc19zaGFyZWRfXyJdIHx8IHIoIl9fY29yZS1qc19zaGFyZWRfXyIsIHt9KTsKICAgIHQuZXhwb3J0cyA9IG8KfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGkgPSBlKDE2KSwKICAgICAgICByID0gZSg0Mik7CiAgICAodC5leHBvcnRzID0gZnVuY3Rpb24odCwgbikgewogICAgICAgIHJldHVybiByW3RdIHx8IChyW3RdID0gdm9pZCAwICE9PSBuID8gbiA6IHt9KQogICAgfSkoInZlcnNpb25zIiwgW10pLnB1c2goewogICAgICAgIHZlcnNpb246ICIzLjYuNSIsCiAgICAgICAgbW9kZTogaSA/ICJwdXJlIiA6ICJnbG9iYWwiLAogICAgICAgIGNvcHlyaWdodDogIsKpIDIwMjAgRGVuaXMgUHVzaGthcmV2ICh6bG9pcm9jay5ydSkiCiAgICB9KQp9LCBmdW5jdGlvbih0LCBuKSB7CiAgICB2YXIgZSA9IDAsCiAgICAgICAgaSA9IE1hdGgucmFuZG9tKCk7CiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgcmV0dXJuICJTeW1ib2woIiArIFN0cmluZyh2b2lkIDAgPT09IHQgPyAiIiA6IHQpICsgIilfIiArICgrK2UgKyBpKS50b1N0cmluZygzNikKICAgIH0KfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGkgPSBlKDMpLAogICAgICAgIHIgPSBlKDIwKSwKICAgICAgICBvID0gZSg3NSkuaW5kZXhPZiwKICAgICAgICBhID0gZSgyOSk7CiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgdmFyIGUsIHMgPSByKHQpLAogICAgICAgICAgICBkID0gMCwKICAgICAgICAgICAgYyA9IFtdOwogICAgICAgIGZvciAoZSBpbiBzKSAhaShhLCBlKSAmJiBpKHMsIGUpICYmIGMucHVzaChlKTsKICAgICAgICBmb3IgKDsgbi5sZW5ndGggPiBkOykgaShzLCBlID0gbltkKytdKSAmJiAofm8oYywgZSkgfHwgYy5wdXNoKGUpKTsKICAgICAgICByZXR1cm4gYwogICAgfQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSA9IGUoMzEpLAogICAgICAgIHIgPSBNYXRoLm1pbjsKICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICByZXR1cm4gdCA+IDAgPyByKGkodCksIDkwMDcxOTkyNTQ3NDA5OTEpIDogMAogICAgfQp9LCBmdW5jdGlvbih0LCBuKSB7CiAgICBuLmYgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSgyKSwKICAgICAgICByID0gLyN8XC5wcm90b3R5cGVcLi8sCiAgICAgICAgbyA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgdmFyIGUgPSBzW2EodCldOwogICAgICAgICAgICByZXR1cm4gZSA9PSBjIHx8IGUgIT0gZCAmJiAoImZ1bmN0aW9uIiA9PSB0eXBlb2YgbiA/IGkobikgOiAhIW4pCiAgICAgICAgfSwKICAgICAgICBhID0gby5ub3JtYWxpemUgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgIHJldHVybiBTdHJpbmcodCkucmVwbGFjZShyLCAiLiIpLnRvTG93ZXJDYXNlKCkKICAgICAgICB9LAogICAgICAgIHMgPSBvLmRhdGEgPSB7fSwKICAgICAgICBkID0gby5OQVRJVkUgPSAiTiIsCiAgICAgICAgYyA9IG8uUE9MWUZJTEwgPSAiUCI7CiAgICB0LmV4cG9ydHMgPSBvCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSg0NSksCiAgICAgICAgciA9IGUoMzIpOwogICAgdC5leHBvcnRzID0gT2JqZWN0LmtleXMgfHwgZnVuY3Rpb24odCkgewogICAgICAgIHJldHVybiBpKHQsIHIpCiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSgyNCk7CiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgcmV0dXJuIE9iamVjdChpKHQpKQogICAgfQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSA9IGUoMik7CiAgICB0LmV4cG9ydHMgPSAhIU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMgJiYgIWkoKGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiAhU3RyaW5nKFN5bWJvbCgpKQogICAgfSkpCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSgzMyksCiAgICAgICAgciA9IGUoMTQpLAogICAgICAgIG8gPSBlKDEpKCJ0b1N0cmluZ1RhZyIpLAogICAgICAgIGEgPSAiQXJndW1lbnRzIiA9PSByKGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gYXJndW1lbnRzCiAgICAgICAgfSgpKTsKICAgIHQuZXhwb3J0cyA9IGkgPyByIDogZnVuY3Rpb24odCkgewogICAgICAgIHZhciBuLCBlLCBpOwogICAgICAgIHJldHVybiB2b2lkIDAgPT09IHQgPyAiVW5kZWZpbmVkIiA6IG51bGwgPT09IHQgPyAiTnVsbCIgOiAic3RyaW5nIiA9PSB0eXBlb2YoZSA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiB0W25dCiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHt9CiAgICAgICAgfShuID0gT2JqZWN0KHQpLCBvKSkgPyBlIDogYSA/IHIobikgOiAiT2JqZWN0IiA9PSAoaSA9IHIobikpICYmICJmdW5jdGlvbiIgPT0gdHlwZW9mIG4uY2FsbGVlID8gIkFyZ3VtZW50cyIgOiBpCiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIHZhciBpID0gZSg1KSwKICAgICAgICByID0gZSg4NCksCiAgICAgICAgbyA9IGUoMzQpLAogICAgICAgIGEgPSBlKDU2KSwKICAgICAgICBzID0gZSgzNiksCiAgICAgICAgZCA9IGUoNyksCiAgICAgICAgYyA9IGUoMTIpLAogICAgICAgIHUgPSBlKDEpLAogICAgICAgIGwgPSBlKDE2KSwKICAgICAgICBBID0gZSgxNyksCiAgICAgICAgbSA9IGUoNTQpLAogICAgICAgIGYgPSBtLkl0ZXJhdG9yUHJvdG90eXBlLAogICAgICAgIHAgPSBtLkJVR0dZX1NBRkFSSV9JVEVSQVRPUlMsCiAgICAgICAgZyA9IHUoIml0ZXJhdG9yIiksCiAgICAgICAgaCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gdGhpcwogICAgICAgIH07CiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0LCBuLCBlLCB1LCBtLCB3LCB5KSB7CiAgICAgICAgcihlLCBuLCB1KTsKICAgICAgICB2YXIgdiwgYiwgaywgUyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIGlmICh0ID09PSBtICYmIEMpIHJldHVybiBDOwogICAgICAgICAgICAgICAgaWYgKCFwICYmIHQgaW4gVCkgcmV0dXJuIFRbdF07CiAgICAgICAgICAgICAgICBzd2l0Y2ggKHQpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlICJrZXlzIjoKICAgICAgICAgICAgICAgICAgICBjYXNlICJ2YWx1ZXMiOgogICAgICAgICAgICAgICAgICAgIGNhc2UgImVudHJpZXMiOgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGUodGhpcywgdCkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgZSh0aGlzKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICBFID0gbiArICIgSXRlcmF0b3IiLAogICAgICAgICAgICB4ID0gITEsCiAgICAgICAgICAgIFQgPSB0LnByb3RvdHlwZSwKICAgICAgICAgICAgeiA9IFRbZ10gfHwgVFsiQEBpdGVyYXRvciJdIHx8IG0gJiYgVFttXSwKICAgICAgICAgICAgQyA9ICFwICYmIHogfHwgUyhtKSwKICAgICAgICAgICAgSSA9ICJBcnJheSIgPT0gbiAmJiBULmVudHJpZXMgfHwgejsKICAgICAgICBpZiAoSSAmJiAodiA9IG8oSS5jYWxsKG5ldyB0KSksIGYgIT09IE9iamVjdC5wcm90b3R5cGUgJiYgdi5uZXh0ICYmIChsIHx8IG8odikgPT09IGYgfHwgKGEgPyBhKHYsIGYpIDogImZ1bmN0aW9uIiAhPSB0eXBlb2YgdltnXSAmJiBkKHYsIGcsIGgpKSwgcyh2LCBFLCAhMCwgITApLCBsICYmIChBW0VdID0gaCkpKSwgInZhbHVlcyIgPT0gbSAmJiB6ICYmICJ2YWx1ZXMiICE9PSB6Lm5hbWUgJiYgKHggPSAhMCwgQyA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHouY2FsbCh0aGlzKQogICAgICAgICAgICB9KSwgbCAmJiAheSB8fCBUW2ddID09PSBDIHx8IGQoVCwgZywgQyksIEFbbl0gPSBDLCBtKQogICAgICAgICAgICBpZiAoYiA9IHsKICAgICAgICAgICAgICAgICAgICB2YWx1ZXM6IFMoInZhbHVlcyIpLAogICAgICAgICAgICAgICAgICAgIGtleXM6IHcgPyBDIDogUygia2V5cyIpLAogICAgICAgICAgICAgICAgICAgIGVudHJpZXM6IFMoImVudHJpZXMiKQogICAgICAgICAgICAgICAgfSwgeSkKICAgICAgICAgICAgICAgIGZvciAoayBpbiBiKShwIHx8IHggfHwgIShrIGluIFQpKSAmJiBjKFQsIGssIGJba10pOwogICAgICAgICAgICBlbHNlIGkoewogICAgICAgICAgICAgICAgdGFyZ2V0OiBuLAogICAgICAgICAgICAgICAgcHJvdG86ICEwLAogICAgICAgICAgICAgICAgZm9yY2VkOiBwIHx8IHgKICAgICAgICAgICAgfSwgYik7CiAgICAgICAgcmV0dXJuIGIKICAgIH0KfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgInVzZSBzdHJpY3QiOwogICAgdmFyIGksIHIsIG8sIGEgPSBlKDM0KSwKICAgICAgICBzID0gZSg3KSwKICAgICAgICBkID0gZSgzKSwKICAgICAgICBjID0gZSgxKSwKICAgICAgICB1ID0gZSgxNiksCiAgICAgICAgbCA9IGMoIml0ZXJhdG9yIiksCiAgICAgICAgQSA9ICExOwogICAgW10ua2V5cyAmJiAoIm5leHQiIGluIChvID0gW10ua2V5cygpKSA/IChyID0gYShhKG8pKSkgIT09IE9iamVjdC5wcm90b3R5cGUgJiYgKGkgPSByKSA6IEEgPSAhMCksIG51bGwgPT0gaSAmJiAoaSA9IHt9KSwgdSB8fCBkKGksIGwpIHx8IHMoaSwgbCwgKGZ1bmN0aW9uKCkgewogICAgICAgIHJldHVybiB0aGlzCiAgICB9KSksIHQuZXhwb3J0cyA9IHsKICAgICAgICBJdGVyYXRvclByb3RvdHlwZTogaSwKICAgICAgICBCVUdHWV9TQUZBUklfSVRFUkFUT1JTOiBBCiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSgxMCk7CiAgICB0LmV4cG9ydHMgPSBpKCJkb2N1bWVudCIsICJkb2N1bWVudEVsZW1lbnQiKQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSA9IGUoNCksCiAgICAgICAgciA9IGUoODcpOwogICAgdC5leHBvcnRzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8ICgiX19wcm90b19fIiBpbiB7fSA/IGZ1bmN0aW9uKCkgewogICAgICAgIHZhciB0LCBuID0gITEsCiAgICAgICAgICAgIGUgPSB7fTsKICAgICAgICB0cnkgewogICAgICAgICAgICAodCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoT2JqZWN0LnByb3RvdHlwZSwgIl9fcHJvdG9fXyIpLnNldCkuY2FsbChlLCBbXSksIG4gPSBlIGluc3RhbmNlb2YgQXJyYXkKICAgICAgICB9IGNhdGNoICh0KSB7fQogICAgICAgIHJldHVybiBmdW5jdGlvbihlLCBvKSB7CiAgICAgICAgICAgIHJldHVybiBpKGUpLCByKG8pLCBuID8gdC5jYWxsKGUsIG8pIDogZS5fX3Byb3RvX18gPSBvLCBlCiAgICAgICAgfQogICAgfSgpIDogdm9pZCAwKQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSA9IGUoMCk7CiAgICB0LmV4cG9ydHMgPSBpLlByb21pc2UKfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGkgPSBlKDEzKTsKICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgICAgICBpZiAoaSh0KSwgdm9pZCAwID09PSBuKSByZXR1cm4gdDsKICAgICAgICBzd2l0Y2ggKGUpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmNhbGwobikKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuY2FsbChuLCBlKQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUsIGkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5jYWxsKG4sIGUsIGkpCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSwgaSwgcikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmNhbGwobiwgZSwgaSwgcikKICAgICAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gdC5hcHBseShuLCBhcmd1bWVudHMpCiAgICAgICAgfQogICAgfQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSA9IGUoNCksCiAgICAgICAgciA9IGUoMTMpLAogICAgICAgIG8gPSBlKDEpKCJzcGVjaWVzIik7CiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgdmFyIGUsIGEgPSBpKHQpLmNvbnN0cnVjdG9yOwogICAgICAgIHJldHVybiB2b2lkIDAgPT09IGEgfHwgbnVsbCA9PSAoZSA9IGkoYSlbb10pID8gbiA6IHIoZSkKICAgIH0KfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGksIHIsIG8sIGEgPSBlKDApLAogICAgICAgIHMgPSBlKDIpLAogICAgICAgIGQgPSBlKDE0KSwKICAgICAgICBjID0gZSg1OCksCiAgICAgICAgdSA9IGUoNTUpLAogICAgICAgIGwgPSBlKDI1KSwKICAgICAgICBBID0gZSg2MSksCiAgICAgICAgbSA9IGEubG9jYXRpb24sCiAgICAgICAgZiA9IGEuc2V0SW1tZWRpYXRlLAogICAgICAgIHAgPSBhLmNsZWFySW1tZWRpYXRlLAogICAgICAgIGcgPSBhLnByb2Nlc3MsCiAgICAgICAgaCA9IGEuTWVzc2FnZUNoYW5uZWwsCiAgICAgICAgdyA9IGEuRGlzcGF0Y2gsCiAgICAgICAgeSA9IDAsCiAgICAgICAgdiA9IHt9LAogICAgICAgIGIgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgIGlmICh2Lmhhc093blByb3BlcnR5KHQpKSB7CiAgICAgICAgICAgICAgICB2YXIgbiA9IHZbdF07CiAgICAgICAgICAgICAgICBkZWxldGUgdlt0XSwgbigpCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGsgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIGIodCkKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgUyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgYih0LmRhdGEpCiAgICAgICAgfSwKICAgICAgICBFID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICBhLnBvc3RNZXNzYWdlKHQgKyAiIiwgbS5wcm90b2NvbCArICIvLyIgKyBtLmhvc3QpCiAgICAgICAgfTsKICAgIGYgJiYgcCB8fCAoZiA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICBmb3IgKHZhciBuID0gW10sIGUgPSAxOyBhcmd1bWVudHMubGVuZ3RoID4gZTspIG4ucHVzaChhcmd1bWVudHNbZSsrXSk7CiAgICAgICAgcmV0dXJuIHZbKyt5XSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAoImZ1bmN0aW9uIiA9PSB0eXBlb2YgdCA/IHQgOiBGdW5jdGlvbih0KSkuYXBwbHkodm9pZCAwLCBuKQogICAgICAgIH0sIGkoeSksIHkKICAgIH0sIHAgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgZGVsZXRlIHZbdF0KICAgIH0sICJwcm9jZXNzIiA9PSBkKGcpID8gaSA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICBnLm5leHRUaWNrKGsodCkpCiAgICB9IDogdyAmJiB3Lm5vdyA/IGkgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgdy5ub3coayh0KSkKICAgIH0gOiBoICYmICFBID8gKG8gPSAociA9IG5ldyBoKS5wb3J0Miwgci5wb3J0MS5vbm1lc3NhZ2UgPSBTLCBpID0gYyhvLnBvc3RNZXNzYWdlLCBvLCAxKSkgOiAhYS5hZGRFdmVudExpc3RlbmVyIHx8ICJmdW5jdGlvbiIgIT0gdHlwZW9mIHBvc3RNZXNzYWdlIHx8IGEuaW1wb3J0U2NyaXB0cyB8fCBzKEUpIHx8ICJmaWxlOiIgPT09IG0ucHJvdG9jb2wgPyBpID0gIm9ucmVhZHlzdGF0ZWNoYW5nZSIgaW4gbCgic2NyaXB0IikgPyBmdW5jdGlvbih0KSB7CiAgICAgICAgdS5hcHBlbmRDaGlsZChsKCJzY3JpcHQiKSkub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHUucmVtb3ZlQ2hpbGQodGhpcyksIGIodCkKICAgICAgICB9CiAgICB9IDogZnVuY3Rpb24odCkgewogICAgICAgIHNldFRpbWVvdXQoayh0KSwgMCkKICAgIH0gOiAoaSA9IEUsIGEuYWRkRXZlbnRMaXN0ZW5lcigibWVzc2FnZSIsIFMsICExKSkpLCB0LmV4cG9ydHMgPSB7CiAgICAgICAgc2V0OiBmLAogICAgICAgIGNsZWFyOiBwCiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSg2Mik7CiAgICB0LmV4cG9ydHMgPSAvKGlwaG9uZXxpcG9kfGlwYWQpLiphcHBsZXdlYmtpdC9pLnRlc3QoaSkKfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGkgPSBlKDEwKTsKICAgIHQuZXhwb3J0cyA9IGkoIm5hdmlnYXRvciIsICJ1c2VyQWdlbnQiKSB8fCAiIgp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSA9IGUoNCksCiAgICAgICAgciA9IGUoOCksCiAgICAgICAgbyA9IGUoMTgpOwogICAgdC5leHBvcnRzID0gZnVuY3Rpb24odCwgbikgewogICAgICAgIGlmIChpKHQpLCByKG4pICYmIG4uY29uc3RydWN0b3IgPT09IHQpIHJldHVybiBuOwogICAgICAgIHZhciBlID0gby5mKHQpOwogICAgICAgIHJldHVybiAoMCwgZS5yZXNvbHZlKShuKSwgZS5wcm9taXNlCiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIHZhciBpID0gZSg1KSwKICAgICAgICByID0gZSgxMyksCiAgICAgICAgbyA9IGUoMTgpLAogICAgICAgIGEgPSBlKDIyKSwKICAgICAgICBzID0gZSgyMSk7CiAgICBpKHsKICAgICAgICB0YXJnZXQ6ICJQcm9taXNlIiwKICAgICAgICBzdGF0OiAhMAogICAgfSwgewogICAgICAgIGFsbFNldHRsZWQ6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgdmFyIG4gPSB0aGlzLAogICAgICAgICAgICAgICAgZSA9IG8uZihuKSwKICAgICAgICAgICAgICAgIGkgPSBlLnJlc29sdmUsCiAgICAgICAgICAgICAgICBkID0gZS5yZWplY3QsCiAgICAgICAgICAgICAgICBjID0gYSgoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSByKG4ucmVzb2x2ZSksCiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgYSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGQgPSAxOwogICAgICAgICAgICAgICAgICAgIHModCwgKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBhKyssCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzID0gITE7CiAgICAgICAgICAgICAgICAgICAgICAgIG8ucHVzaCh2b2lkIDApLCBkKyssIGUuY2FsbChuLCB0KS50aGVuKChmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzIHx8IChzID0gITAsIG9bcl0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAiZnVsZmlsbGVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgLS1kIHx8IGkobykpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pLCAoZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcyB8fCAocyA9ICEwLCBvW3JdID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogInJlamVjdGVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb246IHQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIC0tZCB8fCBpKG8pKQogICAgICAgICAgICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgICAgICAgICB9KSksIC0tZCB8fCBpKG8pCiAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIHJldHVybiBjLmVycm9yICYmIGQoYy52YWx1ZSksIGUucHJvbWlzZQogICAgICAgIH0KICAgIH0pCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSg2OSk7CiAgICB0LmV4cG9ydHMgPSBpCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSg3OCk7CiAgICBlKDEwNCksIGUoMTA1KSwgZSgxMDYpLCBlKDEwNyksIHQuZXhwb3J0cyA9IGkKfSwgZnVuY3Rpb24odCkgewogICAgdC5leHBvcnRzID0gSlNPTi5wYXJzZSgneyJhIjoiLi9wcmViaWQ0LjEyLjAuanMifScpCn0sICwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgZSg3MCk7CiAgICB2YXIgaSA9IGUoMzApOwogICAgdC5leHBvcnRzID0gaS5PYmplY3QuYXNzaWduCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSg1KSwKICAgICAgICByID0gZSg3Nyk7CiAgICBpKHsKICAgICAgICB0YXJnZXQ6ICJPYmplY3QiLAogICAgICAgIHN0YXQ6ICEwLAogICAgICAgIGZvcmNlZDogT2JqZWN0LmFzc2lnbiAhPT0gcgogICAgfSwgewogICAgICAgIGFzc2lnbjogcgogICAgfSkKfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGkgPSBlKDApLAogICAgICAgIHIgPSBlKDI3KSwKICAgICAgICBvID0gaS5XZWFrTWFwOwogICAgdC5leHBvcnRzID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgbyAmJiAvbmF0aXZlIGNvZGUvLnRlc3QocihvKSkKfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGkgPSBlKDMpLAogICAgICAgIHIgPSBlKDczKSwKICAgICAgICBvID0gZSgyMyksCiAgICAgICAgYSA9IGUoOSk7CiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgZm9yICh2YXIgZSA9IHIobiksIHMgPSBhLmYsIGQgPSBvLmYsIGMgPSAwOyBjIDwgZS5sZW5ndGg7IGMrKykgewogICAgICAgICAgICB2YXIgdSA9IGVbY107CiAgICAgICAgICAgIGkodCwgdSkgfHwgcyh0LCB1LCBkKG4sIHUpKQogICAgICAgIH0KICAgIH0KfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGkgPSBlKDEwKSwKICAgICAgICByID0gZSg3NCksCiAgICAgICAgbyA9IGUoNDcpLAogICAgICAgIGEgPSBlKDQpOwogICAgdC5leHBvcnRzID0gaSgiUmVmbGVjdCIsICJvd25LZXlzIikgfHwgZnVuY3Rpb24odCkgewogICAgICAgIHZhciBuID0gci5mKGEodCkpLAogICAgICAgICAgICBlID0gby5mOwogICAgICAgIHJldHVybiBlID8gbi5jb25jYXQoZSh0KSkgOiBuCiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSg0NSksCiAgICAgICAgciA9IGUoMzIpLmNvbmNhdCgibGVuZ3RoIiwgInByb3RvdHlwZSIpOwogICAgbi5mID0gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMgfHwgZnVuY3Rpb24odCkgewogICAgICAgIHJldHVybiBpKHQsIHIpCiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSgyMCksCiAgICAgICAgciA9IGUoNDYpLAogICAgICAgIG8gPSBlKDc2KSwKICAgICAgICBhID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24obiwgZSwgYSkgewogICAgICAgICAgICAgICAgdmFyIHMsIGQgPSBpKG4pLAogICAgICAgICAgICAgICAgICAgIGMgPSByKGQubGVuZ3RoKSwKICAgICAgICAgICAgICAgICAgICB1ID0gbyhhLCBjKTsKICAgICAgICAgICAgICAgIGlmICh0ICYmIGUgIT0gZSkgewogICAgICAgICAgICAgICAgICAgIGZvciAoOyBjID4gdTspCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgocyA9IGRbdSsrXSkgIT0gcykgcmV0dXJuICEwCiAgICAgICAgICAgICAgICB9IGVsc2UKICAgICAgICAgICAgICAgICAgICBmb3IgKDsgYyA+IHU7IHUrKykKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh0IHx8IHUgaW4gZCkgJiYgZFt1XSA9PT0gZSkgcmV0dXJuIHQgfHwgdSB8fCAwOwogICAgICAgICAgICAgICAgcmV0dXJuICF0ICYmIC0xCiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgdC5leHBvcnRzID0gewogICAgICAgIGluY2x1ZGVzOiBhKCEwKSwKICAgICAgICBpbmRleE9mOiBhKCExKQogICAgfQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSA9IGUoMzEpLAogICAgICAgIHIgPSBNYXRoLm1heCwKICAgICAgICBvID0gTWF0aC5taW47CiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgdmFyIGUgPSBpKHQpOwogICAgICAgIHJldHVybiBlIDwgMCA/IHIoZSArIG4sIDApIDogbyhlLCBuKQogICAgfQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICB2YXIgaSA9IGUoNiksCiAgICAgICAgciA9IGUoMiksCiAgICAgICAgbyA9IGUoNDkpLAogICAgICAgIGEgPSBlKDQ3KSwKICAgICAgICBzID0gZSgzOCksCiAgICAgICAgZCA9IGUoNTApLAogICAgICAgIGMgPSBlKDM5KSwKICAgICAgICB1ID0gT2JqZWN0LmFzc2lnbiwKICAgICAgICBsID0gT2JqZWN0LmRlZmluZVByb3BlcnR5OwogICAgdC5leHBvcnRzID0gIXUgfHwgcigoZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKGkgJiYgMSAhPT0gdSh7CiAgICAgICAgICAgICAgICBiOiAxCiAgICAgICAgICAgIH0sIHUobCh7fSwgImEiLCB7CiAgICAgICAgICAgICAgICBlbnVtZXJhYmxlOiAhMCwKICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgbCh0aGlzLCAiYiIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IDMsCiAgICAgICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6ICExCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSksIHsKICAgICAgICAgICAgICAgIGI6IDIKICAgICAgICAgICAgfSkpLmIpIHJldHVybiAhMDsKICAgICAgICB2YXIgdCA9IHt9LAogICAgICAgICAgICBuID0ge30sCiAgICAgICAgICAgIGUgPSBTeW1ib2woKTsKICAgICAgICByZXR1cm4gdFtlXSA9IDcsICJhYmNkZWZnaGlqa2xtbm9wcXJzdCIuc3BsaXQoIiIpLmZvckVhY2goKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgblt0XSA9IHQKICAgICAgICB9KSksIDcgIT0gdSh7fSwgdClbZV0gfHwgImFiY2RlZmdoaWprbG1ub3BxcnN0IiAhPSBvKHUoe30sIG4pKS5qb2luKCIiKQogICAgfSkpID8gZnVuY3Rpb24odCwgbikgewogICAgICAgIGZvciAodmFyIGUgPSBkKHQpLCByID0gYXJndW1lbnRzLmxlbmd0aCwgdSA9IDEsIGwgPSBhLmYsIEEgPSBzLmY7IHIgPiB1OykKICAgICAgICAgICAgZm9yICh2YXIgbSwgZiA9IGMoYXJndW1lbnRzW3UrK10pLCBwID0gbCA/IG8oZikuY29uY2F0KGwoZikpIDogbyhmKSwgZyA9IHAubGVuZ3RoLCBoID0gMDsgZyA+IGg7KSBtID0gcFtoKytdLCBpICYmICFBLmNhbGwoZiwgbSkgfHwgKGVbbV0gPSBmW21dKTsKICAgICAgICByZXR1cm4gZQogICAgfSA6IHUKfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgZSg3OSksIGUoODIpLCBlKDg4KSwgZSg5MiksIGUoNjQpLCBlKDEwMyk7CiAgICB2YXIgaSA9IGUoMzApOwogICAgdC5leHBvcnRzID0gaS5Qcm9taXNlCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSgzMyksCiAgICAgICAgciA9IGUoMTIpLAogICAgICAgIG8gPSBlKDgxKTsKICAgIGkgfHwgcihPYmplY3QucHJvdG90eXBlLCAidG9TdHJpbmciLCBvLCB7CiAgICAgICAgdW5zYWZlOiAhMAogICAgfSkKfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGkgPSBlKDUxKTsKICAgIHQuZXhwb3J0cyA9IGkgJiYgIVN5bWJvbC5zaGFtICYmICJzeW1ib2wiID09IHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IKfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgInVzZSBzdHJpY3QiOwogICAgdmFyIGkgPSBlKDMzKSwKICAgICAgICByID0gZSg1Mik7CiAgICB0LmV4cG9ydHMgPSBpID8ge30udG9TdHJpbmcgOiBmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gIltvYmplY3QgIiArIHIodGhpcykgKyAiXSIKICAgIH0KfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgInVzZSBzdHJpY3QiOwogICAgdmFyIGkgPSBlKDgzKS5jaGFyQXQsCiAgICAgICAgciA9IGUoMTUpLAogICAgICAgIG8gPSBlKDUzKSwKICAgICAgICBhID0gci5zZXQsCiAgICAgICAgcyA9IHIuZ2V0dGVyRm9yKCJTdHJpbmcgSXRlcmF0b3IiKTsKICAgIG8oU3RyaW5nLCAiU3RyaW5nIiwgKGZ1bmN0aW9uKHQpIHsKICAgICAgICBhKHRoaXMsIHsKICAgICAgICAgICAgdHlwZTogIlN0cmluZyBJdGVyYXRvciIsCiAgICAgICAgICAgIHN0cmluZzogU3RyaW5nKHQpLAogICAgICAgICAgICBpbmRleDogMAogICAgICAgIH0pCiAgICB9KSwgKGZ1bmN0aW9uKCkgewogICAgICAgIHZhciB0LCBuID0gcyh0aGlzKSwKICAgICAgICAgICAgZSA9IG4uc3RyaW5nLAogICAgICAgICAgICByID0gbi5pbmRleDsKICAgICAgICByZXR1cm4gciA+PSBlLmxlbmd0aCA/IHsKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMCwKICAgICAgICAgICAgZG9uZTogITAKICAgICAgICB9IDogKHQgPSBpKGUsIHIpLCBuLmluZGV4ICs9IHQubGVuZ3RoLCB7CiAgICAgICAgICAgIHZhbHVlOiB0LAogICAgICAgICAgICBkb25lOiAhMQogICAgICAgIH0pCiAgICB9KSkKfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGkgPSBlKDMxKSwKICAgICAgICByID0gZSgyNCksCiAgICAgICAgbyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKG4sIGUpIHsKICAgICAgICAgICAgICAgIHZhciBvLCBhLCBzID0gU3RyaW5nKHIobikpLAogICAgICAgICAgICAgICAgICAgIGQgPSBpKGUpLAogICAgICAgICAgICAgICAgICAgIGMgPSBzLmxlbmd0aDsKICAgICAgICAgICAgICAgIHJldHVybiBkIDwgMCB8fCBkID49IGMgPyB0ID8gIiIgOiB2b2lkIDAgOiAobyA9IHMuY2hhckNvZGVBdChkKSkgPCA1NTI5NiB8fCBvID4gNTYzMTkgfHwgZCArIDEgPT09IGMgfHwgKGEgPSBzLmNoYXJDb2RlQXQoZCArIDEpKSA8IDU2MzIwIHx8IGEgPiA1NzM0MyA/IHQgPyBzLmNoYXJBdChkKSA6IG8gOiB0ID8gcy5zbGljZShkLCBkICsgMikgOiBhIC0gNTYzMjAgKyAobyAtIDU1Mjk2IDw8IDEwKSArIDY1NTM2CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgdC5leHBvcnRzID0gewogICAgICAgIGNvZGVBdDogbyghMSksCiAgICAgICAgY2hhckF0OiBvKCEwKQogICAgfQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICB2YXIgaSA9IGUoNTQpLkl0ZXJhdG9yUHJvdG90eXBlLAogICAgICAgIHIgPSBlKDM1KSwKICAgICAgICBvID0gZSgxOSksCiAgICAgICAgYSA9IGUoMzYpLAogICAgICAgIHMgPSBlKDE3KSwKICAgICAgICBkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzCiAgICAgICAgfTsKICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgICAgICB2YXIgYyA9IG4gKyAiIEl0ZXJhdG9yIjsKICAgICAgICByZXR1cm4gdC5wcm90b3R5cGUgPSByKGksIHsKICAgICAgICAgICAgbmV4dDogbygxLCBlKQogICAgICAgIH0pLCBhKHQsIGMsICExLCAhMCksIHNbY10gPSBkLCB0CiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSgyKTsKICAgIHQuZXhwb3J0cyA9ICFpKChmdW5jdGlvbigpIHsKICAgICAgICBmdW5jdGlvbiB0KCkge30KICAgICAgICByZXR1cm4gdC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBudWxsLCBPYmplY3QuZ2V0UHJvdG90eXBlT2YobmV3IHQpICE9PSB0LnByb3RvdHlwZQogICAgfSkpCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSg2KSwKICAgICAgICByID0gZSg5KSwKICAgICAgICBvID0gZSg0KSwKICAgICAgICBhID0gZSg0OSk7CiAgICB0LmV4cG9ydHMgPSBpID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMgOiBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgbyh0KTsKICAgICAgICBmb3IgKHZhciBlLCBpID0gYShuKSwgcyA9IGkubGVuZ3RoLCBkID0gMDsgcyA+IGQ7KSByLmYodCwgZSA9IGlbZCsrXSwgbltlXSk7CiAgICAgICAgcmV0dXJuIHQKICAgIH0KfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGkgPSBlKDgpOwogICAgdC5leHBvcnRzID0gZnVuY3Rpb24odCkgewogICAgICAgIGlmICghaSh0KSAmJiBudWxsICE9PSB0KSB0aHJvdyBUeXBlRXJyb3IoIkNhbid0IHNldCAiICsgU3RyaW5nKHQpICsgIiBhcyBhIHByb3RvdHlwZSIpOwogICAgICAgIHJldHVybiB0CiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSgwKSwKICAgICAgICByID0gZSg4OSksCiAgICAgICAgbyA9IGUoOTApLAogICAgICAgIGEgPSBlKDcpLAogICAgICAgIHMgPSBlKDEpLAogICAgICAgIGQgPSBzKCJpdGVyYXRvciIpLAogICAgICAgIGMgPSBzKCJ0b1N0cmluZ1RhZyIpLAogICAgICAgIHUgPSBvLnZhbHVlczsKICAgIGZvciAodmFyIGwgaW4gcikgewogICAgICAgIHZhciBBID0gaVtsXSwKICAgICAgICAgICAgbSA9IEEgJiYgQS5wcm90b3R5cGU7CiAgICAgICAgaWYgKG0pIHsKICAgICAgICAgICAgaWYgKG1bZF0gIT09IHUpIHRyeSB7CiAgICAgICAgICAgICAgICBhKG0sIGQsIHUpCiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgIG1bZF0gPSB1CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKG1bY10gfHwgYShtLCBjLCBsKSwgcltsXSkKICAgICAgICAgICAgICAgIGZvciAodmFyIGYgaW4gbykKICAgICAgICAgICAgICAgICAgICBpZiAobVtmXSAhPT0gb1tmXSkgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgYShtLCBmLCBvW2ZdKQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbVtmXSA9IG9bZl0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9LCBmdW5jdGlvbih0LCBuKSB7CiAgICB0LmV4cG9ydHMgPSB7CiAgICAgICAgQ1NTUnVsZUxpc3Q6IDAsCiAgICAgICAgQ1NTU3R5bGVEZWNsYXJhdGlvbjogMCwKICAgICAgICBDU1NWYWx1ZUxpc3Q6IDAsCiAgICAgICAgQ2xpZW50UmVjdExpc3Q6IDAsCiAgICAgICAgRE9NUmVjdExpc3Q6IDAsCiAgICAgICAgRE9NU3RyaW5nTGlzdDogMCwKICAgICAgICBET01Ub2tlbkxpc3Q6IDEsCiAgICAgICAgRGF0YVRyYW5zZmVySXRlbUxpc3Q6IDAsCiAgICAgICAgRmlsZUxpc3Q6IDAsCiAgICAgICAgSFRNTEFsbENvbGxlY3Rpb246IDAsCiAgICAgICAgSFRNTENvbGxlY3Rpb246IDAsCiAgICAgICAgSFRNTEZvcm1FbGVtZW50OiAwLAogICAgICAgIEhUTUxTZWxlY3RFbGVtZW50OiAwLAogICAgICAgIE1lZGlhTGlzdDogMCwKICAgICAgICBNaW1lVHlwZUFycmF5OiAwLAogICAgICAgIE5hbWVkTm9kZU1hcDogMCwKICAgICAgICBOb2RlTGlzdDogMSwKICAgICAgICBQYWludFJlcXVlc3RMaXN0OiAwLAogICAgICAgIFBsdWdpbjogMCwKICAgICAgICBQbHVnaW5BcnJheTogMCwKICAgICAgICBTVkdMZW5ndGhMaXN0OiAwLAogICAgICAgIFNWR051bWJlckxpc3Q6IDAsCiAgICAgICAgU1ZHUGF0aFNlZ0xpc3Q6IDAsCiAgICAgICAgU1ZHUG9pbnRMaXN0OiAwLAogICAgICAgIFNWR1N0cmluZ0xpc3Q6IDAsCiAgICAgICAgU1ZHVHJhbnNmb3JtTGlzdDogMCwKICAgICAgICBTb3VyY2VCdWZmZXJMaXN0OiAwLAogICAgICAgIFN0eWxlU2hlZXRMaXN0OiAwLAogICAgICAgIFRleHRUcmFja0N1ZUxpc3Q6IDAsCiAgICAgICAgVGV4dFRyYWNrTGlzdDogMCwKICAgICAgICBUb3VjaExpc3Q6IDAKICAgIH0KfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgInVzZSBzdHJpY3QiOwogICAgdmFyIGkgPSBlKDIwKSwKICAgICAgICByID0gZSg5MSksCiAgICAgICAgbyA9IGUoMTcpLAogICAgICAgIGEgPSBlKDE1KSwKICAgICAgICBzID0gZSg1MyksCiAgICAgICAgZCA9IGEuc2V0LAogICAgICAgIGMgPSBhLmdldHRlckZvcigiQXJyYXkgSXRlcmF0b3IiKTsKICAgIHQuZXhwb3J0cyA9IHMoQXJyYXksICJBcnJheSIsIChmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgZCh0aGlzLCB7CiAgICAgICAgICAgIHR5cGU6ICJBcnJheSBJdGVyYXRvciIsCiAgICAgICAgICAgIHRhcmdldDogaSh0KSwKICAgICAgICAgICAgaW5kZXg6IDAsCiAgICAgICAgICAgIGtpbmQ6IG4KICAgICAgICB9KQogICAgfSksIChmdW5jdGlvbigpIHsKICAgICAgICB2YXIgdCA9IGModGhpcyksCiAgICAgICAgICAgIG4gPSB0LnRhcmdldCwKICAgICAgICAgICAgZSA9IHQua2luZCwKICAgICAgICAgICAgaSA9IHQuaW5kZXgrKzsKICAgICAgICByZXR1cm4gIW4gfHwgaSA+PSBuLmxlbmd0aCA/ICh0LnRhcmdldCA9IHZvaWQgMCwgewogICAgICAgICAgICB2YWx1ZTogdm9pZCAwLAogICAgICAgICAgICBkb25lOiAhMAogICAgICAgIH0pIDogImtleXMiID09IGUgPyB7CiAgICAgICAgICAgIHZhbHVlOiBpLAogICAgICAgICAgICBkb25lOiAhMQogICAgICAgIH0gOiAidmFsdWVzIiA9PSBlID8gewogICAgICAgICAgICB2YWx1ZTogbltpXSwKICAgICAgICAgICAgZG9uZTogITEKICAgICAgICB9IDogewogICAgICAgICAgICB2YWx1ZTogW2ksIG5baV1dLAogICAgICAgICAgICBkb25lOiAhMQogICAgICAgIH0KICAgIH0pLCAidmFsdWVzIiksIG8uQXJndW1lbnRzID0gby5BcnJheSwgcigia2V5cyIpLCByKCJ2YWx1ZXMiKSwgcigiZW50cmllcyIpCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSgxKSwKICAgICAgICByID0gZSgzNSksCiAgICAgICAgbyA9IGUoOSksCiAgICAgICAgYSA9IGkoInVuc2NvcGFibGVzIiksCiAgICAgICAgcyA9IEFycmF5LnByb3RvdHlwZTsKICAgIG51bGwgPT0gc1thXSAmJiBvLmYocywgYSwgewogICAgICAgIGNvbmZpZ3VyYWJsZTogITAsCiAgICAgICAgdmFsdWU6IHIobnVsbCkKICAgIH0pLCB0LmV4cG9ydHMgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgc1thXVt0XSA9ICEwCiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIHZhciBpLCByLCBvLCBhLCBzID0gZSg1KSwKICAgICAgICBkID0gZSgxNiksCiAgICAgICAgYyA9IGUoMCksCiAgICAgICAgdSA9IGUoMTApLAogICAgICAgIGwgPSBlKDU3KSwKICAgICAgICBBID0gZSgxMiksCiAgICAgICAgbSA9IGUoOTMpLAogICAgICAgIGYgPSBlKDM2KSwKICAgICAgICBwID0gZSg5NCksCiAgICAgICAgZyA9IGUoOCksCiAgICAgICAgaCA9IGUoMTMpLAogICAgICAgIHcgPSBlKDk1KSwKICAgICAgICB5ID0gZSgxNCksCiAgICAgICAgdiA9IGUoMjcpLAogICAgICAgIGIgPSBlKDIxKSwKICAgICAgICBrID0gZSg5OSksCiAgICAgICAgUyA9IGUoNTkpLAogICAgICAgIEUgPSBlKDYwKS5zZXQsCiAgICAgICAgeCA9IGUoMTAwKSwKICAgICAgICBUID0gZSg2MyksCiAgICAgICAgeiA9IGUoMTAxKSwKICAgICAgICBDID0gZSgxOCksCiAgICAgICAgSSA9IGUoMjIpLAogICAgICAgIF8gPSBlKDE1KSwKICAgICAgICBCID0gZSg0OCksCiAgICAgICAgUCA9IGUoMSksCiAgICAgICAgRCA9IGUoMTAyKSwKICAgICAgICBMID0gUCgic3BlY2llcyIpLAogICAgICAgIE8gPSAiUHJvbWlzZSIsCiAgICAgICAgaiA9IF8uZ2V0LAogICAgICAgIFIgPSBfLnNldCwKICAgICAgICBNID0gXy5nZXR0ZXJGb3IoTyksCiAgICAgICAgWiA9IGwsCiAgICAgICAgRyA9IGMuVHlwZUVycm9yLAogICAgICAgIE4gPSBjLmRvY3VtZW50LAogICAgICAgIEYgPSBjLnByb2Nlc3MsCiAgICAgICAgWCA9IHUoImZldGNoIiksCiAgICAgICAgVSA9IEMuZiwKICAgICAgICBRID0gVSwKICAgICAgICBIID0gInByb2Nlc3MiID09IHkoRiksCiAgICAgICAgVyA9ICEhKE4gJiYgTi5jcmVhdGVFdmVudCAmJiBjLmRpc3BhdGNoRXZlbnQpLAogICAgICAgIFYgPSBCKE8sIChmdW5jdGlvbigpIHsKICAgICAgICAgICAgaWYgKCEodihaKSAhPT0gU3RyaW5nKFopKSkgewogICAgICAgICAgICAgICAgaWYgKDY2ID09PSBEKSByZXR1cm4gITA7CiAgICAgICAgICAgICAgICBpZiAoIUggJiYgImZ1bmN0aW9uIiAhPSB0eXBlb2YgUHJvbWlzZVJlamVjdGlvbkV2ZW50KSByZXR1cm4gITAKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZCAmJiAhWi5wcm90b3R5cGUuZmluYWxseSkgcmV0dXJuICEwOwogICAgICAgICAgICBpZiAoRCA+PSA1MSAmJiAvbmF0aXZlIGNvZGUvLnRlc3QoWikpIHJldHVybiAhMTsKICAgICAgICAgICAgdmFyIHQgPSBaLnJlc29sdmUoMSksCiAgICAgICAgICAgICAgICBuID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgIHQoKGZ1bmN0aW9uKCkge30pLCAoZnVuY3Rpb24oKSB7fSkpCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICByZXR1cm4gKHQuY29uc3RydWN0b3IgPSB7fSlbTF0gPSBuLCAhKHQudGhlbigoZnVuY3Rpb24oKSB7fSkpIGluc3RhbmNlb2YgbikKICAgICAgICB9KSksCiAgICAgICAgcSA9IFYgfHwgIWsoKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgWi5hbGwodCkuY2F0Y2goKGZ1bmN0aW9uKCkge30pKQogICAgICAgIH0pKSwKICAgICAgICBLID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICB2YXIgbjsKICAgICAgICAgICAgcmV0dXJuICEoIWcodCkgfHwgImZ1bmN0aW9uIiAhPSB0eXBlb2YobiA9IHQudGhlbikpICYmIG4KICAgICAgICB9LAogICAgICAgIEogPSBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICAgICAgICAgIGlmICghbi5ub3RpZmllZCkgewogICAgICAgICAgICAgICAgbi5ub3RpZmllZCA9ICEwOwogICAgICAgICAgICAgICAgdmFyIGkgPSBuLnJlYWN0aW9uczsKICAgICAgICAgICAgICAgIHgoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHIgPSBuLnZhbHVlLCBvID0gMSA9PSBuLnN0YXRlLCBhID0gMDsgaS5sZW5ndGggPiBhOykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcywgZCwgYywgdSA9IGlbYSsrXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGwgPSBvID8gdS5vayA6IHUuZmFpbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEEgPSB1LnJlc29sdmUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtID0gdS5yZWplY3QsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmID0gdS5kb21haW47CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsID8gKG8gfHwgKDIgPT09IG4ucmVqZWN0aW9uICYmIG50KHQsIG4pLCBuLnJlamVjdGlvbiA9IDEpLCAhMCA9PT0gbCA/IHMgPSByIDogKGYgJiYgZi5lbnRlcigpLCBzID0gbChyKSwgZiAmJiAoZi5leGl0KCksIGMgPSAhMCkpLCBzID09PSB1LnByb21pc2UgPyBtKEcoIlByb21pc2UtY2hhaW4gY3ljbGUiKSkgOiAoZCA9IEsocykpID8gZC5jYWxsKHMsIEEsIG0pIDogQShzKSkgOiBtKHIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYgJiYgIWMgJiYgZi5leGl0KCksIG0odCkKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBuLnJlYWN0aW9ucyA9IFtdLCBuLm5vdGlmaWVkID0gITEsIGUgJiYgIW4ucmVqZWN0aW9uICYmICQodCwgbikKICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBZID0gZnVuY3Rpb24odCwgbiwgZSkgewogICAgICAgICAgICB2YXIgaSwgcjsKICAgICAgICAgICAgVyA/ICgoaSA9IE4uY3JlYXRlRXZlbnQoIkV2ZW50IikpLnByb21pc2UgPSBuLCBpLnJlYXNvbiA9IGUsIGkuaW5pdEV2ZW50KHQsICExLCAhMCksIGMuZGlzcGF0Y2hFdmVudChpKSkgOiBpID0gewogICAgICAgICAgICAgICAgcHJvbWlzZTogbiwKICAgICAgICAgICAgICAgIHJlYXNvbjogZQogICAgICAgICAgICB9LCAociA9IGNbIm9uIiArIHRdKSA/IHIoaSkgOiAidW5oYW5kbGVkcmVqZWN0aW9uIiA9PT0gdCAmJiB6KCJVbmhhbmRsZWQgcHJvbWlzZSByZWplY3Rpb24iLCBlKQogICAgICAgIH0sCiAgICAgICAgJCA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgRS5jYWxsKGMsIChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHZhciBlLCBpID0gbi52YWx1ZTsKICAgICAgICAgICAgICAgIGlmICh0dChuKSAmJiAoZSA9IEkoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICBIID8gRi5lbWl0KCJ1bmhhbmRsZWRSZWplY3Rpb24iLCBpLCB0KSA6IFkoInVuaGFuZGxlZHJlamVjdGlvbiIsIHQsIGkpCiAgICAgICAgICAgICAgICAgICAgfSkpLCBuLnJlamVjdGlvbiA9IEggfHwgdHQobikgPyAyIDogMSwgZS5lcnJvcikpIHRocm93IGUudmFsdWUKICAgICAgICAgICAgfSkpCiAgICAgICAgfSwKICAgICAgICB0dCA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgcmV0dXJuIDEgIT09IHQucmVqZWN0aW9uICYmICF0LnBhcmVudAogICAgICAgIH0sCiAgICAgICAgbnQgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgICAgIEUuY2FsbChjLCAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICBIID8gRi5lbWl0KCJyZWplY3Rpb25IYW5kbGVkIiwgdCkgOiBZKCJyZWplY3Rpb25oYW5kbGVkIiwgdCwgbi52YWx1ZSkKICAgICAgICAgICAgfSkpCiAgICAgICAgfSwKICAgICAgICBldCA9IGZ1bmN0aW9uKHQsIG4sIGUsIGkpIHsKICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHIpIHsKICAgICAgICAgICAgICAgIHQobiwgZSwgciwgaSkKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgaXQgPSBmdW5jdGlvbih0LCBuLCBlLCBpKSB7CiAgICAgICAgICAgIG4uZG9uZSB8fCAobi5kb25lID0gITAsIGkgJiYgKG4gPSBpKSwgbi52YWx1ZSA9IGUsIG4uc3RhdGUgPSAyLCBKKHQsIG4sICEwKSkKICAgICAgICB9LAogICAgICAgIHJ0ID0gZnVuY3Rpb24odCwgbiwgZSwgaSkgewogICAgICAgICAgICBpZiAoIW4uZG9uZSkgewogICAgICAgICAgICAgICAgbi5kb25lID0gITAsIGkgJiYgKG4gPSBpKTsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHQgPT09IGUpIHRocm93IEcoIlByb21pc2UgY2FuJ3QgYmUgcmVzb2x2ZWQgaXRzZWxmIik7CiAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBLKGUpOwogICAgICAgICAgICAgICAgICAgIHIgPyB4KChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lOiAhMQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgci5jYWxsKGUsIGV0KHJ0LCB0LCBpLCBuKSwgZXQoaXQsIHQsIGksIG4pKQogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdCh0LCBpLCBlLCBuKQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkpIDogKG4udmFsdWUgPSBlLCBuLnN0YXRlID0gMSwgSih0LCBuLCAhMSkpCiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgICAgaXQodCwgewogICAgICAgICAgICAgICAgICAgICAgICBkb25lOiAhMQogICAgICAgICAgICAgICAgICAgIH0sIGUsIG4pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgViAmJiAoWiA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICB3KHRoaXMsIFosIE8pLCBoKHQpLCBpLmNhbGwodGhpcyk7CiAgICAgICAgdmFyIG4gPSBqKHRoaXMpOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHQoZXQocnQsIHRoaXMsIG4pLCBldChpdCwgdGhpcywgbikpCiAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICBpdCh0aGlzLCBuLCB0KQogICAgICAgIH0KICAgIH0sIChpID0gZnVuY3Rpb24odCkgewogICAgICAgIFIodGhpcywgewogICAgICAgICAgICB0eXBlOiBPLAogICAgICAgICAgICBkb25lOiAhMSwKICAgICAgICAgICAgbm90aWZpZWQ6ICExLAogICAgICAgICAgICBwYXJlbnQ6ICExLAogICAgICAgICAgICByZWFjdGlvbnM6IFtdLAogICAgICAgICAgICByZWplY3Rpb246ICExLAogICAgICAgICAgICBzdGF0ZTogMCwKICAgICAgICAgICAgdmFsdWU6IHZvaWQgMAogICAgICAgIH0pCiAgICB9KS5wcm90b3R5cGUgPSBtKFoucHJvdG90eXBlLCB7CiAgICAgICAgdGhlbjogZnVuY3Rpb24odCwgbikgewogICAgICAgICAgICB2YXIgZSA9IE0odGhpcyksCiAgICAgICAgICAgICAgICBpID0gVShTKHRoaXMsIFopKTsKICAgICAgICAgICAgcmV0dXJuIGkub2sgPSAiZnVuY3Rpb24iICE9IHR5cGVvZiB0IHx8IHQsIGkuZmFpbCA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIG4gJiYgbiwgaS5kb21haW4gPSBIID8gRi5kb21haW4gOiB2b2lkIDAsIGUucGFyZW50ID0gITAsIGUucmVhY3Rpb25zLnB1c2goaSksIDAgIT0gZS5zdGF0ZSAmJiBKKHRoaXMsIGUsICExKSwgaS5wcm9taXNlCiAgICAgICAgfSwKICAgICAgICBjYXRjaDogZnVuY3Rpb24odCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy50aGVuKHZvaWQgMCwgdCkKICAgICAgICB9CiAgICB9KSwgciA9IGZ1bmN0aW9uKCkgewogICAgICAgIHZhciB0ID0gbmV3IGksCiAgICAgICAgICAgIG4gPSBqKHQpOwogICAgICAgIHRoaXMucHJvbWlzZSA9IHQsIHRoaXMucmVzb2x2ZSA9IGV0KHJ0LCB0LCBuKSwgdGhpcy5yZWplY3QgPSBldChpdCwgdCwgbikKICAgIH0sIEMuZiA9IFUgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgcmV0dXJuIHQgPT09IFogfHwgdCA9PT0gbyA/IG5ldyByKHQpIDogUSh0KQogICAgfSwgZCB8fCAiZnVuY3Rpb24iICE9IHR5cGVvZiBsIHx8IChhID0gbC5wcm90b3R5cGUudGhlbiwgQShsLnByb3RvdHlwZSwgInRoZW4iLCAoZnVuY3Rpb24odCwgbikgewogICAgICAgIHZhciBlID0gdGhpczsKICAgICAgICByZXR1cm4gbmV3IFooKGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgYS5jYWxsKGUsIHQsIG4pCiAgICAgICAgfSkpLnRoZW4odCwgbikKICAgIH0pLCB7CiAgICAgICAgdW5zYWZlOiAhMAogICAgfSksICJmdW5jdGlvbiIgPT0gdHlwZW9mIFggJiYgcyh7CiAgICAgICAgZ2xvYmFsOiAhMCwKICAgICAgICBlbnVtZXJhYmxlOiAhMCwKICAgICAgICBmb3JjZWQ6ICEwCiAgICB9LCB7CiAgICAgICAgZmV0Y2g6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgcmV0dXJuIFQoWiwgWC5hcHBseShjLCBhcmd1bWVudHMpKQogICAgICAgIH0KICAgIH0pKSksIHMoewogICAgICAgIGdsb2JhbDogITAsCiAgICAgICAgd3JhcDogITAsCiAgICAgICAgZm9yY2VkOiBWCiAgICB9LCB7CiAgICAgICAgUHJvbWlzZTogWgogICAgfSksIGYoWiwgTywgITEsICEwKSwgcChPKSwgbyA9IHUoTyksIHMoewogICAgICAgIHRhcmdldDogTywKICAgICAgICBzdGF0OiAhMCwKICAgICAgICBmb3JjZWQ6IFYKICAgIH0sIHsKICAgICAgICByZWplY3Q6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgdmFyIG4gPSBVKHRoaXMpOwogICAgICAgICAgICByZXR1cm4gbi5yZWplY3QuY2FsbCh2b2lkIDAsIHQpLCBuLnByb21pc2UKICAgICAgICB9CiAgICB9KSwgcyh7CiAgICAgICAgdGFyZ2V0OiBPLAogICAgICAgIHN0YXQ6ICEwLAogICAgICAgIGZvcmNlZDogZCB8fCBWCiAgICB9LCB7CiAgICAgICAgcmVzb2x2ZTogZnVuY3Rpb24odCkgewogICAgICAgICAgICByZXR1cm4gVChkICYmIHRoaXMgPT09IG8gPyBaIDogdGhpcywgdCkKICAgICAgICB9CiAgICB9KSwgcyh7CiAgICAgICAgdGFyZ2V0OiBPLAogICAgICAgIHN0YXQ6ICEwLAogICAgICAgIGZvcmNlZDogcQogICAgfSwgewogICAgICAgIGFsbDogZnVuY3Rpb24odCkgewogICAgICAgICAgICB2YXIgbiA9IHRoaXMsCiAgICAgICAgICAgICAgICBlID0gVShuKSwKICAgICAgICAgICAgICAgIGkgPSBlLnJlc29sdmUsCiAgICAgICAgICAgICAgICByID0gZS5yZWplY3QsCiAgICAgICAgICAgICAgICBvID0gSSgoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBoKG4ucmVzb2x2ZSksCiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBbXSwKICAgICAgICAgICAgICAgICAgICAgICAgYSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIHMgPSAxOwogICAgICAgICAgICAgICAgICAgIGIodCwgKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBhKyssCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gITE7CiAgICAgICAgICAgICAgICAgICAgICAgIG8ucHVzaCh2b2lkIDApLCBzKyssIGUuY2FsbChuLCB0KS50aGVuKChmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjIHx8IChjID0gITAsIG9bZF0gPSB0LCAtLXMgfHwgaShvKSkKICAgICAgICAgICAgICAgICAgICAgICAgfSksIHIpCiAgICAgICAgICAgICAgICAgICAgfSkpLCAtLXMgfHwgaShvKQogICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICByZXR1cm4gby5lcnJvciAmJiByKG8udmFsdWUpLCBlLnByb21pc2UKICAgICAgICB9LAogICAgICAgIHJhY2U6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgdmFyIG4gPSB0aGlzLAogICAgICAgICAgICAgICAgZSA9IFUobiksCiAgICAgICAgICAgICAgICBpID0gZS5yZWplY3QsCiAgICAgICAgICAgICAgICByID0gSSgoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBoKG4ucmVzb2x2ZSk7CiAgICAgICAgICAgICAgICAgICAgYih0LCAoZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICByLmNhbGwobiwgdCkudGhlbihlLnJlc29sdmUsIGkpCiAgICAgICAgICAgICAgICAgICAgfSkpCiAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIHJldHVybiByLmVycm9yICYmIGkoci52YWx1ZSksIGUucHJvbWlzZQogICAgICAgIH0KICAgIH0pCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSgxMik7CiAgICB0LmV4cG9ydHMgPSBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICAgICAgZm9yICh2YXIgciBpbiBuKSBpKHQsIHIsIG5bcl0sIGUpOwogICAgICAgIHJldHVybiB0CiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIHZhciBpID0gZSgxMCksCiAgICAgICAgciA9IGUoOSksCiAgICAgICAgbyA9IGUoMSksCiAgICAgICAgYSA9IGUoNiksCiAgICAgICAgcyA9IG8oInNwZWNpZXMiKTsKICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICB2YXIgbiA9IGkodCksCiAgICAgICAgICAgIGUgPSByLmY7CiAgICAgICAgYSAmJiBuICYmICFuW3NdICYmIGUobiwgcywgewogICAgICAgICAgICBjb25maWd1cmFibGU6ICEwLAogICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMKICAgICAgICAgICAgfQogICAgICAgIH0pCiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4pIHsKICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgICAgICBpZiAoISh0IGluc3RhbmNlb2YgbikpIHRocm93IFR5cGVFcnJvcigiSW5jb3JyZWN0ICIgKyAoZSA/IGUgKyAiICIgOiAiIikgKyAiaW52b2NhdGlvbiIpOwogICAgICAgIHJldHVybiB0CiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSgxKSwKICAgICAgICByID0gZSgxNyksCiAgICAgICAgbyA9IGkoIml0ZXJhdG9yIiksCiAgICAgICAgYSA9IEFycmF5LnByb3RvdHlwZTsKICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICByZXR1cm4gdm9pZCAwICE9PSB0ICYmIChyLkFycmF5ID09PSB0IHx8IGFbb10gPT09IHQpCiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSg1MiksCiAgICAgICAgciA9IGUoMTcpLAogICAgICAgIG8gPSBlKDEpKCJpdGVyYXRvciIpOwogICAgdC5leHBvcnRzID0gZnVuY3Rpb24odCkgewogICAgICAgIGlmIChudWxsICE9IHQpIHJldHVybiB0W29dIHx8IHRbIkBAaXRlcmF0b3IiXSB8fCByW2kodCldCiAgICB9Cn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIHZhciBpID0gZSg0KTsKICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uKHQsIG4sIGUsIHIpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICByZXR1cm4gciA/IG4oaShlKVswXSwgZVsxXSkgOiBuKGUpCiAgICAgICAgfSBjYXRjaCAobikgewogICAgICAgICAgICB2YXIgbyA9IHQucmV0dXJuOwogICAgICAgICAgICB0aHJvdyB2b2lkIDAgIT09IG8gJiYgaShvLmNhbGwodCkpLCBuCiAgICAgICAgfQogICAgfQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSA9IGUoMSkoIml0ZXJhdG9yIiksCiAgICAgICAgciA9ICExOwogICAgdHJ5IHsKICAgICAgICB2YXIgbyA9IDAsCiAgICAgICAgICAgIGEgPSB7CiAgICAgICAgICAgICAgICBuZXh0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICBkb25lOiAhIW8rKwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICByZXR1cm46IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHIgPSAhMAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgIGFbaV0gPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMKICAgICAgICB9LCBBcnJheS5mcm9tKGEsIChmdW5jdGlvbigpIHsKICAgICAgICAgICAgdGhyb3cgMgogICAgICAgIH0pKQogICAgfSBjYXRjaCAodCkge30KICAgIHQuZXhwb3J0cyA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICBpZiAoIW4gJiYgIXIpIHJldHVybiAhMTsKICAgICAgICB2YXIgZSA9ICExOwogICAgICAgIHRyeSB7CiAgICAgICAgICAgIHZhciBvID0ge307CiAgICAgICAgICAgIG9baV0gPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgbmV4dDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lOiBlID0gITAKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgdChvKQogICAgICAgIH0gY2F0Y2ggKHQpIHt9CiAgICAgICAgcmV0dXJuIGUKICAgIH0KfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGksIHIsIG8sIGEsIHMsIGQsIGMsIHUsIGwgPSBlKDApLAogICAgICAgIEEgPSBlKDIzKS5mLAogICAgICAgIG0gPSBlKDE0KSwKICAgICAgICBmID0gZSg2MCkuc2V0LAogICAgICAgIHAgPSBlKDYxKSwKICAgICAgICBnID0gbC5NdXRhdGlvbk9ic2VydmVyIHx8IGwuV2ViS2l0TXV0YXRpb25PYnNlcnZlciwKICAgICAgICBoID0gbC5wcm9jZXNzLAogICAgICAgIHcgPSBsLlByb21pc2UsCiAgICAgICAgeSA9ICJwcm9jZXNzIiA9PSBtKGgpLAogICAgICAgIHYgPSBBKGwsICJxdWV1ZU1pY3JvdGFzayIpLAogICAgICAgIGIgPSB2ICYmIHYudmFsdWU7CiAgICBiIHx8IChpID0gZnVuY3Rpb24oKSB7CiAgICAgICAgdmFyIHQsIG47CiAgICAgICAgZm9yICh5ICYmICh0ID0gaC5kb21haW4pICYmIHQuZXhpdCgpOyByOykgewogICAgICAgICAgICBuID0gci5mbiwgciA9IHIubmV4dDsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIG4oKQogICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgICB0aHJvdyByID8gYSgpIDogbyA9IHZvaWQgMCwgdAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIG8gPSB2b2lkIDAsIHQgJiYgdC5lbnRlcigpCiAgICB9LCB5ID8gYSA9IGZ1bmN0aW9uKCkgewogICAgICAgIGgubmV4dFRpY2soaSkKICAgIH0gOiBnICYmICFwID8gKHMgPSAhMCwgZCA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCIiKSwgbmV3IGcoaSkub2JzZXJ2ZShkLCB7CiAgICAgICAgY2hhcmFjdGVyRGF0YTogITAKICAgIH0pLCBhID0gZnVuY3Rpb24oKSB7CiAgICAgICAgZC5kYXRhID0gcyA9ICFzCiAgICB9KSA6IHcgJiYgdy5yZXNvbHZlID8gKGMgPSB3LnJlc29sdmUodm9pZCAwKSwgdSA9IGMudGhlbiwgYSA9IGZ1bmN0aW9uKCkgewogICAgICAgIHUuY2FsbChjLCBpKQogICAgfSkgOiBhID0gZnVuY3Rpb24oKSB7CiAgICAgICAgZi5jYWxsKGwsIGkpCiAgICB9KSwgdC5leHBvcnRzID0gYiB8fCBmdW5jdGlvbih0KSB7CiAgICAgICAgdmFyIG4gPSB7CiAgICAgICAgICAgIGZuOiB0LAogICAgICAgICAgICBuZXh0OiB2b2lkIDAKICAgICAgICB9OwogICAgICAgIG8gJiYgKG8ubmV4dCA9IG4pLCByIHx8IChyID0gbiwgYSgpKSwgbyA9IG4KICAgIH0KfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgdmFyIGkgPSBlKDApOwogICAgdC5leHBvcnRzID0gZnVuY3Rpb24odCwgbikgewogICAgICAgIHZhciBlID0gaS5jb25zb2xlOwogICAgICAgIGUgJiYgZS5lcnJvciAmJiAoMSA9PT0gYXJndW1lbnRzLmxlbmd0aCA/IGUuZXJyb3IodCkgOiBlLmVycm9yKHQsIG4pKQogICAgfQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICB2YXIgaSwgciwgbyA9IGUoMCksCiAgICAgICAgYSA9IGUoNjIpLAogICAgICAgIHMgPSBvLnByb2Nlc3MsCiAgICAgICAgZCA9IHMgJiYgcy52ZXJzaW9ucywKICAgICAgICBjID0gZCAmJiBkLnY4OwogICAgYyA/IHIgPSAoaSA9IGMuc3BsaXQoIi4iKSlbMF0gKyBpWzFdIDogYSAmJiAoIShpID0gYS5tYXRjaCgvRWRnZVwvKFxkKykvKSkgfHwgaVsxXSA+PSA3NCkgJiYgKGkgPSBhLm1hdGNoKC9DaHJvbWVcLyhcZCspLykpICYmIChyID0gaVsxXSksIHQuZXhwb3J0cyA9IHIgJiYgK3IKfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgInVzZSBzdHJpY3QiOwogICAgdmFyIGkgPSBlKDUpLAogICAgICAgIHIgPSBlKDE2KSwKICAgICAgICBvID0gZSg1NyksCiAgICAgICAgYSA9IGUoMiksCiAgICAgICAgcyA9IGUoMTApLAogICAgICAgIGQgPSBlKDU5KSwKICAgICAgICBjID0gZSg2MyksCiAgICAgICAgdSA9IGUoMTIpOwogICAgaSh7CiAgICAgICAgdGFyZ2V0OiAiUHJvbWlzZSIsCiAgICAgICAgcHJvdG86ICEwLAogICAgICAgIHJlYWw6ICEwLAogICAgICAgIGZvcmNlZDogISFvICYmIGEoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICBvLnByb3RvdHlwZS5maW5hbGx5LmNhbGwoewogICAgICAgICAgICAgICAgdGhlbjogZnVuY3Rpb24oKSB7fQogICAgICAgICAgICB9LCAoZnVuY3Rpb24oKSB7fSkpCiAgICAgICAgfSkpCiAgICB9LCB7CiAgICAgICAgZmluYWxseTogZnVuY3Rpb24odCkgewogICAgICAgICAgICB2YXIgbiA9IGQodGhpcywgcygiUHJvbWlzZSIpKSwKICAgICAgICAgICAgICAgIGUgPSAiZnVuY3Rpb24iID09IHR5cGVvZiB0OwogICAgICAgICAgICByZXR1cm4gdGhpcy50aGVuKGUgPyBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gYyhuLCB0KCkpLnRoZW4oKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBlCiAgICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgfSA6IHQsIGUgPyBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gYyhuLCB0KCkpLnRoZW4oKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHRocm93IGUKICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICB9IDogdCkKICAgICAgICB9CiAgICB9KSwgciB8fCAiZnVuY3Rpb24iICE9IHR5cGVvZiBvIHx8IG8ucHJvdG90eXBlLmZpbmFsbHkgfHwgdShvLnByb3RvdHlwZSwgImZpbmFsbHkiLCBzKCJQcm9taXNlIikucHJvdG90eXBlLmZpbmFsbHkpCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIHZhciBpID0gZSg1KSwKICAgICAgICByID0gZSg2KSwKICAgICAgICBvID0gZSgzNCksCiAgICAgICAgYSA9IGUoNTYpLAogICAgICAgIHMgPSBlKDM1KSwKICAgICAgICBkID0gZSg5KSwKICAgICAgICBjID0gZSgxOSksCiAgICAgICAgdSA9IGUoMjEpLAogICAgICAgIGwgPSBlKDcpLAogICAgICAgIEEgPSBlKDE1KSwKICAgICAgICBtID0gQS5zZXQsCiAgICAgICAgZiA9IEEuZ2V0dGVyRm9yKCJBZ2dyZWdhdGVFcnJvciIpLAogICAgICAgIHAgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgICAgIHZhciBlID0gdGhpczsKICAgICAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIHApKSByZXR1cm4gbmV3IHAodCwgbik7CiAgICAgICAgICAgIGEgJiYgKGUgPSBhKG5ldyBFcnJvcihuKSwgbyhlKSkpOwogICAgICAgICAgICB2YXIgaSA9IFtdOwogICAgICAgICAgICByZXR1cm4gdSh0LCBpLnB1c2gsIGkpLCByID8gbShlLCB7CiAgICAgICAgICAgICAgICBlcnJvcnM6IGksCiAgICAgICAgICAgICAgICB0eXBlOiAiQWdncmVnYXRlRXJyb3IiCiAgICAgICAgICAgIH0pIDogZS5lcnJvcnMgPSBpLCB2b2lkIDAgIT09IG4gJiYgbChlLCAibWVzc2FnZSIsIFN0cmluZyhuKSksIGUKICAgICAgICB9OwogICAgcC5wcm90b3R5cGUgPSBzKEVycm9yLnByb3RvdHlwZSwgewogICAgICAgIGNvbnN0cnVjdG9yOiBjKDUsIHApLAogICAgICAgIG1lc3NhZ2U6IGMoNSwgIiIpLAogICAgICAgIG5hbWU6IGMoNSwgIkFnZ3JlZ2F0ZUVycm9yIikKICAgIH0pLCByICYmIGQuZihwLnByb3RvdHlwZSwgImVycm9ycyIsIHsKICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gZih0aGlzKS5lcnJvcnMKICAgICAgICB9LAogICAgICAgIGNvbmZpZ3VyYWJsZTogITAKICAgIH0pLCBpKHsKICAgICAgICBnbG9iYWw6ICEwCiAgICB9LCB7CiAgICAgICAgQWdncmVnYXRlRXJyb3I6IHAKICAgIH0pCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgIGUoNjQpCn0sIGZ1bmN0aW9uKHQsIG4sIGUpIHsKICAgICJ1c2Ugc3RyaWN0IjsKICAgIHZhciBpID0gZSg1KSwKICAgICAgICByID0gZSgxOCksCiAgICAgICAgbyA9IGUoMjIpOwogICAgaSh7CiAgICAgICAgdGFyZ2V0OiAiUHJvbWlzZSIsCiAgICAgICAgc3RhdDogITAKICAgIH0sIHsKICAgICAgICB0cnk6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgdmFyIG4gPSByLmYodGhpcyksCiAgICAgICAgICAgICAgICBlID0gbyh0KTsKICAgICAgICAgICAgcmV0dXJuIChlLmVycm9yID8gbi5yZWplY3QgOiBuLnJlc29sdmUpKGUudmFsdWUpLCBuLnByb21pc2UKICAgICAgICB9CiAgICB9KQp9LCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICAidXNlIHN0cmljdCI7CiAgICB2YXIgaSA9IGUoNSksCiAgICAgICAgciA9IGUoMTMpLAogICAgICAgIG8gPSBlKDEwKSwKICAgICAgICBhID0gZSgxOCksCiAgICAgICAgcyA9IGUoMjIpLAogICAgICAgIGQgPSBlKDIxKTsKICAgIGkoewogICAgICAgIHRhcmdldDogIlByb21pc2UiLAogICAgICAgIHN0YXQ6ICEwCiAgICB9LCB7CiAgICAgICAgYW55OiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgIHZhciBuID0gdGhpcywKICAgICAgICAgICAgICAgIGUgPSBhLmYobiksCiAgICAgICAgICAgICAgICBpID0gZS5yZXNvbHZlLAogICAgICAgICAgICAgICAgYyA9IGUucmVqZWN0LAogICAgICAgICAgICAgICAgdSA9IHMoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBlID0gcihuLnJlc29sdmUpLAogICAgICAgICAgICAgICAgICAgICAgICBhID0gW10sCiAgICAgICAgICAgICAgICAgICAgICAgIHMgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICB1ID0gMSwKICAgICAgICAgICAgICAgICAgICAgICAgbCA9ICExOwogICAgICAgICAgICAgICAgICAgIGQodCwgKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBzKyssCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkID0gITE7CiAgICAgICAgICAgICAgICAgICAgICAgIGEucHVzaCh2b2lkIDApLCB1KyssIGUuY2FsbChuLCB0KS50aGVuKChmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkIHx8IGwgfHwgKGwgPSAhMCwgaSh0KSkKICAgICAgICAgICAgICAgICAgICAgICAgfSksIChmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkIHx8IGwgfHwgKGQgPSAhMCwgYVtyXSA9IHQsIC0tdSB8fCBjKG5ldyhvKCJBZ2dyZWdhdGVFcnJvciIpKShhLCAiTm8gb25lIHByb21pc2UgcmVzb2x2ZWQiKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICAgICAgICAgIH0pKSwgLS11IHx8IGMobmV3KG8oIkFnZ3JlZ2F0ZUVycm9yIikpKGEsICJObyBvbmUgcHJvbWlzZSByZXNvbHZlZCIpKQogICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICByZXR1cm4gdS5lcnJvciAmJiBjKHUudmFsdWUpLCBlLnByb21pc2UKICAgICAgICB9CiAgICB9KQp9LCBmdW5jdGlvbih0LCBuKSB7CiAgICAhIGZ1bmN0aW9uKHQpIHsKICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgaWYgKCF0LmZldGNoKSB7CiAgICAgICAgICAgIHZhciBuID0gIlVSTFNlYXJjaFBhcmFtcyIgaW4gdCwKICAgICAgICAgICAgICAgIGUgPSAiU3ltYm9sIiBpbiB0ICYmICJpdGVyYXRvciIgaW4gU3ltYm9sLAogICAgICAgICAgICAgICAgaSA9ICJGaWxlUmVhZGVyIiBpbiB0ICYmICJCbG9iIiBpbiB0ICYmIGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQmxvYiwgITAKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhMQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0oKSwKICAgICAgICAgICAgICAgIHIgPSAiRm9ybURhdGEiIGluIHQsCiAgICAgICAgICAgICAgICBvID0gIkFycmF5QnVmZmVyIiBpbiB0OwogICAgICAgICAgICBpZiAobykgdmFyIGEgPSBbIltvYmplY3QgSW50OEFycmF5XSIsICJbb2JqZWN0IFVpbnQ4QXJyYXldIiwgIltvYmplY3QgVWludDhDbGFtcGVkQXJyYXldIiwgIltvYmplY3QgSW50MTZBcnJheV0iLCAiW29iamVjdCBVaW50MTZBcnJheV0iLCAiW29iamVjdCBJbnQzMkFycmF5XSIsICJbb2JqZWN0IFVpbnQzMkFycmF5XSIsICJbb2JqZWN0IEZsb2F0MzJBcnJheV0iLCAiW29iamVjdCBGbG9hdDY0QXJyYXldIl0sCiAgICAgICAgICAgICAgICBzID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0ICYmIERhdGFWaWV3LnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKHQpCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZCA9IEFycmF5QnVmZmVyLmlzVmlldyB8fCBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQgJiYgYS5pbmRleE9mKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KSkgPiAtMQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgZi5wcm90b3R5cGUuYXBwZW5kID0gZnVuY3Rpb24odCwgbikgewogICAgICAgICAgICAgICAgdCA9IGwodCksIG4gPSBBKG4pOwogICAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLm1hcFt0XTsKICAgICAgICAgICAgICAgIHRoaXMubWFwW3RdID0gZSA/IGUgKyAiLCIgKyBuIDogbgogICAgICAgICAgICB9LCBmLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5tYXBbbCh0KV0KICAgICAgICAgICAgfSwgZi5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHQgPSBsKHQpLCB0aGlzLmhhcyh0KSA/IHRoaXMubWFwW3RdIDogbnVsbAogICAgICAgICAgICB9LCBmLnByb3RvdHlwZS5oYXMgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5tYXAuaGFzT3duUHJvcGVydHkobCh0KSkKICAgICAgICAgICAgfSwgZi5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24odCwgbikgewogICAgICAgICAgICAgICAgdGhpcy5tYXBbbCh0KV0gPSBBKG4pCiAgICAgICAgICAgIH0sIGYucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBlIGluIHRoaXMubWFwKSB0aGlzLm1hcC5oYXNPd25Qcm9wZXJ0eShlKSAmJiB0LmNhbGwobiwgdGhpcy5tYXBbZV0sIGUsIHRoaXMpCiAgICAgICAgICAgIH0sIGYucHJvdG90eXBlLmtleXMgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHZhciB0ID0gW107CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKChmdW5jdGlvbihuLCBlKSB7CiAgICAgICAgICAgICAgICAgICAgdC5wdXNoKGUpCiAgICAgICAgICAgICAgICB9KSksIG0odCkKICAgICAgICAgICAgfSwgZi5wcm90b3R5cGUudmFsdWVzID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIgdCA9IFtdOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaCgoZnVuY3Rpb24obikgewogICAgICAgICAgICAgICAgICAgIHQucHVzaChuKQogICAgICAgICAgICAgICAgfSkpLCBtKHQpCiAgICAgICAgICAgIH0sIGYucHJvdG90eXBlLmVudHJpZXMgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHZhciB0ID0gW107CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKChmdW5jdGlvbihuLCBlKSB7CiAgICAgICAgICAgICAgICAgICAgdC5wdXNoKFtlLCBuXSkKICAgICAgICAgICAgICAgIH0pKSwgbSh0KQogICAgICAgICAgICB9LCBlICYmIChmLnByb3RvdHlwZVtTeW1ib2wuaXRlcmF0b3JdID0gZi5wcm90b3R5cGUuZW50cmllcyk7CiAgICAgICAgICAgIHZhciBjID0gWyJERUxFVEUiLCAiR0VUIiwgIkhFQUQiLCAiT1BUSU9OUyIsICJQT1NUIiwgIlBVVCJdOwogICAgICAgICAgICB2LnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyB2KHRoaXMsIHsKICAgICAgICAgICAgICAgICAgICBib2R5OiB0aGlzLl9ib2R5SW5pdAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSwgeS5jYWxsKHYucHJvdG90eXBlKSwgeS5jYWxsKGsucHJvdG90eXBlKSwgay5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgayh0aGlzLl9ib2R5SW5pdCwgewogICAgICAgICAgICAgICAgICAgIHN0YXR1czogdGhpcy5zdGF0dXMsCiAgICAgICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogdGhpcy5zdGF0dXNUZXh0LAogICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IG5ldyBmKHRoaXMuaGVhZGVycyksCiAgICAgICAgICAgICAgICAgICAgdXJsOiB0aGlzLnVybAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSwgay5lcnJvciA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFyIHQgPSBuZXcgayhudWxsLCB7CiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiAwLAogICAgICAgICAgICAgICAgICAgIHN0YXR1c1RleHQ6ICIiCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybiB0LnR5cGUgPSAiZXJyb3IiLCB0CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHZhciB1ID0gWzMwMSwgMzAyLCAzMDMsIDMwNywgMzA4XTsKICAgICAgICAgICAgay5yZWRpcmVjdCA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgICAgIGlmICgtMSA9PT0gdS5pbmRleE9mKG4pKSB0aHJvdyBuZXcgUmFuZ2VFcnJvcigiSW52YWxpZCBzdGF0dXMgY29kZSIpOwogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBrKG51bGwsIHsKICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IG4sCiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbjogdAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0sIHQuSGVhZGVycyA9IGYsIHQuUmVxdWVzdCA9IHYsIHQuUmVzcG9uc2UgPSBrLCB0LmZldGNoID0gZnVuY3Rpb24odCwgbikgewogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihlLCByKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSBuZXcgdih0LCBuKSwKICAgICAgICAgICAgICAgICAgICAgICAgYSA9IG5ldyBYTUxIdHRwUmVxdWVzdDsKICAgICAgICAgICAgICAgICAgICBhLm9ubG9hZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdCwgbiwgaSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogYS5zdGF0dXMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXNUZXh0OiBhLnN0YXR1c1RleHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiAodCA9IGEuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkgfHwgIiIsIG4gPSBuZXcgZiwgdC5yZXBsYWNlKC9ccj9cbltcdCBdKy9nLCAiICIpLnNwbGl0KC9ccj9cbi8pLmZvckVhY2goKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHQuc3BsaXQoIjoiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSA9IGUuc2hpZnQoKS50cmltKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBlLmpvaW4oIjoiKS50cmltKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uYXBwZW5kKGksIHIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpLCBuKQogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICBpLnVybCA9ICJyZXNwb25zZVVSTCIgaW4gYSA/IGEucmVzcG9uc2VVUkwgOiBpLmhlYWRlcnMuZ2V0KCJYLVJlcXVlc3QtVVJMIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByID0gInJlc3BvbnNlIiBpbiBhID8gYS5yZXNwb25zZSA6IGEucmVzcG9uc2VUZXh0OwogICAgICAgICAgICAgICAgICAgICAgICBlKG5ldyBrKHIsIGkpKQogICAgICAgICAgICAgICAgICAgIH0sIGEub25lcnJvciA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICByKG5ldyBUeXBlRXJyb3IoIk5ldHdvcmsgcmVxdWVzdCBmYWlsZWQiKSkKICAgICAgICAgICAgICAgICAgICB9LCBhLm9udGltZW91dCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICByKG5ldyBUeXBlRXJyb3IoIk5ldHdvcmsgcmVxdWVzdCBmYWlsZWQiKSkKICAgICAgICAgICAgICAgICAgICB9LCBhLm9wZW4oby5tZXRob2QsIG8udXJsLCAhMCksICJpbmNsdWRlIiA9PT0gby5jcmVkZW50aWFscyA/IGEud2l0aENyZWRlbnRpYWxzID0gITAgOiAib21pdCIgPT09IG8uY3JlZGVudGlhbHMgJiYgKGEud2l0aENyZWRlbnRpYWxzID0gITEpLCAicmVzcG9uc2VUeXBlIiBpbiBhICYmIGkgJiYgKGEucmVzcG9uc2VUeXBlID0gImJsb2IiKSwgby5oZWFkZXJzLmZvckVhY2goKGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgYS5zZXRSZXF1ZXN0SGVhZGVyKG4sIHQpCiAgICAgICAgICAgICAgICAgICAgfSkpLCBhLnNlbmQodm9pZCAwID09PSBvLl9ib2R5SW5pdCA/IG51bGwgOiBvLl9ib2R5SW5pdCkKICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICB9LCB0LmZldGNoLnBvbHlmaWxsID0gITAKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGwodCkgewogICAgICAgICAgICBpZiAoInN0cmluZyIgIT0gdHlwZW9mIHQgJiYgKHQgPSBTdHJpbmcodCkpLCAvW15hLXowLTlcLSMkJSYnKisuXF5fYHx+XS9pLnRlc3QodCkpIHRocm93IG5ldyBUeXBlRXJyb3IoIkludmFsaWQgY2hhcmFjdGVyIGluIGhlYWRlciBmaWVsZCBuYW1lIik7CiAgICAgICAgICAgIHJldHVybiB0LnRvTG93ZXJDYXNlKCkKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIEEodCkgewogICAgICAgICAgICByZXR1cm4gInN0cmluZyIgIT0gdHlwZW9mIHQgJiYgKHQgPSBTdHJpbmcodCkpLCB0CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBtKHQpIHsKICAgICAgICAgICAgdmFyIG4gPSB7CiAgICAgICAgICAgICAgICBuZXh0OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IHQuc2hpZnQoKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICBkb25lOiB2b2lkIDAgPT09IG4sCiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBuCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICByZXR1cm4gZSAmJiAobltTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbgogICAgICAgICAgICB9KSwgbgogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gZih0KSB7CiAgICAgICAgICAgIHRoaXMubWFwID0ge30sIHQgaW5zdGFuY2VvZiBmID8gdC5mb3JFYWNoKChmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgICAgICAgICB0aGlzLmFwcGVuZChuLCB0KQogICAgICAgICAgICB9KSwgdGhpcykgOiBBcnJheS5pc0FycmF5KHQpID8gdC5mb3JFYWNoKChmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICB0aGlzLmFwcGVuZCh0WzBdLCB0WzFdKQogICAgICAgICAgICB9KSwgdGhpcykgOiB0ICYmIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHQpLmZvckVhY2goKGZ1bmN0aW9uKG4pIHsKICAgICAgICAgICAgICAgIHRoaXMuYXBwZW5kKG4sIHRbbl0pCiAgICAgICAgICAgIH0pLCB0aGlzKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gcCh0KSB7CiAgICAgICAgICAgIGlmICh0LmJvZHlVc2VkKSByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFR5cGVFcnJvcigiQWxyZWFkeSByZWFkIikpOwogICAgICAgICAgICB0LmJvZHlVc2VkID0gITAKICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGcodCkgewogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKG4sIGUpIHsKICAgICAgICAgICAgICAgIHQub25sb2FkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgbih0LnJlc3VsdCkKICAgICAgICAgICAgICAgIH0sIHQub25lcnJvciA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIGUodC5lcnJvcikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkpCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBoKHQpIHsKICAgICAgICAgICAgdmFyIG4gPSBuZXcgRmlsZVJlYWRlciwKICAgICAgICAgICAgICAgIGUgPSBnKG4pOwogICAgICAgICAgICByZXR1cm4gbi5yZWFkQXNBcnJheUJ1ZmZlcih0KSwgZQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gdyh0KSB7CiAgICAgICAgICAgIGlmICh0LnNsaWNlKSByZXR1cm4gdC5zbGljZSgwKTsKICAgICAgICAgICAgdmFyIG4gPSBuZXcgVWludDhBcnJheSh0LmJ5dGVMZW5ndGgpOwogICAgICAgICAgICByZXR1cm4gbi5zZXQobmV3IFVpbnQ4QXJyYXkodCkpLCBuLmJ1ZmZlcgogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24geSgpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm9keVVzZWQgPSAhMSwgdGhpcy5faW5pdEJvZHkgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYm9keUluaXQgPSB0LCB0KQogICAgICAgICAgICAgICAgICAgIGlmICgic3RyaW5nIiA9PSB0eXBlb2YgdCkgdGhpcy5fYm9keVRleHQgPSB0OwogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGkgJiYgQmxvYi5wcm90b3R5cGUuaXNQcm90b3R5cGVPZih0KSkgdGhpcy5fYm9keUJsb2IgPSB0OwogICAgICAgICAgICAgICAgZWxzZSBpZiAociAmJiBGb3JtRGF0YS5wcm90b3R5cGUuaXNQcm90b3R5cGVPZih0KSkgdGhpcy5fYm9keUZvcm1EYXRhID0gdDsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKG4gJiYgVVJMU2VhcmNoUGFyYW1zLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKHQpKSB0aGlzLl9ib2R5VGV4dCA9IHQudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIGVsc2UgaWYgKG8gJiYgaSAmJiBzKHQpKSB0aGlzLl9ib2R5QXJyYXlCdWZmZXIgPSB3KHQuYnVmZmVyKSwgdGhpcy5fYm9keUluaXQgPSBuZXcgQmxvYihbdGhpcy5fYm9keUFycmF5QnVmZmVyXSk7CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIW8gfHwgIUFycmF5QnVmZmVyLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKHQpICYmICFkKHQpKSB0aHJvdyBuZXcgRXJyb3IoInVuc3VwcG9ydGVkIEJvZHlJbml0IHR5cGUiKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLl9ib2R5QXJyYXlCdWZmZXIgPSB3KHQpCiAgICAgICAgICAgICAgICB9IGVsc2UgdGhpcy5fYm9keVRleHQgPSAiIjsKICAgICAgICAgICAgICAgIHRoaXMuaGVhZGVycy5nZXQoImNvbnRlbnQtdHlwZSIpIHx8ICgic3RyaW5nIiA9PSB0eXBlb2YgdCA/IHRoaXMuaGVhZGVycy5zZXQoImNvbnRlbnQtdHlwZSIsICJ0ZXh0L3BsYWluO2NoYXJzZXQ9VVRGLTgiKSA6IHRoaXMuX2JvZHlCbG9iICYmIHRoaXMuX2JvZHlCbG9iLnR5cGUgPyB0aGlzLmhlYWRlcnMuc2V0KCJjb250ZW50LXR5cGUiLCB0aGlzLl9ib2R5QmxvYi50eXBlKSA6IG4gJiYgVVJMU2VhcmNoUGFyYW1zLnByb3RvdHlwZS5pc1Byb3RvdHlwZU9mKHQpICYmIHRoaXMuaGVhZGVycy5zZXQoImNvbnRlbnQtdHlwZSIsICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD1VVEYtOCIpKQogICAgICAgICAgICB9LCBpICYmICh0aGlzLmJsb2IgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHZhciB0ID0gcCh0aGlzKTsKICAgICAgICAgICAgICAgIGlmICh0KSByZXR1cm4gdDsKICAgICAgICAgICAgICAgIGlmICh0aGlzLl9ib2R5QmxvYikgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLl9ib2R5QmxvYik7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYm9keUFycmF5QnVmZmVyKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG5ldyBCbG9iKFt0aGlzLl9ib2R5QXJyYXlCdWZmZXJdKSk7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYm9keUZvcm1EYXRhKSB0aHJvdyBuZXcgRXJyb3IoImNvdWxkIG5vdCByZWFkIEZvcm1EYXRhIGJvZHkgYXMgYmxvYiIpOwogICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXcgQmxvYihbdGhpcy5fYm9keVRleHRdKSkKICAgICAgICAgICAgfSwgdGhpcy5hcnJheUJ1ZmZlciA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2JvZHlBcnJheUJ1ZmZlciA/IHAodGhpcykgfHwgUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikgOiB0aGlzLmJsb2IoKS50aGVuKGgpCiAgICAgICAgICAgIH0pLCB0aGlzLnRleHQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHZhciB0LCBuLCBlLCBpID0gcCh0aGlzKTsKICAgICAgICAgICAgICAgIGlmIChpKSByZXR1cm4gaTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLl9ib2R5QmxvYikgcmV0dXJuIHQgPSB0aGlzLl9ib2R5QmxvYiwgbiA9IG5ldyBGaWxlUmVhZGVyLCBlID0gZyhuKSwgbi5yZWFkQXNUZXh0KHQpLCBlOwogICAgICAgICAgICAgICAgaWYgKHRoaXMuX2JvZHlBcnJheUJ1ZmZlcikgcmV0dXJuIFByb21pc2UucmVzb2x2ZShmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbiA9IG5ldyBVaW50OEFycmF5KHQpLCBlID0gbmV3IEFycmF5KG4ubGVuZ3RoKSwgaSA9IDA7IGkgPCBuLmxlbmd0aDsgaSsrKSBlW2ldID0gU3RyaW5nLmZyb21DaGFyQ29kZShuW2ldKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZS5qb2luKCIiKQogICAgICAgICAgICAgICAgfSh0aGlzLl9ib2R5QXJyYXlCdWZmZXIpKTsKICAgICAgICAgICAgICAgIGlmICh0aGlzLl9ib2R5Rm9ybURhdGEpIHRocm93IG5ldyBFcnJvcigiY291bGQgbm90IHJlYWQgRm9ybURhdGEgYm9keSBhcyB0ZXh0Iik7CiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlUZXh0KQogICAgICAgICAgICB9LCByICYmICh0aGlzLmZvcm1EYXRhID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0KCkudGhlbihiKQogICAgICAgICAgICB9KSwgdGhpcy5qc29uID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy50ZXh0KCkudGhlbihKU09OLnBhcnNlKQogICAgICAgICAgICB9LCB0aGlzCiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB2KHQsIG4pIHsKICAgICAgICAgICAgdmFyIGUsIGksIHIgPSAobiA9IG4gfHwge30pLmJvZHk7CiAgICAgICAgICAgIGlmICh0IGluc3RhbmNlb2YgdikgewogICAgICAgICAgICAgICAgaWYgKHQuYm9keVVzZWQpIHRocm93IG5ldyBUeXBlRXJyb3IoIkFscmVhZHkgcmVhZCIpOwogICAgICAgICAgICAgICAgdGhpcy51cmwgPSB0LnVybCwgdGhpcy5jcmVkZW50aWFscyA9IHQuY3JlZGVudGlhbHMsIG4uaGVhZGVycyB8fCAodGhpcy5oZWFkZXJzID0gbmV3IGYodC5oZWFkZXJzKSksIHRoaXMubWV0aG9kID0gdC5tZXRob2QsIHRoaXMubW9kZSA9IHQubW9kZSwgciB8fCBudWxsID09IHQuX2JvZHlJbml0IHx8IChyID0gdC5fYm9keUluaXQsIHQuYm9keVVzZWQgPSAhMCkKICAgICAgICAgICAgfSBlbHNlIHRoaXMudXJsID0gU3RyaW5nKHQpOwogICAgICAgICAgICBpZiAodGhpcy5jcmVkZW50aWFscyA9IG4uY3JlZGVudGlhbHMgfHwgdGhpcy5jcmVkZW50aWFscyB8fCAib21pdCIsICFuLmhlYWRlcnMgJiYgdGhpcy5oZWFkZXJzIHx8ICh0aGlzLmhlYWRlcnMgPSBuZXcgZihuLmhlYWRlcnMpKSwgdGhpcy5tZXRob2QgPSAoZSA9IG4ubWV0aG9kIHx8IHRoaXMubWV0aG9kIHx8ICJHRVQiLCBpID0gZS50b1VwcGVyQ2FzZSgpLCBjLmluZGV4T2YoaSkgPiAtMSA/IGkgOiBlKSwgdGhpcy5tb2RlID0gbi5tb2RlIHx8IHRoaXMubW9kZSB8fCBudWxsLCB0aGlzLnJlZmVycmVyID0gbnVsbCwgKCJHRVQiID09PSB0aGlzLm1ldGhvZCB8fCAiSEVBRCIgPT09IHRoaXMubWV0aG9kKSAmJiByKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJCb2R5IG5vdCBhbGxvd2VkIGZvciBHRVQgb3IgSEVBRCByZXF1ZXN0cyIpOwogICAgICAgICAgICB0aGlzLl9pbml0Qm9keShyKQogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gYih0KSB7CiAgICAgICAgICAgIHZhciBuID0gbmV3IEZvcm1EYXRhOwogICAgICAgICAgICByZXR1cm4gdC50cmltKCkuc3BsaXQoIiYiKS5mb3JFYWNoKChmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICBpZiAodCkgewogICAgICAgICAgICAgICAgICAgIHZhciBlID0gdC5zcGxpdCgiPSIpLAogICAgICAgICAgICAgICAgICAgICAgICBpID0gZS5zaGlmdCgpLnJlcGxhY2UoL1wrL2csICIgIiksCiAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBlLmpvaW4oIj0iKS5yZXBsYWNlKC9cKy9nLCAiICIpOwogICAgICAgICAgICAgICAgICAgIG4uYXBwZW5kKGRlY29kZVVSSUNvbXBvbmVudChpKSwgZGVjb2RlVVJJQ29tcG9uZW50KHIpKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KSksIG4KICAgICAgICB9CgogICAgICAgIGZ1bmN0aW9uIGsodCwgbikgewogICAgICAgICAgICBuIHx8IChuID0ge30pLCB0aGlzLnR5cGUgPSAiZGVmYXVsdCIsIHRoaXMuc3RhdHVzID0gdm9pZCAwID09PSBuLnN0YXR1cyA/IDIwMCA6IG4uc3RhdHVzLCB0aGlzLm9rID0gdGhpcy5zdGF0dXMgPj0gMjAwICYmIHRoaXMuc3RhdHVzIDwgMzAwLCB0aGlzLnN0YXR1c1RleHQgPSAic3RhdHVzVGV4dCIgaW4gbiA/IG4uc3RhdHVzVGV4dCA6ICJPSyIsIHRoaXMuaGVhZGVycyA9IG5ldyBmKG4uaGVhZGVycyksIHRoaXMudXJsID0gbi51cmwgfHwgIiIsIHRoaXMuX2luaXRCb2R5KHQpCiAgICAgICAgfQogICAgfSgidW5kZWZpbmVkIiAhPSB0eXBlb2Ygc2VsZiA/IHNlbGYgOiB0aGlzKQp9LCBmdW5jdGlvbih0LCBuKSB7CiAgICAvKiEgQHNvdXJjZSBodHRwOi8vcHVybC5lbGlncmV5LmNvbS9naXRodWIvY2xhc3NMaXN0LmpzL2Jsb2IvbWFzdGVyL2NsYXNzTGlzdC5qcyAqLwogICAgImRvY3VtZW50IiBpbiB3aW5kb3cuc2VsZiAmJiAoKCEoImNsYXNzTGlzdCIgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiXyIpKSB8fCBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMgJiYgISgiY2xhc3NMaXN0IiBpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwgImciKSkpICYmIGZ1bmN0aW9uKHQpIHsKICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgaWYgKCJFbGVtZW50IiBpbiB0KSB7CiAgICAgICAgICAgIHZhciBuID0gdC5FbGVtZW50LnByb3RvdHlwZSwKICAgICAgICAgICAgICAgIGUgPSBPYmplY3QsCiAgICAgICAgICAgICAgICBpID0gU3RyaW5nLnByb3RvdHlwZS50cmltIHx8IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlcGxhY2UoL15ccyt8XHMrJC9nLCAiIikKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICByID0gQXJyYXkucHJvdG90eXBlLmluZGV4T2YgfHwgZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIG4gPSAwLCBlID0gdGhpcy5sZW5ndGg7IG4gPCBlOyBuKyspCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuIGluIHRoaXMgJiYgdGhpc1tuXSA9PT0gdCkgcmV0dXJuIG47CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgbyA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLm5hbWUgPSB0LCB0aGlzLmNvZGUgPSBET01FeGNlcHRpb25bdF0sIHRoaXMubWVzc2FnZSA9IG4KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBhID0gZnVuY3Rpb24odCwgbikgewogICAgICAgICAgICAgICAgICAgIGlmICgiIiA9PT0gbikgdGhyb3cgbmV3IG8oIlNZTlRBWF9FUlIiLCAiQW4gaW52YWxpZCBvciBpbGxlZ2FsIHN0cmluZyB3YXMgc3BlY2lmaWVkIik7CiAgICAgICAgICAgICAgICAgICAgaWYgKC9ccy8udGVzdChuKSkgdGhyb3cgbmV3IG8oIklOVkFMSURfQ0hBUkFDVEVSX0VSUiIsICJTdHJpbmcgY29udGFpbnMgYW4gaW52YWxpZCBjaGFyYWN0ZXIiKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gci5jYWxsKHQsIG4pCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgcyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBuID0gaS5jYWxsKHQuZ2V0QXR0cmlidXRlKCJjbGFzcyIpIHx8ICIiKSwgZSA9IG4gPyBuLnNwbGl0KC9ccysvKSA6IFtdLCByID0gMCwgbyA9IGUubGVuZ3RoOyByIDwgbzsgcisrKSB0aGlzLnB1c2goZVtyXSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlQ2xhc3NOYW1lID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHQuc2V0QXR0cmlidXRlKCJjbGFzcyIsIHRoaXMudG9TdHJpbmcoKSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZCA9IHMucHJvdG90eXBlID0gW10sCiAgICAgICAgICAgICAgICBjID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBzKHRoaXMpCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICBpZiAoby5wcm90b3R5cGUgPSBFcnJvci5wcm90b3R5cGUsIGQuaXRlbSA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpc1t0XSB8fCBudWxsCiAgICAgICAgICAgICAgICB9LCBkLmNvbnRhaW5zID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAtMSAhPT0gYSh0aGlzLCB0ICs9ICIiKQogICAgICAgICAgICAgICAgfSwgZC5hZGQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdCwgbiA9IGFyZ3VtZW50cywKICAgICAgICAgICAgICAgICAgICAgICAgZSA9IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBuLmxlbmd0aCwKICAgICAgICAgICAgICAgICAgICAgICAgciA9ICExOwogICAgICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgICAgICAgdCA9IG5bZV0gKyAiIiwgLTEgPT09IGEodGhpcywgdCkgJiYgKHRoaXMucHVzaCh0KSwgciA9ICEwKQogICAgICAgICAgICAgICAgICAgIH0gd2hpbGUgKCsrZSA8IGkpOwogICAgICAgICAgICAgICAgICAgIHIgJiYgdGhpcy5fdXBkYXRlQ2xhc3NOYW1lKCkKICAgICAgICAgICAgICAgIH0sIGQucmVtb3ZlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHQsIG4sIGUgPSBhcmd1bWVudHMsCiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICByID0gZS5sZW5ndGgsCiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSAhMTsKICAgICAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodCA9IGVbaV0gKyAiIiwgbiA9IGEodGhpcywgdCk7IC0gMSAhPT0gbjspIHRoaXMuc3BsaWNlKG4sIDEpLCBvID0gITAsIG4gPSBhKHRoaXMsIHQpCiAgICAgICAgICAgICAgICAgICAgfSB3aGlsZSAoKytpIDwgcik7CiAgICAgICAgICAgICAgICAgICAgbyAmJiB0aGlzLl91cGRhdGVDbGFzc05hbWUoKQogICAgICAgICAgICAgICAgfSwgZC50b2dnbGUgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgICAgICAgICAgICAgdCArPSAiIjsKICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuY29udGFpbnModCksCiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSBlID8gITAgIT09IG4gJiYgInJlbW92ZSIgOiAhMSAhPT0gbiAmJiAiYWRkIjsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gaSAmJiB0aGlzW2ldKHQpLCAhMCA9PT0gbiB8fCAhMSA9PT0gbiA/IG4gOiAhZQogICAgICAgICAgICAgICAgfSwgZC50b1N0cmluZyA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmpvaW4oIiAiKQogICAgICAgICAgICAgICAgfSwgZS5kZWZpbmVQcm9wZXJ0eSkgewogICAgICAgICAgICAgICAgdmFyIHUgPSB7CiAgICAgICAgICAgICAgICAgICAgZ2V0OiBjLAogICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6ICEwLAogICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogITAKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIGUuZGVmaW5lUHJvcGVydHkobiwgImNsYXNzTGlzdCIsIHUpCiAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgICAgICAgdm9pZCAwICE9PSB0Lm51bWJlciAmJiAtMjE0NjgyMzI1MiAhPT0gdC5udW1iZXIgfHwgKHUuZW51bWVyYWJsZSA9ICExLCBlLmRlZmluZVByb3BlcnR5KG4sICJjbGFzc0xpc3QiLCB1KSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGUucHJvdG90eXBlLl9fZGVmaW5lR2V0dGVyX18gJiYgbi5fX2RlZmluZUdldHRlcl9fKCJjbGFzc0xpc3QiLCBjKQogICAgICAgIH0KICAgIH0od2luZG93LnNlbGYpLCBmdW5jdGlvbigpIHsKICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgdmFyIHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJfIik7CiAgICAgICAgaWYgKHQuY2xhc3NMaXN0LmFkZCgiYzEiLCAiYzIiKSwgIXQuY2xhc3NMaXN0LmNvbnRhaW5zKCJjMiIpKSB7CiAgICAgICAgICAgIHZhciBuID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdmFyIG4gPSBET01Ub2tlbkxpc3QucHJvdG90eXBlW3RdOwogICAgICAgICAgICAgICAgRE9NVG9rZW5MaXN0LnByb3RvdHlwZVt0XSA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZSwgaSA9IGFyZ3VtZW50cy5sZW5ndGg7CiAgICAgICAgICAgICAgICAgICAgZm9yIChlID0gMDsgZSA8IGk7IGUrKykgdCA9IGFyZ3VtZW50c1tlXSwgbi5jYWxsKHRoaXMsIHQpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIG4oImFkZCIpLCBuKCJyZW1vdmUiKQogICAgICAgIH0KICAgICAgICBpZiAodC5jbGFzc0xpc3QudG9nZ2xlKCJjMyIsICExKSwgdC5jbGFzc0xpc3QuY29udGFpbnMoImMzIikpIHsKICAgICAgICAgICAgdmFyIGUgPSBET01Ub2tlbkxpc3QucHJvdG90eXBlLnRvZ2dsZTsKICAgICAgICAgICAgRE9NVG9rZW5MaXN0LnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gMSBpbiBhcmd1bWVudHMgJiYgIXRoaXMuY29udGFpbnModCkgPT0gIW4gPyBuIDogZS5jYWxsKHRoaXMsIHQpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdCA9IG51bGwKICAgIH0oKSkKfSwgZnVuY3Rpb24odCwgbiwgZSkgewogICAgInVzZSBzdHJpY3QiOwogICAgZS5yKG4pOwogICAgdmFyIGkgPSBlKDY1KSwKICAgICAgICByID0gZS5uKGkpLAogICAgICAgIG8gPSBlKDY2KSwKICAgICAgICBhID0gZS5uKG8pOwogICAgZSgxMDgpLCBlKDEwOSk7CiAgICB2b2lkIDAgPT09IE9iamVjdC5hc3NpZ24gJiYgKE9iamVjdC5hc3NpZ24gPSByLmEpLCAidW5kZWZpbmVkIiA9PSB0eXBlb2YgUHJvbWlzZSAmJiAod2luZG93LlByb21pc2UgPSBhLmEpOwogICAgdmFyIHMsIGQsIGMsIHUgPSBlKDExKSwKICAgICAgICBsID0gZS5uKHUpLAogICAgICAgIEEgPSB7CiAgICAgICAgICAgIHJlYWR5OiAicG9raUFwcFJlYWR5IiwKICAgICAgICAgICAgYWRibG9ja2VkOiAicG9raUFwcEFkYmxvY2tlZCIsCiAgICAgICAgICAgIGFkczogewogICAgICAgICAgICAgICAgY29tcGxldGVkOiAicG9raUFkc0NvbXBsZXRlZCIsCiAgICAgICAgICAgICAgICBlcnJvcjogInBva2lBZHNFcnJvciIsCiAgICAgICAgICAgICAgICBpbXByZXNzaW9uOiAicG9raUFkc0ltcHJlc3Npb24iLAogICAgICAgICAgICAgICAgZHVyYXRpb25DaGFuZ2U6ICJwb2tpQWRzRHVyYXRpb25DaGFuZ2UiLAogICAgICAgICAgICAgICAgbGltaXQ6ICJwb2tpQWRzTGltaXQiLAogICAgICAgICAgICAgICAgcmVhZHk6ICJwb2tpQWRzUmVhZHkiLAogICAgICAgICAgICAgICAgcmVxdWVzdGVkOiAicG9raUFkc1JlcXVlc3RlZCIsCiAgICAgICAgICAgICAgICBwcmViaWRSZXF1ZXN0ZWQ6ICJwb2tpQWRzUHJlYmlkUmVxdWVzdGVkIiwKICAgICAgICAgICAgICAgIHNraXBwZWQ6ICJwb2tpQWRzU2tpcHBlZCIsCiAgICAgICAgICAgICAgICBzdGFydGVkOiAicG9raUFkc1N0YXJ0ZWQiLAogICAgICAgICAgICAgICAgc3RvcHBlZDogInBva2lBZHNTdG9wcGVkIiwKICAgICAgICAgICAgICAgIGJ1c3k6ICJwb2tpQWRzQnVzeSIsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogewogICAgICAgICAgICAgICAgICAgIHByZXJvbGw6ICJQUCIsCiAgICAgICAgICAgICAgICAgICAgbWlkcm9sbDogIlBNIiwKICAgICAgICAgICAgICAgICAgICByZXdhcmRlZDogIlBSIiwKICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiAiRFAiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgdmlkZW86IHsKICAgICAgICAgICAgICAgICAgICBjbGlja2VkOiAicG9raVZpZGVvQWRzQ2xpY2tlZCIsCiAgICAgICAgICAgICAgICAgICAgZmlyc3RRdWFydGlsZTogInBva2lWaWRlb0Fkc0ZpcnN0UXVhcnRpbGUiLAogICAgICAgICAgICAgICAgICAgIG1pZFBvaW50OiAicG9raVZpZGVvQWRzTWlkUG9pbnQiLAogICAgICAgICAgICAgICAgICAgIHRoaXJkUXVhcnRpbGU6ICJwb2tpVmlkZW9BZHNUaGlyZFF1YXJ0aWxlIiwKICAgICAgICAgICAgICAgICAgICBlcnJvcjogInBva2lWaWRlb0Fkc0Vycm9yIiwKICAgICAgICAgICAgICAgICAgICBsb2FkZXJFcnJvcjogInBva2lWaWRlb0Fkc0xvYWRlckVycm9yIiwKICAgICAgICAgICAgICAgICAgICBwYXVzZWQ6ICJwb2tpVmlkZW9BZHNQYXVzZVRyaWdnZXJlZCIsCiAgICAgICAgICAgICAgICAgICAgcmVzdW1lZDogInBva2lWaWRlb0Fkc1Jlc3VtZWRUcmlnZ2VyZWQiLAogICAgICAgICAgICAgICAgICAgIHByb2dyZXNzOiAicG9raVZpZGVvQWRzUHJvZ3Jlc3MiLAogICAgICAgICAgICAgICAgICAgIGJ1ZmZlcmluZzogInBva2lWaWRlb0Fkc0J1ZmZlcmluZyIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgaW5mbzogewogICAgICAgICAgICAgICAgbWVzc2FnZXM6IHsKICAgICAgICAgICAgICAgICAgICB0aW1lTGltaXQ6ICJUaGUgYWQtcmVxdWVzdCB3YXMgbm90IHByb2Nlc3NlZCwgYmVjYXVzZSBvZiBhIHRpbWUgY29uc3RyYWludCIsCiAgICAgICAgICAgICAgICAgICAgcHJlcm9sbExpbWl0OiAiVGhlIGFkLXJlcXVlc3Qgd2FzIGNhbmNlbGxlZCwgYmVjYXVzZSB3ZSdyZSBub3QgYWxsb3dlZCB0byBzaG93IGEgcHJlcm9sbCIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgbWVzc2FnZTogewogICAgICAgICAgICAgICAgZXZlbnQ6ICJwb2tpTWVzc2FnZUV2ZW50IiwKICAgICAgICAgICAgICAgIHNka0RldGFpbHM6ICJwb2tpTWVzc2FnZVNka0RldGFpbHMiLAogICAgICAgICAgICAgICAgdG9nZ2xlUHJvZ3JhbW1hdGljQWRzOiAicG9raU1lc3NhZ2VUb2dnbGVQcm9ncmFtbWF0aWNBZHMiCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHRyYWNraW5nOiB7CiAgICAgICAgICAgICAgICBjdXN0b206ICJwb2tpVHJhY2tpbmdDdXN0b20iLAogICAgICAgICAgICAgICAgc2V0UGxheWVyQWdlOiAicG9raVRyYWNraW5nU2V0UGxheWVyQWdlIiwKICAgICAgICAgICAgICAgIHRvZ2dsZVBsYXllckFkdmVydGlzaW5nQ29uc2VudDogInBva2lUcmFja2luZ1RvZ2dsZVBsYXllckFkdmVydGlzaW5nQ29uc2VudCIsCiAgICAgICAgICAgICAgICBkZWJ1Z1RydWVJblByb2R1Y3Rpb246ICJwb2tpTWVzc2FnZURlYnVnVHJ1ZVByb2R1Y3Rpb24iLAogICAgICAgICAgICAgICAgc2NyZWVuOiB7CiAgICAgICAgICAgICAgICAgICAgZ2FtZXBsYXlTdGFydDogInBva2lUcmFja2luZ1NjcmVlbkdhbWVwbGF5U3RhcnQiLAogICAgICAgICAgICAgICAgICAgIGdhbWVwbGF5U3RvcDogInBva2lUcmFja2luZ1NjcmVlbkdhbWVwbGF5U3RvcCIsCiAgICAgICAgICAgICAgICAgICAgZ2FtZUxvYWRpbmdTdGFydGVkOiAicG9raVRyYWNraW5nU2NyZWVuR2FtZUxvYWRpbmdTdGFydGVkIiwKICAgICAgICAgICAgICAgICAgICBnYW1lTG9hZGluZ1Byb2dyZXNzOiAicG9raVRyYWNraW5nU2NyZWVuR2FtZUxvYWRpbmdQcm9ncmVzcyIsCiAgICAgICAgICAgICAgICAgICAgZ2FtZUxvYWRpbmdGaW5pc2hlZDogInBva2lUcmFja2luZ1NjcmVlbkdhbWVMb2FkaW5nRmluaXNoZWQiLAogICAgICAgICAgICAgICAgICAgIGNvbW1lcmNpYWxCcmVhazogInBva2lUcmFja2luZ1NjcmVlbkNvbW1lcmNpYWxCcmVhayIsCiAgICAgICAgICAgICAgICAgICAgcmV3YXJkZWRCcmVhazogInBva2lUcmFja2luZ1NjcmVlblJld2FyZGVkQnJlYWsiLAogICAgICAgICAgICAgICAgICAgIGhhcHB5VGltZTogInBva2lUcmFja2luZ1NjcmVlbkhhcHB5VGltZSIsCiAgICAgICAgICAgICAgICAgICAgZmlyc3RSb3VuZDogInBva2lUcmFja2luZ1NjcmVlbkZpcnN0Um91bmQiLAogICAgICAgICAgICAgICAgICAgIHJvdW5kU3RhcnQ6ICJwb2tpVHJhY2tpbmdTY3JlZW5Sb3VuZFN0YXJ0IiwKICAgICAgICAgICAgICAgICAgICByb3VuZEVuZDogInBva2lUcmFja2luZ1NjcmVlblJvdW5kRW5kIiwKICAgICAgICAgICAgICAgICAgICBnYW1lSW50ZXJhY3RpdmU6ICJwb2tpVHJhY2tpbmdTY3JlZW5HYW1lSW50ZXJhY3RpdmUiLAogICAgICAgICAgICAgICAgICAgIGRpc3BsYXlBZDogInBva2lUcmFja2luZ1NjcmVlbkRpc3BsYXlBZFJlcXVlc3QiLAogICAgICAgICAgICAgICAgICAgIGRlc3Ryb3lBZDogInBva2lUcmFja2luZ1NjcmVlbkRpc3BsYXlBZERlc3Ryb3kiCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgc2RrOiB7CiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGluaXRpYWxpemVkOiAicG9raVRyYWNraW5nU2RrU3RhdHVzSW5pdGlhbGl6ZWQiLAogICAgICAgICAgICAgICAgICAgICAgICBmYWlsZWQ6ICJwb2tpVHJhY2tpbmdTZGtTdGF0dXNGYWlsZWQiCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGFkczogewogICAgICAgICAgICAgICAgICAgIHN0YXR1czogewogICAgICAgICAgICAgICAgICAgICAgICBidXN5OiAicG9raVRyYWNraW5nQWRzU3RhdHVzQnVzeSIsCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbXBsZXRlZDogInBva2lUcmFja2luZ0Fkc1N0YXR1c0NvbXBsZXRlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiAicG9raVRyYWNraW5nQWRzU3RhdHVzRXJyb3IiLAogICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5RXJyb3I6ICJwb2tpVHJhY2tpbmdBZHNTdGF0dXNEaXNwbGF5RXJyb3IiLAogICAgICAgICAgICAgICAgICAgICAgICBpbXByZXNzaW9uOiAicG9raVRyYWNraW5nQWRzU3RhdHVzSW1wcmVzc2lvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIGxpbWl0OiAicG9raVRyYWNraW5nQWRzU3RhdHVzTGltaXQiLAogICAgICAgICAgICAgICAgICAgICAgICByZWFkeTogInBva2lUcmFja2luZ0Fkc1N0YXR1c1JlYWR5IiwKICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdGVkOiAicG9raVRyYWNraW5nQWRzU3RhdHVzUmVxdWVzdGVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgcHJlYmlkUmVxdWVzdGVkOiAicG9raVRyYWNraW5nQWRzU3RhdHVzUHJlYmlkUmVxdWVzdGVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBlZDogInBva2lUcmFja2luZ0Fkc1N0YXR1c1NraXBwZWQiLAogICAgICAgICAgICAgICAgICAgICAgICBzdGFydGVkOiAicG9raVRyYWNraW5nQWRzU3RhdHVzU3RhcnRlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZmZlcmluZzogInBva2lUcmFja2luZ0Fkc1N0YXR1c0J1ZmZlcmluZyIKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIHZpZGVvOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrZWQ6ICJwb2tpVHJhY2tpbmdBZHNWaWRlb0NsaWNrZWQiLAogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogInBva2lUcmFja2luZ0Fkc1ZpZGVvRXJyb3IiLAogICAgICAgICAgICAgICAgICAgICAgICBsb2FkZXJFcnJvcjogInBva2lUcmFja2luZ0Fkc1ZpZGVvTG9hZGVyRXJyb3IiCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlcXVlc3RlZDogInBva2lUcmFja2luZ1NjcmVlbkRpc3BsYXlBZFJlcXVlc3RlZCIsCiAgICAgICAgICAgICAgICAgICAgICAgIGltcHJlc3Npb246ICJwb2tpVHJhY2tpbmdTY3JlZW5EaXNwbGF5QWRJbXByZXNzaW9uIiwKICAgICAgICAgICAgICAgICAgICAgICAgdmlld2FibGU6ICJwb2tpVHJhY2tpbmdTY3JlZW5EaXNwbGF5QWRWaWV3YWJsZSIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIG0gPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIChtID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBuLCBlID0gMSwgaSA9IGFyZ3VtZW50cy5sZW5ndGg7IGUgPCBpOyBlKyspCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgciBpbiBuID0gYXJndW1lbnRzW2VdKSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobiwgcikgJiYgKHRbcl0gPSBuW3JdKTsKICAgICAgICAgICAgICAgIHJldHVybiB0CiAgICAgICAgICAgIH0pLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykKICAgICAgICB9LAogICAgICAgIGYgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgZnVuY3Rpb24gdCgpIHt9CiAgICAgICAgICAgIHJldHVybiB0LmNsZWFyRXZlbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzID0ge30KICAgICAgICAgICAgfSwgdC5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24odCwgbikgewogICAgICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0aGlzLmxpc3RlbmVycywgdCkpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMubGlzdGVuZXJzW3RdLmluZGV4T2Yobik7IC0gMSAhPT0gZSAmJiB0aGlzLmxpc3RlbmVyc1t0XS5zcGxpY2UoZSwgMSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgdC5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24odCwgbiwgZSkgewogICAgICAgICAgICAgICAgdmFyIGkgPSB0aGlzOwogICAgICAgICAgICAgICAgaWYgKHZvaWQgMCA9PT0gZSAmJiAoZSA9ICExKSwgZSA9ICEhZSwgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHRoaXMubGlzdGVuZXJzLCB0KSB8fCAodGhpcy5saXN0ZW5lcnNbdF0gPSBbXSksIGUpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgciA9IGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaS5yZW1vdmVFdmVudExpc3RlbmVyLmJpbmQoaSkodCwgciksIG4oZSkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzW3RdLnB1c2gocikKICAgICAgICAgICAgICAgIH0gZWxzZSB0aGlzLmxpc3RlbmVyc1t0XS5wdXNoKG4pCiAgICAgICAgICAgIH0sIHQuZGlzcGF0Y2hFdmVudCA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgICAgIHZvaWQgMCA9PT0gbiAmJiAobiA9IHt9KSwgIXRoaXMuZGVidWcgfHwgd2luZG93LnByb2Nlc3MgJiYgd2luZG93LnByb2Nlc3MuZW52ICYmICJ0ZXN0IiA9PT0gd2luZG93LnByb2Nlc3MuZW52Lk5PREVfRU5WIHx8IGNvbnNvbGUuaW5mbyh0LCBuKTsKICAgICAgICAgICAgICAgIGZvciAodmFyIGUgPSBPYmplY3Qua2V5cyh0aGlzLmxpc3RlbmVycyksIGkgPSAwOyBpIDwgZS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIHZhciByID0gZVtpXTsKICAgICAgICAgICAgICAgICAgICBpZiAodCA9PT0gcikKICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbyA9IHRoaXMubGlzdGVuZXJzW3JdLCBhID0gMDsgYSA8IG8ubGVuZ3RoOyBhKyspIG9bYV0obShtKHt9LCB0aGlzLmRhdGFBbm5vdGF0aW9ucyksIG4pKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCB0LnNldERlYnVnID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdGhpcy5kZWJ1ZyA9IHQKICAgICAgICAgICAgfSwgdC5zZXREYXRhQW5ub3RhdGlvbnMgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICB0aGlzLmRhdGFBbm5vdGF0aW9ucyA9IG0obSh7fSwgdGhpcy5kYXRhQW5ub3RhdGlvbnMpLCB0KQogICAgICAgICAgICB9LCB0LmdldERhdGFBbm5vdGF0aW9ucyA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YUFubm90YXRpb25zCiAgICAgICAgICAgIH0sIHQuY2xlYXJBbm5vdGF0aW9ucyA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdGhpcy5kYXRhQW5ub3RhdGlvbnMgPSB7fQogICAgICAgICAgICB9LCB0Lmxpc3RlbmVycyA9IHt9LCB0LmRlYnVnID0gITEsIHQuZGF0YUFubm90YXRpb25zID0ge30sIHQKICAgICAgICB9KCksCiAgICAgICAgcCA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgdmFyIGUgPSAhMTsKICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKG4pLmZvckVhY2goKGZ1bmN0aW9uKGkpIHsKICAgICAgICAgICAgICAgIG5baV0gPT09IHQgJiYgKGUgPSAhMCkKICAgICAgICAgICAgfSkpLCBlCiAgICAgICAgfSwKICAgICAgICBnID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGZ1bmN0aW9uIHQoKSB7fQogICAgICAgICAgICByZXR1cm4gdC5zZW5kTWVzc2FnZSA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgICAgIHZvaWQgMCA9PT0gbiAmJiAobiA9IHt9KTsKICAgICAgICAgICAgICAgIHZhciBlID0gd2luZG93LnBhcmVudDsKICAgICAgICAgICAgICAgIGlmICghcCh0LCBBLm1lc3NhZ2UpKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBPYmplY3Qua2V5cyhBLm1lc3NhZ2UpLm1hcCgoZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gInBva2kubWVzc2FnZS4iICsgdAogICAgICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCJBcmd1bWVudCAndHlwZScgbXVzdCBiZSBvbmUgb2YgIiArIGkuam9pbigiLCAiKSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGUucG9zdE1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgIHR5cGU6IHQsCiAgICAgICAgICAgICAgICAgICAgY29udGVudDogbgogICAgICAgICAgICAgICAgfSwgIioiKQogICAgICAgICAgICB9LCB0CiAgICAgICAgfSgpLAogICAgICAgIGggPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgIHZhciBuID0gbmV3IEFycmF5OwogICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModCkuZm9yRWFjaCgoZnVuY3Rpb24oZSkgewogICAgICAgICAgICAgICAgIm9iamVjdCIgPT0gdHlwZW9mIHRbZV0gPyBuID0gbi5jb25jYXQoaCh0W2VdKSkgOiBuLnB1c2godFtlXSkKICAgICAgICAgICAgfSkpLCBuCiAgICAgICAgfSwKICAgICAgICB3ID0gaChBLnRyYWNraW5nKSwKICAgICAgICB5ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGZ1bmN0aW9uIHQoKSB7fQogICAgICAgICAgICByZXR1cm4gdC5zZXREZWJ1ZyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHRoaXMuZGVidWcgPSB0CiAgICAgICAgICAgIH0sIHQudHJhY2sgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgICAgICAgICBpZiAodm9pZCAwID09PSBuICYmIChuID0ge30pLCAtMSA9PT0gdy5pbmRleE9mKHQpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkICdldmVudCcsIG11c3QgYmUgb25lIG9mICIgKyB3LmpvaW4oIiwgIikpOwogICAgICAgICAgICAgICAgaWYgKCJvYmplY3QiICE9IHR5cGVvZiBuKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJJbnZhbGlkIGRhdGEsIG11c3QgYmUgYW4gb2JqZWN0Iik7CiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZWJ1ZykgewogICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cucHJvY2VzcyAmJiB3aW5kb3cucHJvY2Vzcy5lbnYgJiYgInRlc3QiID09PSB3aW5kb3cucHJvY2Vzcy5lbnYuTk9ERV9FTlYpIHJldHVybjsKICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhuKS5sZW5ndGggPyBjb25zb2xlLmluZm8oIiVjUE9LSV9UUkFDS0VSOiAlY1RyYWNrZWQgZXZlbnQgJyIgKyB0ICsgIicgd2l0aCBkYXRhOiIsICJmb250LXdlaWdodDogYm9sZCIsICIiLCBuKSA6IGNvbnNvbGUuaW5mbygiJWNQT0tJX1RSQUNLRVI6ICVjVHJhY2tlZCBldmVudCAnIiArIHQgKyAiJyIsICJmb250LXdlaWdodDogYm9sZCIsICIiKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZy5zZW5kTWVzc2FnZShBLm1lc3NhZ2UuZXZlbnQsIHsKICAgICAgICAgICAgICAgICAgICBldmVudDogdCwKICAgICAgICAgICAgICAgICAgICBkYXRhOiBuCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9LCB0LnNldHVwRGVmYXVsdEV2ZW50cyA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFyIG4sIGUgPSAoKG4gPSB7fSlbQS5yZWFkeV0gPSBBLnRyYWNraW5nLnNkay5zdGF0dXMuaW5pdGlhbGl6ZWQsIG5bQS5hZGJsb2NrZWRdID0gQS50cmFja2luZy5zZGsuc3RhdHVzLmZhaWxlZCwgbltBLmFkcy5idXN5XSA9IEEudHJhY2tpbmcuYWRzLnN0YXR1cy5idXN5LCBuW0EuYWRzLmNvbXBsZXRlZF0gPSBBLnRyYWNraW5nLmFkcy5zdGF0dXMuY29tcGxldGVkLCBuW0EuYWRzLmVycm9yXSA9IEEudHJhY2tpbmcuYWRzLnN0YXR1cy5lcnJvciwgbltBLmFkcy5kaXNwbGF5RXJyb3JdID0gQS50cmFja2luZy5hZHMuc3RhdHVzLmRpc3BsYXlFcnJvciwgbltBLmFkcy5pbXByZXNzaW9uXSA9IEEudHJhY2tpbmcuYWRzLnN0YXR1cy5pbXByZXNzaW9uLCBuW0EuYWRzLmxpbWl0XSA9IEEudHJhY2tpbmcuYWRzLnN0YXR1cy5saW1pdCwgbltBLmFkcy5yZWFkeV0gPSBBLnRyYWNraW5nLmFkcy5zdGF0dXMucmVhZHksIG5bQS5hZHMucmVxdWVzdGVkXSA9IEEudHJhY2tpbmcuYWRzLnN0YXR1cy5yZXF1ZXN0ZWQsIG5bQS5hZHMucHJlYmlkUmVxdWVzdGVkXSA9IEEudHJhY2tpbmcuYWRzLnN0YXR1cy5wcmViaWRSZXF1ZXN0ZWQsIG5bQS5hZHMuc2tpcHBlZF0gPSBBLnRyYWNraW5nLmFkcy5zdGF0dXMuc2tpcHBlZCwgbltBLmFkcy5zdGFydGVkXSA9IEEudHJhY2tpbmcuYWRzLnN0YXR1cy5zdGFydGVkLCBuW0EuYWRzLnZpZGVvLmNsaWNrZWRdID0gQS50cmFja2luZy5hZHMudmlkZW8uY2xpY2tlZCwgbltBLmFkcy52aWRlby5lcnJvcl0gPSBBLnRyYWNraW5nLmFkcy52aWRlby5lcnJvciwgbltBLmFkcy52aWRlby5sb2FkZXJFcnJvcl0gPSBBLnRyYWNraW5nLmFkcy52aWRlby5sb2FkZXJFcnJvciwgbltBLmFkcy52aWRlby5idWZmZXJpbmddID0gQS50cmFja2luZy5hZHMuc3RhdHVzLmJ1ZmZlcmluZywgbltBLnRyYWNraW5nLnNjcmVlbi5nYW1lcGxheVN0YXJ0XSA9IEEudHJhY2tpbmcuc2NyZWVuLmdhbWVwbGF5U3RhcnQsIG5bQS50cmFja2luZy5zY3JlZW4uZ2FtZXBsYXlTdG9wXSA9IEEudHJhY2tpbmcuc2NyZWVuLmdhbWVwbGF5U3RvcCwgbltBLnRyYWNraW5nLnNjcmVlbi5sb2FkaW5nUHJvZ3Jlc3NdID0gQS50cmFja2luZy5zY3JlZW4ubG9hZGluZ1Byb2dyZXNzLCBuW0EudHJhY2tpbmcuc2NyZWVuLmNvbW1lcmNpYWxCcmVha10gPSBBLnRyYWNraW5nLnNjcmVlbi5jb21tZXJjaWFsQnJlYWssIG5bQS50cmFja2luZy5zY3JlZW4ucmV3YXJkZWRCcmVha10gPSBBLnRyYWNraW5nLnNjcmVlbi5yZXdhcmRlZEJyZWFrLCBuW0EudHJhY2tpbmcuc2NyZWVuLmhhcHB5VGltZV0gPSBBLnRyYWNraW5nLnNjcmVlbi5oYXBweVRpbWUsIG4pOwogICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoZSkuZm9yRWFjaCgoZnVuY3Rpb24obikgewogICAgICAgICAgICAgICAgICAgIGYuYWRkRXZlbnRMaXN0ZW5lcihuLCAoZnVuY3Rpb24oaSkgewogICAgICAgICAgICAgICAgICAgICAgICB0LnRyYWNrKGVbbl0sIGkpCiAgICAgICAgICAgICAgICAgICAgfSkpCiAgICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgfSwgdC5kZWJ1ZyA9ICExLCB0CiAgICAgICAgfSgpLAogICAgICAgIHYgPSB7CiAgICAgICAgICAgIGFkVGFnVXJsOiAiLy9wdWJhZHMuZy5kb3VibGVjbGljay5uZXQvZ2FtcGFkL2Fkcz9zej02NDB4MzYwfDY0MHg0ODAmaXU9LzEwNTM1NTEvUHViLVBva2ktR2VuZXJpYyZjaXVfc3pzJmltcGw9cyZnZGZwX3JlcT0xJmVudj12cCZvdXRwdXQ9eG1sX3Zhc3QyJnVudmlld2VkX3Bvc2l0aW9uX3N0YXJ0PTEmdXJsPXt1cmx9JmRlc2NyaXB0aW9uX3VybD17ZGVzY3JpcHRpb25Vcmx9JmNvcnJlbGF0b3I9e3RpbWVzdGFtcH0iLAogICAgICAgICAgICBhZFRpbWluZzogewogICAgICAgICAgICAgICAgcHJlcm9sbDogITEsCiAgICAgICAgICAgICAgICB0aW1lQmV0d2VlbkFkczogMTJlNCwKICAgICAgICAgICAgICAgIHRpbWVQZXJUcnk6IDdlMywKICAgICAgICAgICAgICAgIHN0YXJ0QWRzQWZ0ZXI6IDEyZTQKICAgICAgICAgICAgfSwKICAgICAgICAgICAgd2F0ZXJmYWxsUmV0cmllczogMiwKICAgICAgICAgICAgY291bnRyeTogIk5MIgogICAgICAgIH0sCiAgICAgICAgYiA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBBcnJheSA/IHQgOiBbdF0KICAgICAgICB9LAogICAgICAgIGsgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgZnVuY3Rpb24gdCh0KSB7CiAgICAgICAgICAgICAgICB2b2lkIDAgPT09IHQgJiYgKHQgPSB7fSksIHRoaXMuc2V0VGltaW5ncyh0KSwgdGhpcy50aW1pbmdJZHggPSB7CiAgICAgICAgICAgICAgICAgICAgdGltZVBlclRyeTogMAogICAgICAgICAgICAgICAgfSwgdGhpcy50aW1lcnMgPSB7CiAgICAgICAgICAgICAgICAgICAgdGltZVBlclRyeTogdm9pZCAwLAogICAgICAgICAgICAgICAgICAgIHRpbWVCZXR3ZWVuQWRzOiB2b2lkIDAsCiAgICAgICAgICAgICAgICAgICAgc3RhcnRBZHNBZnRlcjogdm9pZCAwCiAgICAgICAgICAgICAgICB9LCBmLmFkZEV2ZW50TGlzdGVuZXIoQS5hZHMucmVxdWVzdGVkLCB0aGlzLnN0YXJ0VGltZUJldHdlZW5BZHNUaW1lci5iaW5kKHRoaXMpKSwgZi5hZGRFdmVudExpc3RlbmVyKEEuYWRzLmNvbXBsZXRlZCwgdGhpcy5zdGFydFRpbWVCZXR3ZWVuQWRzVGltZXIuYmluZCh0aGlzKSksIGYuYWRkRXZlbnRMaXN0ZW5lcihBLmFkcy5zdG9wcGVkLCB0aGlzLnN0YXJ0VGltZUJldHdlZW5BZHNUaW1lci5iaW5kKHRoaXMpKQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0LnByb3RvdHlwZS5zZXRUaW1pbmdzID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdmFyIG4gPSB2LmFkVGltaW5nLAogICAgICAgICAgICAgICAgICAgIGUgPSB0LnByZXJvbGwsCiAgICAgICAgICAgICAgICAgICAgaSA9IHZvaWQgMCA9PT0gZSA/IG4ucHJlcm9sbCA6IGUsCiAgICAgICAgICAgICAgICAgICAgciA9IHQudGltZVBlclRyeSwKICAgICAgICAgICAgICAgICAgICBvID0gdm9pZCAwID09PSByID8gbi50aW1lUGVyVHJ5IDogciwKICAgICAgICAgICAgICAgICAgICBhID0gdC50aW1lQmV0d2VlbkFkcywKICAgICAgICAgICAgICAgICAgICBzID0gdm9pZCAwID09PSBhID8gbi50aW1lQmV0d2VlbkFkcyA6IGEsCiAgICAgICAgICAgICAgICAgICAgZCA9IHQuc3RhcnRBZHNBZnRlciwKICAgICAgICAgICAgICAgICAgICBjID0gdm9pZCAwID09PSBkID8gbi5zdGFydEFkc0FmdGVyIDogZDsKICAgICAgICAgICAgICAgIHRoaXMudGltaW5ncyA9IHsKICAgICAgICAgICAgICAgICAgICBwcmVyb2xsOiAhMSAhPT0gaSwKICAgICAgICAgICAgICAgICAgICB0aW1lUGVyVHJ5OiBiKG8pLAogICAgICAgICAgICAgICAgICAgIHRpbWVCZXR3ZWVuQWRzOiBzLAogICAgICAgICAgICAgICAgICAgIHN0YXJ0QWRzQWZ0ZXI6IGMKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuc3RhcnRUaW1lQmV0d2VlbkFkc1RpbWVyID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB0aGlzLnN0YXJ0VGltZXIoInRpbWVCZXR3ZWVuQWRzIikKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuc3RhcnRTdGFydEFkc0FmdGVyVGltZXIgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHRoaXMuc3RhcnRUaW1lcigic3RhcnRBZHNBZnRlciIpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLnJlcXVlc3RQb3NzaWJsZSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgcmV0dXJuICF0aGlzLnRpbWVycy50aW1lQmV0d2VlbkFkcyAmJiAhdGhpcy50aW1lcnMuc3RhcnRBZHNBZnRlcgogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5zdGFydFdhdGVyZmFsbFRpbWVyID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdGhpcy5zdGFydFRpbWVyKCJ0aW1lUGVyVHJ5IiwgdCkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuc3RvcFdhdGVyZmFsbFRpbWVyID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB0aGlzLnN0b3BUaW1lcigidGltZVBlclRyeSIpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLm5leHRXYXRlcmZhbGxUaW1lciA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdGhpcy5uZXh0VGltaW5nKCJ0aW1lUGVyVHJ5IikKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUucmVzZXRXYXRlcmZhbGxUaW1lcklkeCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdGhpcy5yZXNldFRpbWluZ0lkeCgidGltZVBlclRyeSIpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLnN0b3BUaW1lciA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHRoaXMudGltZXJzW3RdICYmIChjbGVhclRpbWVvdXQodGhpcy50aW1lcnNbdF0pLCB0aGlzLnRpbWVyc1t0XSA9IHZvaWQgMCkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuc3RhcnRUaW1lciA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgICAgIHZhciBlID0gdGhpczsKICAgICAgICAgICAgICAgIHZvaWQgMCA9PT0gbiAmJiAobiA9IGZ1bmN0aW9uKCkge30pLCB0aGlzLmdldFRpbWluZyh0KSA8PSAwID8gbigpIDogKHRoaXMudGltZXJzW3RdICYmIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyc1t0XSksIHRoaXMudGltZXJzW3RdID0gc2V0VGltZW91dCgoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgZS5zdG9wVGltZXIodCksIG4oKQogICAgICAgICAgICAgICAgfSksIHRoaXMuZ2V0VGltaW5nKHQpKSkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuZ2V0VGltaW5nID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdmFyIG4gPSB0aGlzLnRpbWluZ3NbdF07CiAgICAgICAgICAgICAgICByZXR1cm4gbiBpbnN0YW5jZW9mIEFycmF5ID8gblt0aGlzLnRpbWluZ0lkeFt0XV0gOiBuCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLm5leHRUaW1pbmcgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICBpZiAodm9pZCAwID09PSB0aGlzLnRpbWluZ0lkeFt0XSkgdGhyb3cgbmV3IEVycm9yKCJBZFRpbWluZ3MgRXJyb3I6ICIgKyB0ICsgIiBkb2VzIG5vdCBoYXZlIG11bHRpcGxlIHRpbWVycyIpOwogICAgICAgICAgICAgICAgdGhpcy50aW1pbmdJZHhbdF0gPSAodGhpcy50aW1pbmdJZHhbdF0gKyAxKSAlIHRoaXMudGltaW5nc1t0XS5sZW5ndGgKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUucmVzZXRUaW1pbmdJZHggPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICBpZiAodm9pZCAwID09PSB0aGlzLnRpbWluZ0lkeFt0XSkgdGhyb3cgbmV3IEVycm9yKCJBZFRpbWluZ3MgRXJyb3I6ICIgKyB0ICsgIiBkb2VzIG5vdCBoYXZlIG11bHRpcGxlIHRpbWVycyIpOwogICAgICAgICAgICAgICAgdGhpcy50aW1pbmdJZHhbdF0gPSAwCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLnByZXJvbGxQb3NzaWJsZSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGltaW5ncy5wcmVyb2xsCiAgICAgICAgICAgIH0sIHQKICAgICAgICB9KCksCiAgICAgICAgUyA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gd2luZG93LmxvY2F0aW9uLmhyZWYKICAgICAgICB9LAogICAgICAgIEUgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuICJ1bmRlZmluZWQiICE9IHR5cGVvZiBuYXZpZ2F0b3IgJiYgLyg/OnBob25lfHdpbmRvd3NccytwaG9uZXxpcG9kfGJsYWNrYmVycnl8KD86YW5kcm9pZHxiYlxkK3xtZWVnb3xzaWxrfGdvb2dsZWJvdCkgLis/IG1vYmlsZXxwYWxtfHdpbmRvd3NccytjZXxvcGVyYVxzbWluaXxhdmFudGdvfG1vYmlsZXNhZmFyaXxkb2NvbW8pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KQogICAgICAgIH0sCiAgICAgICAgeCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gInVuZGVmaW5lZCIgIT0gdHlwZW9mIG5hdmlnYXRvciAmJiAvKD86aXBhZHxwbGF5Ym9va3woPzphbmRyb2lkfGJiXGQrfG1lZWdvfHNpbGspKD8hIC4rPyBtb2JpbGUpKS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkKICAgICAgICB9LAogICAgICAgIFQgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgICAgIGlmICgidW5kZWZpbmVkIiA9PSB0eXBlb2Ygd2luZG93KSByZXR1cm4gIiI7CiAgICAgICAgICAgIHQgPSB0LnJlcGxhY2UoL1tcW10vLCAiXFxbIikucmVwbGFjZSgvW1xdXS8sICJcXF0iKTsKICAgICAgICAgICAgdmFyIGUgPSBuZXcgUmVnRXhwKCJbXFw/Jl0iICsgdCArICI9KFteJiNdKikiKS5leGVjKG4gfHwgd2luZG93LmxvY2F0aW9uLnNlYXJjaCk7CiAgICAgICAgICAgIHJldHVybiBudWxsID09PSBlID8gIiIgOiBkZWNvZGVVUklDb21wb25lbnQoZVsxXS5yZXBsYWNlKC9cKy9nLCAiICIpKQogICAgICAgIH0sCiAgICAgICAgeiA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gInVuZGVmaW5lZCIgIT0gdHlwZW9mIG5hdmlnYXRvciAmJiAvTVNJRSBcXGR8VHJpZGVudC4qcnY6L2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KQogICAgICAgIH0sCiAgICAgICAgQyA9IHsKICAgICAgICAgICAgMTogImVOakR3MUFWVHIiLAogICAgICAgICAgICAyOiAiSGt1UUphV25CYSIsCiAgICAgICAgICAgIDM6ICJBZlJLQ2x2ZFlrIiwKICAgICAgICAgICAgNDogIkRiN3VZYnNubFciLAogICAgICAgICAgICA1OiAiVXByZFlLZTc0ciIsCiAgICAgICAgICAgIDY6ICJlSEZEakQ1bnByIiwKICAgICAgICAgICAgNzogIm1tMWpTRkpqTGwiLAogICAgICAgICAgICA4OiAidEo0NHZwTHB1TSIsCiAgICAgICAgICAgIDk6ICJtRjVBU2FnYTRBIiwKICAgICAgICAgICAgMTA6ICJyS1Y4ck13aXdrIiwKICAgICAgICAgICAgMTE6ICJTdks4Qkg1cVM1IiwKICAgICAgICAgICAgMTI6ICJxamNhVkdwOEhzIiwKICAgICAgICAgICAgMTM6ICJ5c3hJY210M3RXIiwKICAgICAgICAgICAgMTQ6ICJmejZhSzl3TVFlIiwKICAgICAgICAgICAgMTU6ICJSVTZlYklGTHc5IiwKICAgICAgICAgICAgMTY6ICJyOUc0dFZNWXc3IiwKICAgICAgICAgICAgMTc6ICJTZ2NEYTVCOHMxIiwKICAgICAgICAgICAgMTg6ICI5d0ROTW5DaHY2IiwKICAgICAgICAgICAgMTk6ICJETlpYOFhkSlhWIiwKICAgICAgICAgICAgMjA6ICIzOW80WVV5WlRYIiwKICAgICAgICAgICAgMjE6ICI1c2IySEZwejVhIiwKICAgICAgICAgICAgMjI6ICJwZ1h6Q0paaXBFIiwKICAgICAgICAgICAgMjM6ICJPYW5pOEVBR0k5IiwKICAgICAgICAgICAgMjQ6ICJJekNlaDdkN3ZXIiwKICAgICAgICAgICAgMjU6ICJJNXZSTnRqb01yIiwKICAgICAgICAgICAgMjY6ICJLcHlTdkc3bHVxIiwKICAgICAgICAgICAgMjc6ICJkSzQySjRySTE0IiwKICAgICAgICAgICAgMjg6ICJIdVlvcnczZlJnIiwKICAgICAgICAgICAgMjk6ICJtZjg0Y0dZYzFoIiwKICAgICAgICAgICAgMzA6ICJJMnY2c1FLWFZEIiwKICAgICAgICAgICAgMzE6ICJsQnpTZFZHWThGIiwKICAgICAgICAgICAgMzI6ICJoS1lnazlXYjhxIiwKICAgICAgICAgICAgMzM6ICJ4UEJyOEU1NGVFIiwKICAgICAgICAgICAgMzQ6ICJadklLMldLQzdHIiwKICAgICAgICAgICAgMzU6ICI3a2lZaTN6bElYIiwKICAgICAgICAgICAgMzY6ICJWcHlnWU1URGdtIiwKICAgICAgICAgICAgMzc6ICJtaXM5TXQ0bnA0IiwKICAgICAgICAgICAgMzg6ICI0NTFLSklvRUloIiwKICAgICAgICAgICAgNDE6ICJGcW1qcDlIaXQzIiwKICAgICAgICAgICAgNDI6ICJsUzJYR2cwNThMIiwKICAgICAgICAgICAgNDM6ICIzdUZmMlBsSUN5IiwKICAgICAgICAgICAgNDY6ICJ2b2VJcTV1UnZsIiwKICAgICAgICAgICAgNDc6ICIyMU95YmJpSWRjIiwKICAgICAgICAgICAgNDg6ICI5aTNSd1BIeldXIiwKICAgICAgICAgICAgNDk6ICJDTVZvTXZ2RW11IiwKICAgICAgICAgICAgNTA6ICJJb1FyaFJiM3dVIgogICAgICAgIH0sCiAgICAgICAgSSA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgcmV0dXJuIENbdF0gfHwgIiIKICAgICAgICB9LAogICAgICAgIF8gPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiB3aW5kb3cuc2VsZiAhPT0gd2luZG93LnRvcAogICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gITAKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgQiA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gKEIgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIG4sIGUgPSAxLCBpID0gYXJndW1lbnRzLmxlbmd0aDsgZSA8IGk7IGUrKykKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciByIGluIG4gPSBhcmd1bWVudHNbZV0pIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChuLCByKSAmJiAodFtyXSA9IG5bcl0pOwogICAgICAgICAgICAgICAgcmV0dXJuIHQKICAgICAgICAgICAgfSkuYXBwbHkodGhpcywgYXJndW1lbnRzKQogICAgICAgIH0sCiAgICAgICAgUCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICBmb3IgKHZhciB0ID0gMCwgbiA9IDAsIGUgPSBhcmd1bWVudHMubGVuZ3RoOyBuIDwgZTsgbisrKSB0ICs9IGFyZ3VtZW50c1tuXS5sZW5ndGg7CiAgICAgICAgICAgIHZhciBpID0gQXJyYXkodCksCiAgICAgICAgICAgICAgICByID0gMDsKICAgICAgICAgICAgZm9yIChuID0gMDsgbiA8IGU7IG4rKykKICAgICAgICAgICAgICAgIGZvciAodmFyIG8gPSBhcmd1bWVudHNbbl0sIGEgPSAwLCBzID0gby5sZW5ndGg7IGEgPCBzOyBhKyssIHIrKykgaVtyXSA9IG9bYV07CiAgICAgICAgICAgIHJldHVybiBpCiAgICAgICAgfSwKICAgICAgICBEID0gKHMgPSBwYXJzZUludChUKCJzaXRlX2lkIiksIDEwKSB8fCAwLCBkID0geigpIHx8IEUoKSB8fCB4KCkgPyBbInZpZGVvL21wNCJdIDogWyJ2aWRlby9tcDQiLCAidmlkZW8vd2VibSIsICJ2aWRlby9vZ2ciXSwgewogICAgICAgICAgICBiaWRzOiBbewogICAgICAgICAgICAgICAgYmlkZGVyOiAiYXBwbmV4dXMiLAogICAgICAgICAgICAgICAgcGFyYW1zOiBCKEIoewogICAgICAgICAgICAgICAgICAgIHBsYWNlbWVudElkOiAxMzE4NDI1MCwKICAgICAgICAgICAgICAgICAgICBtYXhkdXJhdGlvbjogMTUKICAgICAgICAgICAgICAgIH0sIGMgPSB7CiAgICAgICAgICAgICAgICAgICAgYWxsb3dTbWFsbGVyU2l6ZXM6ICEwLAogICAgICAgICAgICAgICAgICAgIGZyYW1ld29ya3M6IFsyXSwKICAgICAgICAgICAgICAgICAgICBoOiA0ODAsCiAgICAgICAgICAgICAgICAgICAgdzogNjQwLAogICAgICAgICAgICAgICAgICAgIHZpZGVvOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHBsYXliYWNrX21ldGhvZDogWyJhdXRvX3BsYXlfc291bmRfb24iLCAiYXV0b19wbGF5X3NvdW5kX29mZiIsICJhdXRvX3BsYXlfc291bmRfdW5rbm93biJdCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSksIHsKICAgICAgICAgICAgICAgICAgICB2aWRlbzogQihCKHt9LCBjLnZpZGVvKSwgewogICAgICAgICAgICAgICAgICAgICAgICBza2lwcGFibGU6ICEwCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGJpZGRlcjogImFwcG5leHVzIiwKICAgICAgICAgICAgICAgIHBhcmFtczogQihCKHsKICAgICAgICAgICAgICAgICAgICBwbGFjZW1lbnRJZDogMTMxODQzMDksCiAgICAgICAgICAgICAgICAgICAgbWF4ZHVyYXRpb246IDE1CiAgICAgICAgICAgICAgICB9LCBjKSwgewogICAgICAgICAgICAgICAgICAgIHZpZGVvOiBCKEIoe30sIGMudmlkZW8pLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNraXBwYWJsZTogITEsCiAgICAgICAgICAgICAgICAgICAgICAgIG1heGR1cmF0aW9uOiAxNQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBiaWRkZXI6ICJvcGVueCIsCiAgICAgICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICAgICAgICB1bml0OiAiNTQwMTA1MTk2IiwKICAgICAgICAgICAgICAgICAgICBkZWxEb21haW46ICJwb2tpLWQub3BlbngubmV0IiwKICAgICAgICAgICAgICAgICAgICBvcGVucnRiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGltcDogW3sKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZGVvOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWltZXM6IFtkLmpvaW4oIiwiKV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvdG9jb2xzOiBbMiwgMywgNSwgNiwgNywgOF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ZHVyYXRpb246IDE1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNraXA6IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcGFmdGVyOiA1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHc6IDY0MCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoOiA0ODAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfV0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGJpZGRlcjogIm9wZW54IiwKICAgICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgICAgIHVuaXQ6ICI1NDA3MTkwNjUiLAogICAgICAgICAgICAgICAgICAgIGRlbERvbWFpbjogInBva2ktZC5vcGVueC5uZXQiLAogICAgICAgICAgICAgICAgICAgIG9wZW5ydGI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgaW1wOiBbewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlkZW86IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW1lczogW2Quam9pbigiLCIpXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm90b2NvbHM6IFsyLCAzLCA1LCA2LCA3LCA4XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhkdXJhdGlvbjogMTUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2tpcDogMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3OiA2NDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaDogNDgwCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH1dCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBiaWRkZXI6ICJkaXN0cmljdG0iLAogICAgICAgICAgICAgICAgcGFyYW1zOiBCKEIoewogICAgICAgICAgICAgICAgICAgIHBsYWNlbWVudElkOiAxMjkwNjc4OSwKICAgICAgICAgICAgICAgICAgICBtYXhkdXJhdGlvbjogMTUKICAgICAgICAgICAgICAgIH0sIGMpLCB7CiAgICAgICAgICAgICAgICAgICAgdmlkZW86IEIoQih7fSwgYy52aWRlbyksIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2tpcHBhYmxlOiAhMSwKICAgICAgICAgICAgICAgICAgICAgICAgbWF4ZHVyYXRpb246IDE1CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGJpZGRlcjogInNwb3R4IiwKICAgICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgICAgIGNoYW5uZWxfaWQ6ICIyNjU1OTAiLAogICAgICAgICAgICAgICAgICAgIGFkX3VuaXQ6ICJpbnN0cmVhbSIsCiAgICAgICAgICAgICAgICAgICAgc2VjdXJlOiAhMCwKICAgICAgICAgICAgICAgICAgICBtaW1lczogZCwKICAgICAgICAgICAgICAgICAgICBoaWRlX3NraW46ICEwCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGJpZGRlcjogIml4IiwKICAgICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgICAgIHNpdGVJZDogIjQzNjI4NCIsCiAgICAgICAgICAgICAgICAgICAgc2l6ZTogWzY0MCwgNDgwXSwKICAgICAgICAgICAgICAgICAgICB2aWRlbzogewogICAgICAgICAgICAgICAgICAgICAgICBtaW1lczogZCwKICAgICAgICAgICAgICAgICAgICAgICAgcHJvdG9jb2xzOiBbMiwgMywgNSwgNiwgNywgOF0sCiAgICAgICAgICAgICAgICAgICAgICAgIG1pbmR1cmF0aW9uOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBtYXhkdXJhdGlvbjogMTUsCiAgICAgICAgICAgICAgICAgICAgICAgIGFwaTogWzEsIDJdCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBiaWRkZXI6ICJyaWNoYXVkaWVuY2UiLAogICAgICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgICAgICAgcGlkOiBJKHMpLAogICAgICAgICAgICAgICAgICAgIHN1cHBseVR5cGU6ICJzaXRlIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9XSwKICAgICAgICAgICAgbWVkaWFUeXBlczogewogICAgICAgICAgICAgICAgdmlkZW86IHsKICAgICAgICAgICAgICAgICAgICBjb250ZXh0OiAiaW5zdHJlYW0iLAogICAgICAgICAgICAgICAgICAgIHBsYXllclNpemU6IFs2NDAsIDQ4MF0sCiAgICAgICAgICAgICAgICAgICAgbWltZXM6IGQsCiAgICAgICAgICAgICAgICAgICAgcHJvdG9jb2xzOiBbMiwgMywgNSwgNiwgNywgOF0sCiAgICAgICAgICAgICAgICAgICAgbWF4ZHVyYXRpb246IDE1LAogICAgICAgICAgICAgICAgICAgIHNraXA6IDEsCiAgICAgICAgICAgICAgICAgICAgbGluZWFyaXR5OiAxLAogICAgICAgICAgICAgICAgICAgIGFwaTogWzJdCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KSwKICAgICAgICBMID0gW3sKICAgICAgICAgICAgY29kZTogInZpZGVvIiwKICAgICAgICAgICAgbWVkaWFUeXBlczogRC5tZWRpYVR5cGVzLAogICAgICAgICAgICBiaWRzOiBQKEQuYmlkcywgW3sKICAgICAgICAgICAgICAgIGJpZGRlcjogInJ1Ymljb24iLAogICAgICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgICAgICAgYWNjb3VudElkOiAiMTg2MDgiLAogICAgICAgICAgICAgICAgICAgIHNpdGVJZDogIjI2NjkxNCIsCiAgICAgICAgICAgICAgICAgICAgem9uZUlkOiAiMTMyMjAzNCIsCiAgICAgICAgICAgICAgICAgICAgdmlkZW86IHsKICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV9pZDogMjA0CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9XSkKICAgICAgICB9LCB7CiAgICAgICAgICAgIGNvZGU6ICJyZXdhcmRlZCIsCiAgICAgICAgICAgIG1lZGlhVHlwZXM6IEQubWVkaWFUeXBlcywKICAgICAgICAgICAgYmlkczogUChELmJpZHMsIFt7CiAgICAgICAgICAgICAgICBiaWRkZXI6ICJydWJpY29uIiwKICAgICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgICAgIGFjY291bnRJZDogIjE4NjA4IiwKICAgICAgICAgICAgICAgICAgICBzaXRlSWQ6ICIyNjY5MTYiLAogICAgICAgICAgICAgICAgICAgIHpvbmVJZDogIjEzMjIwNDgiLAogICAgICAgICAgICAgICAgICAgIHZpZGVvOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNpemVfaWQ6IDIwMgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfV0pCiAgICAgICAgfV0sCiAgICAgICAgTyA9IHsKICAgICAgICAgICAgRVVSOiB7CiAgICAgICAgICAgICAgICBFVVI6IDEsCiAgICAgICAgICAgICAgICBHQlA6IC44NTg1OTUsCiAgICAgICAgICAgICAgICBVU0Q6IDEuMTMxNTEKICAgICAgICAgICAgfSwKICAgICAgICAgICAgR0JQOiB7CiAgICAgICAgICAgICAgICBFVVI6IDEuMTY0NjkzNDgxNzkyOTI5LAogICAgICAgICAgICAgICAgR0JQOiAxLAogICAgICAgICAgICAgICAgVVNEOiAxLjMxNzg2MjMyMTU4MzUxNzIKICAgICAgICAgICAgfSwKICAgICAgICAgICAgVVNEOiB7CiAgICAgICAgICAgICAgICBFVVI6IC44ODM3NzQ3Nzg4MzUzNjE2LAogICAgICAgICAgICAgICAgR0JQOiAuNzU4ODA0NjA2MjM0MTQ3MiwKICAgICAgICAgICAgICAgIFVTRDogMQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBqID0gewogICAgICAgICAgICBkZWJ1ZzogITEsCiAgICAgICAgICAgIGVuYWJsZVNlbmRBbGxCaWRzOiAhMCwKICAgICAgICAgICAgdXNlUHJlYmlkQ2FjaGU6ICEwLAogICAgICAgICAgICBiaWRkZXJUaW1lb3V0OiAxNTAwLAogICAgICAgICAgICBwcmljZUdyYW51bGFyaXR5OiB7CiAgICAgICAgICAgICAgICBidWNrZXRzOiBbewogICAgICAgICAgICAgICAgICAgIHByZWNpc2lvbjogMiwKICAgICAgICAgICAgICAgICAgICBtaW46IC4wMSwKICAgICAgICAgICAgICAgICAgICBtYXg6IDMsCiAgICAgICAgICAgICAgICAgICAgaW5jcmVtZW50OiAuMDEKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICBwcmVjaXNpb246IDIsCiAgICAgICAgICAgICAgICAgICAgbWluOiAzLAogICAgICAgICAgICAgICAgICAgIG1heDogOCwKICAgICAgICAgICAgICAgICAgICBpbmNyZW1lbnQ6IC4wNQogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICAgIHByZWNpc2lvbjogMiwKICAgICAgICAgICAgICAgICAgICBtaW46IDgsCiAgICAgICAgICAgICAgICAgICAgbWF4OiAyMCwKICAgICAgICAgICAgICAgICAgICBpbmNyZW1lbnQ6IC41CiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgcHJlY2lzaW9uOiAyLAogICAgICAgICAgICAgICAgICAgIG1pbjogMjAsCiAgICAgICAgICAgICAgICAgICAgbWF4OiA0NSwKICAgICAgICAgICAgICAgICAgICBpbmNyZW1lbnQ6IDEKICAgICAgICAgICAgICAgIH1dCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGN1cnJlbmN5OiB7CiAgICAgICAgICAgICAgICBhZFNlcnZlckN1cnJlbmN5OiAiRVVSIiwKICAgICAgICAgICAgICAgIHJhdGVzOiBPLAogICAgICAgICAgICAgICAgZGVmYXVsdFJhdGVzOiBPLAogICAgICAgICAgICAgICAgYmlkZGVyQ3VycmVuY3lEZWZhdWx0OiB7CiAgICAgICAgICAgICAgICAgICAgb3Blbng6ICJFVVIiCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGNhY2hlOiB7CiAgICAgICAgICAgICAgICB1cmw6ICJodHRwczovL3ByZWJpZC5hZG54cy5jb20vcGJjL3YxL2NhY2hlIgogICAgICAgICAgICB9LAogICAgICAgICAgICB1c2VyU3luYzogewogICAgICAgICAgICAgICAgZmlsdGVyU2V0dGluZ3M6IHsKICAgICAgICAgICAgICAgICAgICBhbGw6IHsKICAgICAgICAgICAgICAgICAgICAgICAgYmlkZGVyczogIioiLAogICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6ICJpbmNsdWRlIgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBzeW5jc1BlckJpZGRlcjogMWUzLAogICAgICAgICAgICAgICAgc3luY0RlbGF5OiAxMDAsCiAgICAgICAgICAgICAgICB1c2VySWRzOiBbewogICAgICAgICAgICAgICAgICAgIG5hbWU6ICJwdWJDb21tb25JZCIsCiAgICAgICAgICAgICAgICAgICAgc3RvcmFnZTogewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiY29va2llIiwKICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogInBva2lfcHViY2lkIiwKICAgICAgICAgICAgICAgICAgICAgICAgZXhwaXJlczogMzY1CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfV0KICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgUiA9ICExLAogICAgICAgIE0gPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgISBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIGlmICghd2luZG93Ll9fdGNmYXBpKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSB7fTsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cuX190Y2ZhcGkgPSBmdW5jdGlvbihuLCBlLCBpLCByKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgha3QuR2V0SXNQb2tpSUZyYW1lKCkgJiYgIV8oKSkgcmV0dXJuIGkoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnOiAiQ01QIG5vdCBmb3VuZCIKICAgICAgICAgICAgICAgICAgICAgICAgfSwgITEpLCB2b2lkIGNvbnNvbGUuZXJyb3IoIkEgVENGdjIgY29tcGxpYW50IENNUCBzaG91bGQgYmUgYWRkZWQgdG8gdGhpcyBnYW1lIik7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvID0gTWF0aC5yYW5kb20oKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX190Y2ZhcGlDYWxsOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmQ6IG4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlcjogciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbElkOiBvCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgdFtvXSA9IGksIHdpbmRvdy5wYXJlbnQucG9zdE1lc3NhZ2UoYSwgIioiKQogICAgICAgICAgICAgICAgICAgIH0sIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJtZXNzYWdlIiwgKGZ1bmN0aW9uKG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB7fTsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSAic3RyaW5nIiA9PSB0eXBlb2Ygbi5kYXRhID8gSlNPTi5wYXJzZShuLmRhdGEpIDogbi5kYXRhCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHt9CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpID0gZS5fX3RjZmFwaVJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgaSAmJiAiZnVuY3Rpb24iID09IHR5cGVvZiB0W2kuY2FsbElkXSAmJiAodFtpLmNhbGxJZF0oaS5yZXR1cm5WYWx1ZSwgaS5zdWNjZXNzKSwgdFtpLmNhbGxJZF0gPSBudWxsKQogICAgICAgICAgICAgICAgICAgIH0pLCAhMSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSgpLCB3aW5kb3cucGJqcy5xdWUucHVzaCgoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB3aW5kb3cucGJqcy5zZXRDb25maWcoewogICAgICAgICAgICAgICAgICAgIGNvbnNlbnRNYW5hZ2VtZW50OiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGdkcHI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNtcEFwaTogImlhYiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lb3V0OiA4ZTMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0R2RwclNjb3BlOiAhMAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSkpCiAgICAgICAgfTsKCiAgICBmdW5jdGlvbiBaKHQpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICB2YXIgbiA9IHdpbmRvdy5wYmpzLmdldEJpZFJlc3BvbnNlc0ZvckFkVW5pdENvZGUodCkuYmlkczsKICAgICAgICAgICAgd2luZG93LnBva2lBdWN0aW9uc1NlZW4gfHwgKHdpbmRvdy5wb2tpQXVjdGlvbnNTZWVuID0ge30pLCB3aW5kb3cucG9raUF1Y3Rpb25zU2Vlblt0XSB8fCAod2luZG93LnBva2lBdWN0aW9uc1NlZW5bdF0gPSB7fSk7CiAgICAgICAgICAgIHZhciBlID0gMDsKICAgICAgICAgICAgaWYgKG4pIHsKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbi5sZW5ndGg7IGkrKykKICAgICAgICAgICAgICAgICAgICBpZiAoIXdpbmRvdy5wb2tpQXVjdGlvbnNTZWVuW3RdW25baV0uYXVjdGlvbklkXSkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgciA9IG5baV0uY3BtOwogICAgICAgICAgICAgICAgICAgICAgICByICYmIHIgPiBlICYmIChlID0gcikKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbi5sZW5ndGg7IGkrKykgd2luZG93LnBva2lBdWN0aW9uc1NlZW5bdF1bbltpXS5hdWN0aW9uSWRdID0gITAKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gZQogICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcih0KQogICAgICAgIH0KICAgICAgICByZXR1cm4gMAogICAgfQogICAgdmFyIEcgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgZnVuY3Rpb24gdCh0LCBuKSB7CiAgICAgICAgICAgICAgICB2b2lkIDAgPT09IG4gJiYgKG4gPSB7fSksIHRoaXMucmV0cmllcyA9IDAsIHRoaXMucnVubmluZyA9ICExLCB0aGlzLmltYSA9IHQsIHRoaXMuc2l0ZUlEID0gbi5zaXRlSUQgfHwgMywgMCA9PT0gbi5zaXRlSUQgJiYgKG4uc2l0ZUlEID0gMyksIHRoaXMudG90YWxSZXRyaWVzID0gbi50b3RhbFJldHJpZXMgfHwgdi53YXRlcmZhbGxSZXRyaWVzIHx8IDEsIHRoaXMudGltaW5nID0gbi50aW1pbmcgfHwgbmV3IGsodi5hZFRpbWluZyksIHRoaXMub3ZlcndyaXRlQWRUYWdVcmxzID0gbi5hZFRhZ1VybCA/IGIobi5hZFRhZ1VybCkgOiBbXSwgZi5hZGRFdmVudExpc3RlbmVyKEEuYWRzLnZpZGVvLmVycm9yLCB0aGlzLm1vdmVUaHJvdWdoV2F0ZXJmYWxsLmJpbmQodGhpcykpLCBmLmFkZEV2ZW50TGlzdGVuZXIoQS5hZHMudmlkZW8ubG9hZGVyRXJyb3IsIHRoaXMubW92ZVRocm91Z2hXYXRlcmZhbGwuYmluZCh0aGlzKSksIGYuYWRkRXZlbnRMaXN0ZW5lcihBLmFkcy5yZWFkeSwgdGhpcy50aW1pbmcuc3RvcFdhdGVyZmFsbFRpbWVyLmJpbmQodGhpcy50aW1pbmcpKSwgZi5hZGRFdmVudExpc3RlbmVyKEEuYWRzLnN0YXJ0ZWQsIHRoaXMuc3RvcFdhdGVyZmFsbC5iaW5kKHRoaXMpKQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0LnByb3RvdHlwZS5tb3ZlVGhyb3VnaFdhdGVyZmFsbCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgaWYgKCExICE9PSB0aGlzLnJ1bm5pbmcpIHsKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50aW1pbmcuc3RvcFdhdGVyZmFsbFRpbWVyKCksIHRoaXMucmV0cmllcyA8IHRoaXMudG90YWxSZXRyaWVzKSByZXR1cm4gdGhpcy50aW1pbmcubmV4dFdhdGVyZmFsbFRpbWVyKCksIHZvaWQgdGhpcy5yZXF1ZXN0QWQoKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnJ1bm5pbmcgPSAhMSwgdGhpcy50aW1pbmcucmVzZXRXYXRlcmZhbGxUaW1lcklkeCgpLCBmLmRpc3BhdGNoRXZlbnQoQS5hZHMuZXJyb3IsIHsKICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIk5vIGFkcyIKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5jdXRPZmZXYXRlcmZhbGwgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHRoaXMuaW1hLnRlYXJEb3duKCksIHRoaXMubW92ZVRocm91Z2hXYXRlcmZhbGwoKQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5idWlsZEFkVGFnVXJscyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHZhciBuID0gIiZjaXVfc3pzJmltcGw9cyZnZGZwX3JlcT0xJmVudj12cCZvdXRwdXQ9dmFzdCZ1bnZpZXdlZF9wb3NpdGlvbl9zdGFydD0xJnVybD17dXJsfSZkZXNjcmlwdGlvbl91cmw9e2Rlc2NyaXB0aW9uVXJsfSZjb3JyZWxhdG9yPXt0aW1lc3RhbXB9IjsKICAgICAgICAgICAgICAgIGlmICh0aGlzLmRlYnVnKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSAiaHR0cHM6Ly9zZWN1cmVwdWJhZHMuZy5kb3VibGVjbGljay5uZXQvZ2FtcGFkL2Fkcz9zej02NDB4MzYwfDY0MHg0ODAmaXU9LzIxNjgyMTk4NjA3L2RlYnVnLXZpZGVvLyI7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQgPT09IEEuYWRzLnBvc2l0aW9uLnJld2FyZGVkID8gW2UgKyAiZGVidWctdmlkZW8tcmV3YXJkZWQiICsgbl0gOiB0ID09PSBBLmFkcy5wb3NpdGlvbi5wcmVyb2xsID8gW2UgKyAiZGVidWctdmlkZW8tcHJlcm9sbCIgKyBuXSA6IFtlICsgImRlYnVnLXZpZGVvLW1pZHJvbGwiICsgbl0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICh0aGlzLm92ZXJ3cml0ZUFkVGFnVXJscy5sZW5ndGggPiAwICYmIGt0LkdldElzUG9raVBsYXRmb3JtKCkpIHJldHVybiB0aGlzLm92ZXJ3cml0ZUFkVGFnVXJsczsKICAgICAgICAgICAgICAgIHZhciBpID0gImRlc2t0b3AiLAogICAgICAgICAgICAgICAgICAgIHIgPSAibWlkcm9sbCI7CiAgICAgICAgICAgICAgICBFKCkgPyBpID0gIm1vYmlsZSIgOiB4KCkgJiYgKGkgPSAidGFibGV0IiksIHQgPT09IEEuYWRzLnBvc2l0aW9uLnJld2FyZGVkICYmIChyID0gInJld2FyZGVkIik7CiAgICAgICAgICAgICAgICB2YXIgbyA9ICJodHRwczovL3NlY3VyZXB1YmFkcy5nLmRvdWJsZWNsaWNrLm5ldC9nYW1wYWQvYWRzP3N6PTY0MHgzNjB8NjQweDQ4MCZpdT0vMjE2ODIxOTg2MDcvIjsKICAgICAgICAgICAgICAgIHJldHVybiBrdC5HZXRJc1Bva2lJRnJhbWUoKSA/IFsiIiArIG8gKyBpICsgIl9pbmdhbWVfIiArIHIgKyAiXzEvIiArIHRoaXMuc2l0ZUlEICsgIl8iICsgaSArICJfaW5nYW1lXyIgKyByICsgIl8xIiArIG4sICIiICsgbyArIGkgKyAiX2luZ2FtZV8iICsgciArICJfMi8iICsgdGhpcy5zaXRlSUQgKyAiXyIgKyBpICsgIl9pbmdhbWVfIiArIHIgKyAiXzIiICsgbl0gOiBbbyArICJleHRlcm5hbF8iICsgaSArICJfdmlkZW9fMS9leHRlcm5hbF8iICsgaSArICJfaW5nYW1lXyIgKyByICsgIl8xIiArIG4sIG8gKyAiZXh0ZXJuYWxfIiArIGkgKyAiX3ZpZGVvXzIvZXh0ZXJuYWxfIiArIGkgKyAiX2luZ2FtZV8iICsgciArICJfMiIgKyBuXQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgICAgIHZvaWQgMCA9PT0gdCAmJiAodCA9IHt9KSwgdGhpcy5ydW5uaW5nID0gITAsIHRoaXMucmV0cmllcyA9IDAsIHRoaXMuY3JpdGVyaWEgPSB0LCB0aGlzLnRpbWluZy5yZXNldFdhdGVyZmFsbFRpbWVySWR4KCksIHRoaXMucmV3YXJkZWQgPSBuID09PSBBLmFkcy5wb3NpdGlvbi5yZXdhcmRlZCwgdGhpcy5hZFRhZ1VybHMgPSB0aGlzLmJ1aWxkQWRUYWdVcmxzKG4pLCB0aGlzLnJlcXVlc3RBZCgpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLnJlcXVlc3RBZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdGhpcy50aW1pbmcuc3RhcnRXYXRlcmZhbGxUaW1lcih0aGlzLmN1dE9mZldhdGVyZmFsbC5iaW5kKHRoaXMpKSwgdGhpcy5yZXRyaWVzKyssIGt0LkdldElzUG9raVBsYXRmb3JtKCkgfHwgKHRoaXMuY3JpdGVyaWEud2F0ZXJmYWxsID0gdGhpcy5yZXRyaWVzKTsKICAgICAgICAgICAgICAgIHZhciB0ID0gKHRoaXMucmV0cmllcyAtIDEpICUgdGhpcy5hZFRhZ1VybHMubGVuZ3RoLAogICAgICAgICAgICAgICAgICAgIG4gPSB0aGlzLmFkVGFnVXJsc1t0XTsKICAgICAgICAgICAgICAgIGt0LmNvbnNlbnRTdHJpbmcgJiYga3QuY29uc2VudFN0cmluZy5sZW5ndGggPiAwICYmICh0aGlzLmNyaXRlcmlhLmNvbnNlbnRfc3RyaW5nID0ga3QuY29uc2VudFN0cmluZyk7CiAgICAgICAgICAgICAgICB2YXIgZSwgaSwgciA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IFMoKS5zcGxpdCgiPyIpLAogICAgICAgICAgICAgICAgICAgICAgICBlID0gZW5jb2RlVVJJQ29tcG9uZW50KG5bMF0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0ID0gKHQgPSB0LnNwbGl0KCJ7ZGVzY3JpcHRpb25Vcmx9Iikuam9pbihlKSkuc3BsaXQoInt0aW1lc3RhbXB9Iikuam9pbigobmV3IERhdGUpLmdldFRpbWUoKS50b1N0cmluZygpKQogICAgICAgICAgICAgICAgfShuKSArIChlID0gdGhpcy5jcml0ZXJpYSwgaSA9ICIiLCBPYmplY3Qua2V5cyhlKS5mb3JFYWNoKChmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLCB0KSkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IGVbdF07CiAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LmlzQXJyYXkobikgJiYgKG4gPSBuLmpvaW4oKSksIGkgKz0gdCArICI9IiArIG4gKyAiJiIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KSksICImY3VzdF9wYXJhbXM9IiArIChpID0gZW5jb2RlVVJJQ29tcG9uZW50KGkpKSArICImIik7CiAgICAgICAgICAgICAgICBrdC5jaGlsZERpcmVjdGVkICYmIChyICs9ICImdGZjZD0xIiksIGt0Lm5vblBlcnNvbmFsaXplZCAmJiAociArPSAiJm5wYT0xIiksIGYuc2V0RGF0YUFubm90YXRpb25zKHsKICAgICAgICAgICAgICAgICAgICBhZFRhZ1VybDogciwKICAgICAgICAgICAgICAgICAgICB3YXRlcmZhbGw6IHRoaXMucmV0cmllcwogICAgICAgICAgICAgICAgfSksIGYuZGlzcGF0Y2hFdmVudChBLmFkcy5yZXF1ZXN0ZWQpLCAxICE9PSB0aGlzLnJldHJpZXMgfHwgRSgpIHx8IHgoKSA/IChjb25zb2xlLmRlYnVnKCJhZFJlcXVlc3Qgc3RhcnRlZCBpbiBwbGFpbiBtb2RlIiksIHRoaXMuaW1hLnJlcXVlc3RBZChyKSkgOiAoY29uc29sZS5kZWJ1ZygiYWRSZXF1ZXN0IHN0YXJ0ZWQgd2l0aCBQcmViaWQgVmlkZW8gZW5hYmxlZCIpLCBmdW5jdGlvbih0LCBuLCBlLCBpKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5wYmpzICYmIHdpbmRvdy5wYmpzLnF1ZSAmJiB3aW5kb3cucGJqcy5nZXRDb25maWcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHIsIG8gPSBTKCkuc3BsaXQoIj8iKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBlbmNvZGVVUklDb21wb25lbnQob1swXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzID0gaSA/ICJyZXdhcmRlZCIgOiAidmlkZW8iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEoLS1kID4gMCkpIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYuZGlzcGF0Y2hFdmVudChBLmFkcy5wcmViaWRSZXF1ZXN0ZWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IHdpbmRvdy5wYmpzLmFkVW5pdHMuZmlsdGVyKChmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5jb2RlID09PSBzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKVswXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCJ1bmRlZmluZWQiID09PSBpKSByZXR1cm4gY29uc29sZS5lcnJvcigiVmlkZW8tYWQtdW5pdCBub3QgZm91bmQsIGRpZCB5b3UgZ2l2ZSBpdCB0aGUgYWR1bml0LmNvZGU9J3ZpZGVvJyB2YWx1ZT8iKSwgdm9pZCB0LnJlcXVlc3RBZChuKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSB3aW5kb3cucGJqcy5hZFNlcnZlcnMuZGZwLmJ1aWxkVmlkZW9VcmwoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRVbml0OiBpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXU6IFQoIml1IiwgbiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3o6ICI2NDB4MzYwfDY0MHg0ODAiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dDogInZhc3QiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RfcGFyYW1zOiBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uX3VybDogYQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LnBianMubWFya1dpbm5pbmdCaWRBc1VzZWQoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRVbml0Q29kZTogcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgciAmJiAobyA9IG8ucmVwbGFjZSgiY3VzdF9wYXJhbXM9IiwgImN1c3RfcGFyYW1zPSIgKyByICsgIiUyNiIpKSwgdC5yZXF1ZXN0QWQobykKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQucmVxdWVzdEFkKG4pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgUiAmJiAoZCsrLCB3aW5kb3cuYXBzdGFnLmZldGNoQmlkcyh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbG90czogW3sKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbG90SUQ6IGkgPyAiUmV3YXJkZWQiIDogIk1pZHJvbGwiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lZGlhVHlwZTogInZpZGVvIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lb3V0OiBqLmJpZGRlclRpbWVvdXQKICAgICAgICAgICAgICAgICAgICAgICAgfSwgKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQubGVuZ3RoID4gMCAmJiAociA9IHRbMF0uZW5jb2RlZFFzUGFyYW1zKSwgYygpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pKSksIHdpbmRvdy5wYmpzLnF1ZS5wdXNoKChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5wYmpzLnJlcXVlc3RCaWRzKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZFVuaXRDb2RlczogW3NdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpZHNCYWNrSGFuZGxlcjogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMoKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB0LnJlcXVlc3RBZChuKQogICAgICAgICAgICAgICAgfSh0aGlzLmltYSwgciwgdGhpcy5jcml0ZXJpYSwgdGhpcy5yZXdhcmRlZCkpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLmlzUnVubmluZyA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucnVubmluZwogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5zdG9wV2F0ZXJmYWxsID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB0aGlzLnJ1bm5pbmcgPSAhMSwgdGhpcy50aW1pbmcuc3RvcFdhdGVyZmFsbFRpbWVyKCksIHRoaXMudGltaW5nLnJlc2V0V2F0ZXJmYWxsVGltZXJJZHgoKQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5zZXREZWJ1ZyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHRoaXMuZGVidWcgPSB0CiAgICAgICAgICAgIH0sIHQKICAgICAgICB9KCksCiAgICAgICAgTiA9ICJwb2tpU2RrUGF1c2VCdXR0b24iLAogICAgICAgIEYgPSAicG9raVNka1Byb2dyZXNzQmFyIiwKICAgICAgICBYID0gInBva2lTZGtTcGlubmVyQ29udGFpbmVyIiwKICAgICAgICBVID0gInBva2lTZGtWaXNpYmxlIiwKICAgICAgICBRID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGZ1bmN0aW9uIHQodCkgewogICAgICAgICAgICAgICAgdmFyIG4gPSB0aGlzOwogICAgICAgICAgICAgICAgaWYgKHRoaXMuaGlkZUVsZW1lbnQgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHQuY2xhc3NMaXN0LmFkZCgicG9raVNka0hpZGRlbiIpLCB0LmNsYXNzTGlzdC5yZW1vdmUoVSkKICAgICAgICAgICAgICAgICAgICB9LCB0aGlzLnNob3dFbGVtZW50ID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICB0LmNsYXNzTGlzdC5hZGQoVSksIHQuY2xhc3NMaXN0LnJlbW92ZSgicG9raVNka0hpZGRlbiIpCiAgICAgICAgICAgICAgICAgICAgfSwgdGhpcy53cmFwcGVyID0gdC53cmFwcGVyLCBmLmFkZEV2ZW50TGlzdGVuZXIoQS5hZHMudmlkZW8ucHJvZ3Jlc3MsIChmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlID0gdC5jdXJyZW50VGltZSAvIHQuZHVyYXRpb24gKiAxMDA7CiAgICAgICAgICAgICAgICAgICAgICAgIGUgPCAxMDAgJiYgKG4ucHJvZ3Jlc3NCYXIuc3R5bGUud2lkdGggPSBlICsgIiUiKQogICAgICAgICAgICAgICAgICAgIH0pKSwgdGhpcy53cmFwcGVyIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgfHwgKGNvbnNvbGUuZXJyb3IoIlBPS0ktU0RLOiB3cmFwcGVyIGlzIG5vdCBhIEhUTUxFbGVtZW50LCBmYWxsaW5nIGJhY2sgdG8gZG9jdW1lbnQuYm9keSIpLCB0aGlzLndyYXBwZXIgPSBkb2N1bWVudC5ib2R5KSwgdGhpcy5jcmVhdGVFbGVtZW50cygpLCAidW5kZWZpbmVkIiAhPSB0eXBlb2Ygd2luZG93ICYmIGRvY3VtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzdHlsZSIpOwogICAgICAgICAgICAgICAgICAgIGUuaW5uZXJIVE1MID0gIlxuQGZvbnQtZmFjZSB7XG5cdGZvbnQtZGlzcGxheTogc3dhcDtcblx0Zm9udC1mYW1pbHk6ICdQcm94aW1hIE5vdmEnO1xuXHRmb250LXdlaWdodDogNzAwO1xuXHRzcmM6IHVybChodHRwczovL2EucG9raS5jb20vZm9udHMvcHJveGltYS1ub3ZhLWJvbGQtbGF0aW4ud29mZjIpIGZvcm1hdCgnd29mZjInKSwgdXJsKGh0dHBzOi8vYS5wb2tpLmNvbS9mb250cy9wcm94aW1hLW5vdmEtYm9sZC1sYXRpbi53b2ZmKSBmb3JtYXQoJ3dvZmYnKTtcblx0dW5pY29kZS1yYW5nZTogVSswMDIwLTAwN0YsIFUrMDBBMC0wMEZGXG59XG5cbkBmb250LWZhY2Uge1xuXHRmb250LWRpc3BsYXk6IHN3YXA7XG5cdGZvbnQtZmFtaWx5OiAnUHJveGltYSBOb3ZhJztcblx0Zm9udC13ZWlnaHQ6IDcwMDtcblx0c3JjOiB1cmwoaHR0cHM6Ly9hLnBva2kuY29tL2ZvbnRzL3Byb3hpbWEtbm92YS1ib2xkLWxhdGluLWV4dC1hLndvZmYyKSBmb3JtYXQoJ3dvZmYyJyksIHVybChodHRwczovL2EucG9raS5jb20vZm9udHMvcHJveGltYS1ub3ZhLWJvbGQtbGF0aW4tZXh0LWEud29mZikgZm9ybWF0KCd3b2ZmJyk7XG5cdHVuaWNvZGUtcmFuZ2U6IFUrMDEwMC0wMTdGXG59XG5cbkBmb250LWZhY2Uge1xuXHRmb250LWRpc3BsYXk6IHN3YXA7XG5cdGZvbnQtZmFtaWx5OiAnUHJveGltYSBOb3ZhJztcblx0Zm9udC13ZWlnaHQ6IDcwMDtcblx0c3JjOiB1cmwoaHR0cHM6Ly9hLnBva2kuY29tL2ZvbnRzL3Byb3hpbWEtbm92YS1ib2xkLWxhdGluLWV4dC1iLndvZmYyKSBmb3JtYXQoJ3dvZmYyJyksIHVybChodHRwczovL2EucG9raS5jb20vZm9udHMvcHJveGltYS1ub3ZhLWJvbGQtbGF0aW4tZXh0LWIud29mZikgZm9ybWF0KCd3b2ZmJyk7XG5cdHVuaWNvZGUtcmFuZ2U6IFUrMDE4MC0wMjRGXG59XG5cbi5wb2tpU2RrQ29udGFpbmVyIHtcblx0b3ZlcmZsb3c6IGhpZGRlbjtcblx0cG9zaXRpb246IGFic29sdXRlO1xuXHRsZWZ0OiAwO1xuXHR0b3A6IDA7XG5cdHdpZHRoOiAxMDAlO1xuXHRoZWlnaHQ6IDEwMCU7XG5cdHotaW5kZXg6IDEwMDA7XG5cdGRpc3BsYXk6IGZsZXg7XG5cdGFsaWduLWl0ZW1zOiBjZW50ZXI7XG5cdGp1c3RpZnktY29udGVudDogY2VudGVyO1xufVxuXG4ucG9raVNka0NvbnRhaW5lci5wb2tpU2RrRml4ZWQge1xuXHRwb3NpdGlvbjogZml4ZWQ7XG59XG5cbi5wb2tpU2RrQ29udGFpbmVyLnBva2lTZGtWaXNpYmxlIHtcblx0ZGlzcGxheTogYmxvY2s7XG59XG5cbi5wb2tpU2RrQ29udGFpbmVyLnBva2lTZGtIaWRkZW4sIC5wb2tpU2RrU3Bpbm5lckNvbnRhaW5lci5wb2tpU2RrSGlkZGVuIHtcblx0ZGlzcGxheTogbm9uZTtcbn1cblxuLnBva2lTZGtDb250YWluZXIucG9raVNka0hpZGRlbiwgLnBva2lTZGtTcGlubmVyQ29udGFpbmVyLCAucG9raVNka1NwaW5uZXJDb250YWluZXIgZGl2LCAucG9raVNka1NwaW5uZXJDb250YWluZXIgaW1nIHtcblx0cG9pbnRlci1ldmVudHM6IG5vbmU7XG59XG5cbi5wb2tpU2RrSW5zaWRlQ29udGFpbmVyIHtcblx0YmFja2dyb3VuZDogIzAwMDtcblx0cG9zaXRpb246IHJlbGF0aXZlO1xuXHR6LWluZGV4OiAxO1xuXHR3aWR0aDogMTAwJTtcblx0aGVpZ2h0OiAxMDAlO1xuXHRkaXNwbGF5OiBmbGV4O1xuXHRmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuXG5cdG9wYWNpdHk6IDA7XG5cdC13ZWJraXQtdHJhbnNpdGlvbjogb3BhY2l0eSAwLjVzIGVhc2UtaW4tb3V0O1xuXHQtbW96LXRyYW5zaXRpb246IG9wYWNpdHkgMC41cyBlYXNlLWluLW91dDtcblx0LW1zLXRyYW5zaXRpb246IG9wYWNpdHkgMC41cyBlYXNlLWluLW91dDtcblx0LW8tdHJhbnNpdGlvbjogb3BhY2l0eSAwLjVzIGVhc2UtaW4tb3V0O1xuXHR0cmFuc2l0aW9uOiBvcGFjaXR5IDAuNXMgZWFzZS1pbi1vdXQ7XG59XG5cbi5wb2tpU2RrQ29udGFpbmVyLnBva2lTZGtWaXNpYmxlIC5wb2tpU2RrSW5zaWRlQ29udGFpbmVyIHtcblx0b3BhY2l0eTogMTtcbn1cblxuLnBva2lTREtBZENvbnRhaW5lciwgLnBva2lTZGtWaWRlb0NvbnRhaW5lciB7XG5cdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0d2lkdGg6IDEwMCU7XG5cdGhlaWdodDogMTAwJTtcbn1cblxuLnBva2lTZGtTdGFydEFkQnV0dG9uLCAucG9raVNka1BhdXNlQnV0dG9uIHtcblx0cG9zaXRpb246IGFic29sdXRlO1xuXHR6LWluZGV4OiA5OTk5O1xuXHR0b3A6IDA7XG5cblx0cGFkZGluZy10b3A6IDEwJTtcblx0d2lkdGg6IDEwMCU7XG5cdGhlaWdodDogMTAwJTtcblx0dGV4dC1hbGlnbjogY2VudGVyO1xuXHRjb2xvcjogI0ZGRjtcblxuXHRmb250OiA3MDAgMTZwdCAnUHJveGltYSBOb3ZhJywgc2Fucy1zZXJpZjtcblx0Zm9udC13ZWlnaHQ6IGJvbGQ7XG5cdGxldHRlci1zcGFjaW5nOiAxcHg7XG5cdHRyYW5zaXRpb246IDAuMXMgZWFzZS1pbi1vdXQ7XG5cdGxpbmUtaGVpZ2h0OiAxZW07XG59XG5cbi5wb2tpU2RrUHJvZ3Jlc3NDb250YWluZXIge1xuXHRiYWNrZ3JvdW5kOiAjMDAyQjUwO1xuXHR3aWR0aDogMTAwJTtcblx0aGVpZ2h0OiA1cHg7XG5cdHBvc2l0aW9uOiBhYnNvbHV0ZTtcblx0Ym90dG9tOiAwO1xuXHR6LWluZGV4OiA5OTk5O1xufVxuXG4ucG9raVNka1Byb2dyZXNzQmFyIHtcblx0cG9zaXRpb246cmVsYXRpdmU7XG5cdGJvdHRvbTowcHg7XG5cdGJhY2tncm91bmQ6ICMwMDlDRkY7XG5cdGhlaWdodDogMTAwJTtcblx0d2lkdGg6IDAlO1xuXHR0cmFuc2l0aW9uOiB3aWR0aCAwLjVzO1xuXHR0cmFuc2l0aW9uLXRpbWluZy1mdW5jdGlvbjogbGluZWFyO1xufVxuXG4ucG9raVNka1Byb2dyZXNzQmFyLnBva2lTZGtWaXNpYmxlLCAucG9raVNka1BhdXNlQnV0dG9uLnBva2lTZGtWaXNpYmxlLCAucG9raVNka1N0YXJ0QWRCdXR0b24ucG9raVNka1Zpc2libGUge1xuXHRkaXNwbGF5OiBibG9jaztcblx0cG9pbnRlci1ldmVudHM6IGF1dG87XG59XG5cbi5wb2tpU2RrUHJvZ3Jlc3NCYXIucG9raVNka0hpZGRlbiwgLnBva2lTZGtQYXVzZUJ1dHRvbi5wb2tpU2RrSGlkZGVuLCAucG9raVNka1N0YXJ0QWRCdXR0b24ucG9raVNka0hpZGRlbiB7XG5cdGRpc3BsYXk6IG5vbmU7XG5cdHBvaW50ZXItZXZlbnRzOiBub25lO1xufVxuXG5cbkBrZXlmcmFtZXMgZ3dkLWdlbi1ubzAyZ3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXN7MCV7b3BhY2l0eTowO3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZDstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9MjUle3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZDstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9MzUle29wYWNpdHk6MTt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZDstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmQ7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTQwJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApO2FuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXI7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn0xMDAle29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXI7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcjstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyfX1ALXdlYmtpdC1rZXlmcmFtZXMgZ3dkLWdlbi1ubzAyZ3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXN7MCV7b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9MjUley13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9MzUle29wYWNpdHk6MTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTQwJXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXJ9MTAwJXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXJ9fUAtbW96LWtleWZyYW1lcyBnd2QtZ2VuLW5vMDJnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lc3swJXtvcGFjaXR5OjA7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH0yNSV7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH0zNSV7b3BhY2l0eToxOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9NDAle29wYWNpdHk6MDstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn0xMDAle29wYWNpdHk6MDstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn19W2RhdGEtZ3dkLWdyb3VwPVNwaW5uZXJHcm91cF0gLmd3ZC1nZW4tbm8wMmd3ZGFuaW1hdGlvbnthbmltYXRpb246Z3dkLWdlbi1ubzAyZ3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXMgMnMgbGluZWFyIDBzIGluZmluaXRlIG5vcm1hbCBmb3J3YXJkczstd2Via2l0LWFuaW1hdGlvbjpnd2QtZ2VuLW5vMDJnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lcyAycyBsaW5lYXIgMHMgaW5maW5pdGUgbm9ybWFsIGZvcndhcmRzOy1tb3otYW5pbWF0aW9uOmd3ZC1nZW4tbm8wMmd3ZGFuaW1hdGlvbl9nd2Qta2V5ZnJhbWVzIDJzIGxpbmVhciAwcyBpbmZpbml0ZSBub3JtYWwgZm9yd2FyZHN9QGtleWZyYW1lcyBnd2QtZ2VuLTRwdnJnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lc3swJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApO2FuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmQ7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH0yNSV7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApO2FuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmQ7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH00MCV7b3BhY2l0eToxO3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZDstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9NDUle29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXI7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcjstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyfTEwMCV7b3BhY2l0eTowO3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcjstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXJ9fUAtd2Via2l0LWtleWZyYW1lcyBnd2QtZ2VuLTRwdnJnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lc3swJXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH0yNSV7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH00MCV7b3BhY2l0eToxOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9NDUle29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn0xMDAle29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn19QC1tb3ota2V5ZnJhbWVzIGd3ZC1nZW4tNHB2cmd3ZGFuaW1hdGlvbl9nd2Qta2V5ZnJhbWVzezAle29wYWNpdHk6MDstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTI1JXstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTQwJXtvcGFjaXR5OjE7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH00NSV7b3BhY2l0eTowOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyfTEwMCV7b3BhY2l0eTowOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyfX1bZGF0YS1nd2QtZ3JvdXA9U3Bpbm5lckdyb3VwXSAuZ3dkLWdlbi00cHZyZ3dkYW5pbWF0aW9ue2FuaW1hdGlvbjpnd2QtZ2VuLTRwdnJnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lcyAycyBsaW5lYXIgMHMgaW5maW5pdGUgbm9ybWFsIGZvcndhcmRzOy13ZWJraXQtYW5pbWF0aW9uOmd3ZC1nZW4tNHB2cmd3ZGFuaW1hdGlvbl9nd2Qta2V5ZnJhbWVzIDJzIGxpbmVhciAwcyBpbmZpbml0ZSBub3JtYWwgZm9yd2FyZHM7LW1vei1hbmltYXRpb246Z3dkLWdlbi00cHZyZ3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXMgMnMgbGluZWFyIDBzIGluZmluaXRlIG5vcm1hbCBmb3J3YXJkc31Aa2V5ZnJhbWVzIGd3ZC1nZW4ta3c0MGd3ZGFuaW1hdGlvbl9nd2Qta2V5ZnJhbWVzezAle29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZDstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmQ7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTI1JXt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZDstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmQ7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTQ1JXtvcGFjaXR5OjE7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApO2FuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmQ7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH01MCV7b3BhY2l0eTowO3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcjstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXJ9MTAwJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApO2FuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXI7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn19QC13ZWJraXQta2V5ZnJhbWVzIGd3ZC1nZW4ta3c0MGd3ZGFuaW1hdGlvbl9nd2Qta2V5ZnJhbWVzezAle29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTI1JXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTQ1JXtvcGFjaXR5OjE7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH01MCV7b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyfTEwMCV7b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyfX1ALW1vei1rZXlmcmFtZXMgZ3dkLWdlbi1rdzQwZ3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXN7MCV7b3BhY2l0eTowOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9MjUley1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9NDUle29wYWNpdHk6MTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTUwJXtvcGFjaXR5OjA7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXJ9MTAwJXtvcGFjaXR5OjA7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXJ9fVtkYXRhLWd3ZC1ncm91cD1TcGlubmVyR3JvdXBdIC5nd2QtZ2VuLWt3NDBnd2RhbmltYXRpb257YW5pbWF0aW9uOmd3ZC1nZW4ta3c0MGd3ZGFuaW1hdGlvbl9nd2Qta2V5ZnJhbWVzIDJzIGxpbmVhciAwcyBpbmZpbml0ZSBub3JtYWwgZm9yd2FyZHM7LXdlYmtpdC1hbmltYXRpb246Z3dkLWdlbi1rdzQwZ3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXMgMnMgbGluZWFyIDBzIGluZmluaXRlIG5vcm1hbCBmb3J3YXJkczstbW96LWFuaW1hdGlvbjpnd2QtZ2VuLWt3NDBnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lcyAycyBsaW5lYXIgMHMgaW5maW5pdGUgbm9ybWFsIGZvcndhcmRzfUBrZXlmcmFtZXMgZ3dkLWdlbi0ydXY4Z3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXN7MCV7b3BhY2l0eTowO3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZDstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9MjUle3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZDstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9NTAle29wYWNpdHk6MTt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZDstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmQ7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTU1JXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApO2FuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXI7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn0xMDAle29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXI7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcjstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyfX1ALXdlYmtpdC1rZXlmcmFtZXMgZ3dkLWdlbi0ydXY4Z3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXN7MCV7b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9MjUley13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9NTAle29wYWNpdHk6MTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTU1JXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXJ9MTAwJXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXJ9fUAtbW96LWtleWZyYW1lcyBnd2QtZ2VuLTJ1djhnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lc3swJXtvcGFjaXR5OjA7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH0yNSV7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH01MCV7b3BhY2l0eToxOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9NTUle29wYWNpdHk6MDstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn0xMDAle29wYWNpdHk6MDstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn19W2RhdGEtZ3dkLWdyb3VwPVNwaW5uZXJHcm91cF0gLmd3ZC1nZW4tMnV2OGd3ZGFuaW1hdGlvbnthbmltYXRpb246Z3dkLWdlbi0ydXY4Z3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXMgMnMgbGluZWFyIDBzIGluZmluaXRlIG5vcm1hbCBmb3J3YXJkczstd2Via2l0LWFuaW1hdGlvbjpnd2QtZ2VuLTJ1djhnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lcyAycyBsaW5lYXIgMHMgaW5maW5pdGUgbm9ybWFsIGZvcndhcmRzOy1tb3otYW5pbWF0aW9uOmd3ZC1nZW4tMnV2OGd3ZGFuaW1hdGlvbl9nd2Qta2V5ZnJhbWVzIDJzIGxpbmVhciAwcyBpbmZpbml0ZSBub3JtYWwgZm9yd2FyZHN9QGtleWZyYW1lcyBnd2QtZ2VuLTF4OTdnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lc3swJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApO2FuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmQ7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH0yNSV7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApO2FuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmQ7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH01NSV7b3BhY2l0eToxO3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZDstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9NjAle29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXI7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcjstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyfTEwMCV7b3BhY2l0eTowO3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcjstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXJ9fUAtd2Via2l0LWtleWZyYW1lcyBnd2QtZ2VuLTF4OTdnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lc3swJXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH0yNSV7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH01NSV7b3BhY2l0eToxOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9NjAle29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn0xMDAle29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn19QC1tb3ota2V5ZnJhbWVzIGd3ZC1nZW4tMXg5N2d3ZGFuaW1hdGlvbl9nd2Qta2V5ZnJhbWVzezAle29wYWNpdHk6MDstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTI1JXstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTU1JXtvcGFjaXR5OjE7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH02MCV7b3BhY2l0eTowOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyfTEwMCV7b3BhY2l0eTowOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyfX1bZGF0YS1nd2QtZ3JvdXA9U3Bpbm5lckdyb3VwXSAuZ3dkLWdlbi0xeDk3Z3dkYW5pbWF0aW9ue2FuaW1hdGlvbjpnd2QtZ2VuLTF4OTdnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lcyAycyBsaW5lYXIgMHMgaW5maW5pdGUgbm9ybWFsIGZvcndhcmRzOy13ZWJraXQtYW5pbWF0aW9uOmd3ZC1nZW4tMXg5N2d3ZGFuaW1hdGlvbl9nd2Qta2V5ZnJhbWVzIDJzIGxpbmVhciAwcyBpbmZpbml0ZSBub3JtYWwgZm9yd2FyZHM7LW1vei1hbmltYXRpb246Z3dkLWdlbi0xeDk3Z3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXMgMnMgbGluZWFyIDBzIGluZmluaXRlIG5vcm1hbCBmb3J3YXJkc31Aa2V5ZnJhbWVzIGd3ZC1nZW4tMWkxZWd3ZGFuaW1hdGlvbl9nd2Qta2V5ZnJhbWVzezAle29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZDstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmQ7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTI1JXt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZDstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmQ7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTYwJXtvcGFjaXR5OjE7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApO2FuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmQ7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH02NSV7b3BhY2l0eTowO3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcjstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXJ9MTAwJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApO2FuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXI7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn19QC13ZWJraXQta2V5ZnJhbWVzIGd3ZC1nZW4tMWkxZWd3ZGFuaW1hdGlvbl9nd2Qta2V5ZnJhbWVzezAle29wYWNpdHk6MDstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTI1JXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTYwJXtvcGFjaXR5OjE7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH02NSV7b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyfTEwMCV7b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyfX1ALW1vei1rZXlmcmFtZXMgZ3dkLWdlbi0xaTFlZ3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXN7MCV7b3BhY2l0eTowOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9MjUley1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9NjAle29wYWNpdHk6MTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTY1JXtvcGFjaXR5OjA7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXJ9MTAwJXtvcGFjaXR5OjA7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXJ9fVtkYXRhLWd3ZC1ncm91cD1TcGlubmVyR3JvdXBdIC5nd2QtZ2VuLTFpMWVnd2RhbmltYXRpb257YW5pbWF0aW9uOmd3ZC1nZW4tMWkxZWd3ZGFuaW1hdGlvbl9nd2Qta2V5ZnJhbWVzIDJzIGxpbmVhciAwcyBpbmZpbml0ZSBub3JtYWwgZm9yd2FyZHM7LXdlYmtpdC1hbmltYXRpb246Z3dkLWdlbi0xaTFlZ3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXMgMnMgbGluZWFyIDBzIGluZmluaXRlIG5vcm1hbCBmb3J3YXJkczstbW96LWFuaW1hdGlvbjpnd2QtZ2VuLTFpMWVnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lcyAycyBsaW5lYXIgMHMgaW5maW5pdGUgbm9ybWFsIGZvcndhcmRzfUBrZXlmcmFtZXMgZ3dkLWdlbi0xc2FwZ3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXN7MCV7b3BhY2l0eTowO3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZDstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9MjUle3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZDstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9NjUle29wYWNpdHk6MTt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZDstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmQ7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTcwJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApO2FuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXI7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn0xMDAle29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXI7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcjstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyfX1ALXdlYmtpdC1rZXlmcmFtZXMgZ3dkLWdlbi0xc2FwZ3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXN7MCV7b3BhY2l0eTowOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9MjUley13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9NjUle29wYWNpdHk6MTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOnN0ZXAtZW5kfTcwJXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXJ9MTAwJXtvcGFjaXR5OjA7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXJ9fUAtbW96LWtleWZyYW1lcyBnd2QtZ2VuLTFzYXBnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lc3swJXtvcGFjaXR5OjA7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH0yNSV7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpzdGVwLWVuZH02NSV7b3BhY2l0eToxOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246c3RlcC1lbmR9NzAle29wYWNpdHk6MDstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn0xMDAle29wYWNpdHk6MDstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn19W2RhdGEtZ3dkLWdyb3VwPVNwaW5uZXJHcm91cF0gLmd3ZC1nZW4tMXNhcGd3ZGFuaW1hdGlvbnthbmltYXRpb246Z3dkLWdlbi0xc2FwZ3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXMgMnMgbGluZWFyIDBzIGluZmluaXRlIG5vcm1hbCBmb3J3YXJkczstd2Via2l0LWFuaW1hdGlvbjpnd2QtZ2VuLTFzYXBnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lcyAycyBsaW5lYXIgMHMgaW5maW5pdGUgbm9ybWFsIGZvcndhcmRzOy1tb3otYW5pbWF0aW9uOmd3ZC1nZW4tMXNhcGd3ZGFuaW1hdGlvbl9nd2Qta2V5ZnJhbWVzIDJzIGxpbmVhciAwcyBpbmZpbml0ZSBub3JtYWwgZm9yd2FyZHN9QGtleWZyYW1lcyBnd2QtZ2VuLTVxb3Rnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lc3swJXt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApIHJvdGF0ZVooMCkgc2NhbGUzZCgxLDEsMSk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApIHJvdGF0ZVooMCkgc2NhbGUzZCgxLDEsMSk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApIHJvdGF0ZVooMCkgc2NhbGUzZCgxLDEsMSk7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoMSwwLC41OCwxKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKDEsMCwuNTgsMSk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllcigxLDAsLjU4LDEpfTEyLjUle3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDIwMHB4LDApIHJvdGF0ZVooMCkgc2NhbGUzZCgxLjIsLjgsMSk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwyMDBweCwwKSByb3RhdGVaKDApIHNjYWxlM2QoMS4yLC44LDEpOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMjAwcHgsMCkgcm90YXRlWigwKSBzY2FsZTNkKDEuMiwuOCwxKTthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllciguNDIsMCwwLDEpOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoLjQyLDAsMCwxKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKC40MiwwLDAsMSl9MjUle3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCkgcm90YXRlWigwKSBzY2FsZTNkKDEsMSwxKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCkgcm90YXRlWigwKSBzY2FsZTNkKDEsMSwxKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCkgcm90YXRlWigwKSBzY2FsZTNkKDEsMSwxKTthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllcigxLDAsLjU4LDEpOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoMSwwLC41OCwxKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKDEsMCwuNTgsMSl9MzcuNSV7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMjAwcHgsMCkgcm90YXRlWigwKSBzY2FsZTNkKDEuMiwuOCwxKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDIwMHB4LDApIHJvdGF0ZVooMCkgc2NhbGUzZCgxLjIsLjgsMSk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwyMDBweCwwKSByb3RhdGVaKDApIHNjYWxlM2QoMS4yLC44LDEpO2FuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKC40MiwwLDAsMSk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllciguNDIsMCwwLDEpOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoLjQyLDAsMCwxKX01MCV7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKSByb3RhdGVaKDApIHNjYWxlM2QoMSwxLDEpOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKSByb3RhdGVaKDApIHNjYWxlM2QoMSwxLDEpOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKSByb3RhdGVaKDApIHNjYWxlM2QoMSwxLDEpO2FuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKDEsMCwuNTgsMSk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllcigxLDAsLjU4LDEpOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoMSwwLC41OCwxKX02Mi41JXt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwyMDBweCwwKSByb3RhdGVaKDApIHNjYWxlM2QoMS4yLC44LDEpOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMjAwcHgsMCkgcm90YXRlWigwKSBzY2FsZTNkKDEuMiwuOCwxKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDIwMHB4LDApIHJvdGF0ZVooMCkgc2NhbGUzZCgxLjIsLjgsMSk7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoLjQyLDAsMCwxKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKC40MiwwLDAsMSk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllciguNDIsMCwwLDEpfTc1JXt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApIHJvdGF0ZVooMCkgc2NhbGUzZCgxLDEsMSk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApIHJvdGF0ZVooMCkgc2NhbGUzZCgxLDEsMSk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApIHJvdGF0ZVooMCkgc2NhbGUzZCgxLDEsMSk7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoMSwwLC41OCwxKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKDEsMCwuNTgsMSk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllcigxLDAsLjU4LDEpfTg3LjUle3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDIwMHB4LDApIHJvdGF0ZVooMCkgc2NhbGUzZCgxLjIsLjgsMSk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwyMDBweCwwKSByb3RhdGVaKDApIHNjYWxlM2QoMS4yLC44LDEpOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMjAwcHgsMCkgcm90YXRlWigwKSBzY2FsZTNkKDEuMiwuOCwxKTthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllciguNDIsMCwwLDEpOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoLjQyLDAsMCwxKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKC40MiwwLDAsMSl9MTAwJXt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApIHJvdGF0ZVooMzYwZGVnKSBzY2FsZTNkKDEsMSwxKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCkgcm90YXRlWigzNjBkZWcpIHNjYWxlM2QoMSwxLDEpOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKSByb3RhdGVaKDM2MGRlZykgc2NhbGUzZCgxLDEsMSk7YW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXI7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcjstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyfX1ALXdlYmtpdC1rZXlmcmFtZXMgZ3dkLWdlbi01cW90Z3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXN7MCV7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApIHJvdGF0ZVooMCkgc2NhbGUzZCgxLDEsMSk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllcigxLDAsLjU4LDEpfTEyLjUley13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMjAwcHgsMCkgcm90YXRlWigwKSBzY2FsZTNkKDEuMiwuOCwxKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKC40MiwwLDAsMSl9MjUley13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKSByb3RhdGVaKDApIHNjYWxlM2QoMSwxLDEpOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoMSwwLC41OCwxKX0zNy41JXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDIwMHB4LDApIHJvdGF0ZVooMCkgc2NhbGUzZCgxLjIsLjgsMSk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllciguNDIsMCwwLDEpfTUwJXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCkgcm90YXRlWigwKSBzY2FsZTNkKDEsMSwxKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKDEsMCwuNTgsMSl9NjIuNSV7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwyMDBweCwwKSByb3RhdGVaKDApIHNjYWxlM2QoMS4yLC44LDEpOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoLjQyLDAsMCwxKX03NSV7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApIHJvdGF0ZVooMCkgc2NhbGUzZCgxLDEsMSk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllcigxLDAsLjU4LDEpfTg3LjUley13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMjAwcHgsMCkgcm90YXRlWigwKSBzY2FsZTNkKDEuMiwuOCwxKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKC40MiwwLDAsMSl9MTAwJXstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCkgcm90YXRlWigzNjBkZWcpIHNjYWxlM2QoMSwxLDEpOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXJ9fUAtbW96LWtleWZyYW1lcyBnd2QtZ2VuLTVxb3Rnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lc3swJXstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCkgcm90YXRlWigwKSBzY2FsZTNkKDEsMSwxKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKDEsMCwuNTgsMSl9MTIuNSV7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwyMDBweCwwKSByb3RhdGVaKDApIHNjYWxlM2QoMS4yLC44LDEpOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoLjQyLDAsMCwxKX0yNSV7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApIHJvdGF0ZVooMCkgc2NhbGUzZCgxLDEsMSk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllcigxLDAsLjU4LDEpfTM3LjUley1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMjAwcHgsMCkgcm90YXRlWigwKSBzY2FsZTNkKDEuMiwuOCwxKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKC40MiwwLDAsMSl9NTAley1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKSByb3RhdGVaKDApIHNjYWxlM2QoMSwxLDEpOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoMSwwLC41OCwxKX02Mi41JXstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDIwMHB4LDApIHJvdGF0ZVooMCkgc2NhbGUzZCgxLjIsLjgsMSk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllciguNDIsMCwwLDEpfTc1JXstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCkgcm90YXRlWigwKSBzY2FsZTNkKDEsMSwxKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKDEsMCwuNTgsMSl9ODcuNSV7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwyMDBweCwwKSByb3RhdGVaKDApIHNjYWxlM2QoMS4yLC44LDEpOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoLjQyLDAsMCwxKX0xMDAley1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKSByb3RhdGVaKDM2MGRlZykgc2NhbGUzZCgxLDEsMSk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn19W2RhdGEtZ3dkLWdyb3VwPVNwaW5uZXJHcm91cF0gLmd3ZC1nZW4tNXFvdGd3ZGFuaW1hdGlvbnthbmltYXRpb246Z3dkLWdlbi01cW90Z3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXMgNHMgbGluZWFyIDBzIGluZmluaXRlIG5vcm1hbCBmb3J3YXJkczstd2Via2l0LWFuaW1hdGlvbjpnd2QtZ2VuLTVxb3Rnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lcyA0cyBsaW5lYXIgMHMgaW5maW5pdGUgbm9ybWFsIGZvcndhcmRzOy1tb3otYW5pbWF0aW9uOmd3ZC1nZW4tNXFvdGd3ZGFuaW1hdGlvbl9nd2Qta2V5ZnJhbWVzIDRzIGxpbmVhciAwcyBpbmZpbml0ZSBub3JtYWwgZm9yd2FyZHN9QGtleWZyYW1lcyBnd2QtZ2VuLWZhYWRnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lc3swJXtvcGFjaXR5Oi4yO3RyYW5zZm9ybTpzY2FsZTNkKC41LC44LDEpOy13ZWJraXQtdHJhbnNmb3JtOnNjYWxlM2QoLjUsLjgsMSk7LW1vei10cmFuc2Zvcm06c2NhbGUzZCguNSwuOCwxKTthbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllcigxLDAsLjU4LDEpOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoMSwwLC41OCwxKTstbW96LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKDEsMCwuNTgsMSl9NTAle29wYWNpdHk6LjU7dHJhbnNmb3JtOnNjYWxlM2QoMSwuOCwxKTstd2Via2l0LXRyYW5zZm9ybTpzY2FsZTNkKDEsLjgsMSk7LW1vei10cmFuc2Zvcm06c2NhbGUzZCgxLC44LDEpO2FuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKC40MiwwLDAsMSk7LXdlYmtpdC1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllciguNDIsMCwwLDEpOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoLjQyLDAsMCwxKX0xMDAle29wYWNpdHk6LjI7dHJhbnNmb3JtOnNjYWxlM2QoLjUsLjgsMSk7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUzZCguNSwuOCwxKTstbW96LXRyYW5zZm9ybTpzY2FsZTNkKC41LC44LDEpO2FuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXI7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmxpbmVhcn19QC13ZWJraXQta2V5ZnJhbWVzIGd3ZC1nZW4tZmFhZGd3ZGFuaW1hdGlvbl9nd2Qta2V5ZnJhbWVzezAle29wYWNpdHk6LjI7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUzZCguNSwuOCwxKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246Y3ViaWMtYmV6aWVyKDEsMCwuNTgsMSl9NTAle29wYWNpdHk6LjU7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUzZCgxLC44LDEpOy13ZWJraXQtYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoLjQyLDAsMCwxKX0xMDAle29wYWNpdHk6LjI7LXdlYmtpdC10cmFuc2Zvcm06c2NhbGUzZCguNSwuOCwxKTstd2Via2l0LWFuaW1hdGlvbi10aW1pbmctZnVuY3Rpb246bGluZWFyfX1ALW1vei1rZXlmcmFtZXMgZ3dkLWdlbi1mYWFkZ3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXN7MCV7b3BhY2l0eTouMjstbW96LXRyYW5zZm9ybTpzY2FsZTNkKC41LC44LDEpOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpjdWJpYy1iZXppZXIoMSwwLC41OCwxKX01MCV7b3BhY2l0eTouNTstbW96LXRyYW5zZm9ybTpzY2FsZTNkKDEsLjgsMSk7LW1vei1hbmltYXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllciguNDIsMCwwLDEpfTEwMCV7b3BhY2l0eTouMjstbW96LXRyYW5zZm9ybTpzY2FsZTNkKC41LC44LDEpOy1tb3otYW5pbWF0aW9uLXRpbWluZy1mdW5jdGlvbjpsaW5lYXJ9fVtkYXRhLWd3ZC1ncm91cD1TcGlubmVyR3JvdXBdIC5nd2QtZ2VuLWZhYWRnd2RhbmltYXRpb257YW5pbWF0aW9uOmd3ZC1nZW4tZmFhZGd3ZGFuaW1hdGlvbl9nd2Qta2V5ZnJhbWVzIDFzIGxpbmVhciAwcyBpbmZpbml0ZSBub3JtYWwgZm9yd2FyZHM7LXdlYmtpdC1hbmltYXRpb246Z3dkLWdlbi1mYWFkZ3dkYW5pbWF0aW9uX2d3ZC1rZXlmcmFtZXMgMXMgbGluZWFyIDBzIGluZmluaXRlIG5vcm1hbCBmb3J3YXJkczstbW96LWFuaW1hdGlvbjpnd2QtZ2VuLWZhYWRnd2RhbmltYXRpb25fZ3dkLWtleWZyYW1lcyAxcyBsaW5lYXIgMHMgaW5maW5pdGUgbm9ybWFsIGZvcndhcmRzfVtkYXRhLWd3ZC1ncm91cD1TcGlubmVyR3JvdXBdIC5nd2QtZ3JwLTEzdGQuZ3dkLWltZy0xNjUze3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO3dpZHRoOjYxMnB4O2hlaWdodDo1NjhweDtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApO2xlZnQ6MH1bZGF0YS1nd2QtZ3JvdXA9U3Bpbm5lckdyb3VwXSAuZ3dkLWdycC0xM3RkLmd3ZC1pbWctYWxzbXtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDt3aWR0aDo2MTJweDtoZWlnaHQ6NTY4cHg7b3BhY2l0eTowO3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTtsZWZ0OjB9W2RhdGEtZ3dkLWdyb3VwPVNwaW5uZXJHcm91cF0gLmd3ZC1ncnAtMTN0ZC5nd2QtaW1nLWYwbXV7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7d2lkdGg6NjEycHg7aGVpZ2h0OjU2OHB4O29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7bGVmdDowfVtkYXRhLWd3ZC1ncm91cD1TcGlubmVyR3JvdXBdIC5nd2QtZ3JwLTEzdGQuZ3dkLWltZy0xc3Ize3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO3dpZHRoOjYxMnB4O2hlaWdodDo1NjhweDtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApO2xlZnQ6MH1bZGF0YS1nd2QtZ3JvdXA9U3Bpbm5lckdyb3VwXSAuZ3dkLWdycC0xM3RkLmd3ZC1pbWctMWZmbntwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDt3aWR0aDo2MTJweDtoZWlnaHQ6NTY4cHg7b3BhY2l0eTowO3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LXdlYmtpdC10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy1tb3otdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTtsZWZ0OjB9W2RhdGEtZ3dkLWdyb3VwPVNwaW5uZXJHcm91cF0gLmd3ZC1ncnAtMTN0ZC5nd2QtaW1nLTE2ZjN7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7d2lkdGg6NjEycHg7aGVpZ2h0OjU2OHB4O29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApOy13ZWJraXQtdHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7bGVmdDowfVtkYXRhLWd3ZC1ncm91cD1TcGlubmVyR3JvdXBdIC5nd2QtZ3JwLTEzdGQuZ3dkLWltZy0xcnJze3Bvc2l0aW9uOmFic29sdXRlO3RvcDowO3dpZHRoOjYxMnB4O2hlaWdodDo1NjhweDtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNkKDAsMCwwKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCk7LW1vei10cmFuc2Zvcm06dHJhbnNsYXRlM2QoMCwwLDApO2xlZnQ6MH1bZGF0YS1nd2QtZ3JvdXA9U3Bpbm5lckdyb3VwXSAuZ3dkLWdycC0xM3RkLmd3ZC1pbWctMWRoaXtwb3NpdGlvbjphYnNvbHV0ZTt0cmFuc2Zvcm0tb3JpZ2luOjI4My43MTFweCAyODMuNTE2cHggMDstd2Via2l0LXRyYW5zZm9ybS1vcmlnaW46MjgzLjcxMXB4IDI4My41MTZweCAwOy1tb3otdHJhbnNmb3JtLW9yaWdpbjoyODMuNzExcHggMjgzLjUxNnB4IDA7aGVpZ2h0OjU2OHB4O3dpZHRoOjU2OHB4O3RvcDowO3RyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCkgcm90YXRlWigwKSBzY2FsZTNkKDEsMSwxKTstd2Via2l0LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCkgcm90YXRlWigwKSBzY2FsZTNkKDEsMSwxKTstbW96LXRyYW5zZm9ybTp0cmFuc2xhdGUzZCgwLDAsMCkgcm90YXRlWigwKSBzY2FsZTNkKDEsMSwxKTt0cmFuc2Zvcm0tc3R5bGU6cHJlc2VydmUtM2Q7LXdlYmtpdC10cmFuc2Zvcm0tc3R5bGU6cHJlc2VydmUtM2Q7LW1vei10cmFuc2Zvcm0tc3R5bGU6cHJlc2VydmUtM2Q7bGVmdDowfVtkYXRhLWd3ZC1ncm91cD1TcGlubmVyR3JvdXBdIC5nd2QtZ3JwLTEzdGQuZ3dkLWltZy0xaXpne3Bvc2l0aW9uOmFic29sdXRlO3dpZHRoOjU2OHB4O2hlaWdodDo2MDQuMDJweDtvcGFjaXR5Oi4yO3RyYW5zZm9ybS1zdHlsZTpwcmVzZXJ2ZS0zZDstd2Via2l0LXRyYW5zZm9ybS1zdHlsZTpwcmVzZXJ2ZS0zZDstbW96LXRyYW5zZm9ybS1zdHlsZTpwcmVzZXJ2ZS0zZDt0cmFuc2Zvcm06c2NhbGUzZCguNSwuOCwxKTstd2Via2l0LXRyYW5zZm9ybTpzY2FsZTNkKC41LC44LDEpOy1tb3otdHJhbnNmb3JtOnNjYWxlM2QoLjUsLjgsMSk7dG9wOjU1cHg7bGVmdDowfVtkYXRhLWd3ZC1ncm91cD1TcGlubmVyR3JvdXBde3dpZHRoOjYxMS45NzlweDtoZWlnaHQ6NTk4LjYwNXB4fS5nd2QtZGl2LTF2MXN7dHJhbnNmb3JtOnNjYWxlKC41LC41KX1cbiIsIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoZSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdC5wcm90b3R5cGUuc2V0dXBFdmVudHMgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICB0aGlzLmludGVybmFsU0RLID0gdAogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5oaWRlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhpZGVFbGVtZW50KHRoaXMuY29udGFpbmVyRGl2KSwgdGhpcy5oaWRlRWxlbWVudCh0aGlzLnByb2dyZXNzQ29udGFpbmVyKSwgdGhpcy5oaWRlUGF1c2VCdXR0b24oKSwgdGhpcy5oaWRlRWxlbWVudCh0aGlzLnN0YXJ0QWRCdXR0b24pLCB0aGlzLmNvbnRhaW5lckRpdi5jbGFzc0xpc3QucmVtb3ZlKCJwb2tpU2RrT3ZlcmxheSIpLCB0aGlzLnByb2dyZXNzQmFyLnN0eWxlLndpZHRoID0gIjAlIgogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5oaWRlU3Bpbm5lciA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdGhpcy5oaWRlRWxlbWVudCh0aGlzLnNwaW5uZXJDb250YWluZXIpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLnNob3dXaXRoT3BhY2l0eSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdGhpcy5zaG93RWxlbWVudCh0aGlzLnNwaW5uZXJDb250YWluZXIpLCB0aGlzLnNob3dFbGVtZW50KHRoaXMuY29udGFpbmVyRGl2KSwgdGhpcy5zaG93RWxlbWVudCh0aGlzLnByb2dyZXNzQ29udGFpbmVyKQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5zaG93ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lckRpdi5jbGFzc0xpc3QuYWRkKCJwb2tpU2RrT3ZlcmxheSIpLCB0aGlzLnNob3dFbGVtZW50KHRoaXMuY29udGFpbmVyRGl2KSwgdGhpcy5zaG93RWxlbWVudCh0aGlzLnByb2dyZXNzQ29udGFpbmVyKQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5nZXRWaWRlb0JvdW5kcyA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWRDb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuZ2V0QWRDb250YWluZXIgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmFkQ29udGFpbmVyCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLmdldFZpZGVvQ29udGFpbmVyID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52aWRlb0NvbnRhaW5lcgogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5zaG93UGF1c2VCdXR0b24gPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd0VsZW1lbnQodGhpcy5wYXVzZUJ1dHRvbiksIHRoaXMuaW50ZXJuYWxTREsgJiYgdGhpcy5wYXVzZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCJjbGljayIsIHRoaXMuaW50ZXJuYWxTREsucmVzdW1lQWQuYmluZCh0aGlzLmludGVybmFsU0RLKSkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuaGlkZVBhdXNlQnV0dG9uID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB0aGlzLmhpZGVFbGVtZW50KHRoaXMucGF1c2VCdXR0b24pLCB0aGlzLmludGVybmFsU0RLICYmIHRoaXMucGF1c2VCdXR0b24ucmVtb3ZlRXZlbnRMaXN0ZW5lcigiY2xpY2siLCB0aGlzLmludGVybmFsU0RLLnJlc3VtZUFkLmJpbmQodGhpcy5pbnRlcm5hbFNESykpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLnNob3dTdGFydEFkQnV0dG9uID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB0aGlzLnNob3dFbGVtZW50KHRoaXMuc3RhcnRBZEJ1dHRvbiksIHRoaXMuaW50ZXJuYWxTREsgJiYgdGhpcy5zdGFydEFkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgdGhpcy5pbnRlcm5hbFNESy5zdGFydEFkQ2xpY2tlZC5iaW5kKHRoaXMuaW50ZXJuYWxTREspKQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5oaWRlU3RhcnRBZEJ1dHRvbiA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdGhpcy5oaWRlRWxlbWVudCh0aGlzLnN0YXJ0QWRCdXR0b24pLCB0aGlzLmludGVybmFsU0RLICYmIHRoaXMuc3RhcnRBZEJ1dHRvbi5yZW1vdmVFdmVudExpc3RlbmVyKCJjbGljayIsIHRoaXMuaW50ZXJuYWxTREsuc3RhcnRBZENsaWNrZWQuYmluZCh0aGlzLmludGVybmFsU0RLKSkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuY3JlYXRlRWxlbWVudHMgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbnRhaW5lckRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLCB0aGlzLmluc2lkZUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLCB0aGlzLnBhdXNlQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IiksIHRoaXMuc3RhcnRBZEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpLCB0aGlzLnByb2dyZXNzQmFyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IiksIHRoaXMucHJvZ3Jlc3NDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSwgdGhpcy5zcGlubmVyQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IiksIHRoaXMuYWRDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSwgdGhpcy52aWRlb0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInZpZGVvIiksIHRoaXMuYWRDb250YWluZXIuaWQgPSAicG9raVNES0FkQ29udGFpbmVyIiwgdGhpcy52aWRlb0NvbnRhaW5lci5pZCA9ICJwb2tpU0RLVmlkZW9Db250YWluZXIiLCB0aGlzLmNvbnRhaW5lckRpdi5jbGFzc05hbWUgPSAicG9raVNka0NvbnRhaW5lciIsIHRoaXMuaW5zaWRlQ29udGFpbmVyLmNsYXNzTmFtZSA9ICJwb2tpU2RrSW5zaWRlQ29udGFpbmVyIiwgdGhpcy5wYXVzZUJ1dHRvbi5jbGFzc05hbWUgPSBOLCB0aGlzLnBhdXNlQnV0dG9uLmlubmVySFRNTCA9ICJUYXAgYW55d2hlcmUgdG8g4pa277iPIiwgdGhpcy5zdGFydEFkQnV0dG9uLmNsYXNzTmFtZSA9ICJwb2tpU2RrU3RhcnRBZEJ1dHRvbiIsIHRoaXMuc3RhcnRBZEJ1dHRvbi5pbm5lckhUTUwgPSAiVGFwIGFueXdoZXJlIHRvIHBsYXkgYWQiLCB0aGlzLnByb2dyZXNzQmFyLmNsYXNzTmFtZSA9IEYsIHRoaXMucHJvZ3Jlc3NDb250YWluZXIuY2xhc3NOYW1lID0gInBva2lTZGtQcm9ncmVzc0NvbnRhaW5lciIsIHRoaXMuc3Bpbm5lckNvbnRhaW5lci5jbGFzc05hbWUgPSBYLCB0aGlzLmFkQ29udGFpbmVyLmNsYXNzTmFtZSA9ICJwb2tpU0RLQWRDb250YWluZXIiLCB0aGlzLnZpZGVvQ29udGFpbmVyLmNsYXNzTmFtZSA9ICJwb2tpU2RrVmlkZW9Db250YWluZXIiLCB0aGlzLnNwaW5uZXJDb250YWluZXIuaW5uZXJIVE1MID0gJ1xuXHRcdFx0PGRpdiBpZD0ibmV3LXByb2dyZXNzLXNwaW5uZXIiIHN0eWxlPSJ6LWluZGV4OjEwO3Bvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiA1MCU7IGxlZnQ6IDUwJTsgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSkgc2NhbGUzZCgwLjUsIDAuNSwgMC41KTsiPlxuXHRcdFx0XHQ8ZGl2IGNsYXNzPSJnd2QtZGl2LTF2MXMiIGRhdGEtZ3dkLWdyb3VwPSJTcGlubmVyR3JvdXAiPlxuXHRcdFx0XHRcdDxpbWcgc3JjPSJodHRwczovL2dhbWUtY2RuLnBva2kuY29tL2xvYWRlcnMvdjIvc3RhdGljL3NwaW5uZXIvU3BhcmtsZV8xLnN2ZyIgY2xhc3M9Imd3ZC1pbWctMTY1MyBnd2QtZ2VuLW5vMDJnd2RhbmltYXRpb24gZ3dkLWdycC0xM3RkIiBkYXRhLWd3ZC1ncnAtaWQ9IlNwYXJrbGVfMSI+XG5cdFx0XHRcdFx0PGltZyBzcmM9Imh0dHBzOi8vZ2FtZS1jZG4ucG9raS5jb20vbG9hZGVycy92Mi9zdGF0aWMvc3Bpbm5lci9TcGFya2xlXzIuc3ZnIiBjbGFzcz0iZ3dkLWltZy1hbHNtIGd3ZC1nZW4tNHB2cmd3ZGFuaW1hdGlvbiBnd2QtZ3JwLTEzdGQiIGRhdGEtZ3dkLWdycC1pZD0iU3BhcmtsZV8yIj5cblx0XHRcdFx0XHQ8aW1nIHNyYz0iaHR0cHM6Ly9nYW1lLWNkbi5wb2tpLmNvbS9sb2FkZXJzL3YyL3N0YXRpYy9zcGlubmVyL1NwYXJrbGVfMy5zdmciIGNsYXNzPSJnd2QtaW1nLWYwbXUgZ3dkLWdlbi1rdzQwZ3dkYW5pbWF0aW9uIGd3ZC1ncnAtMTN0ZCIgZGF0YS1nd2QtZ3JwLWlkPSJTcGFya2xlXzMiPlxuXHRcdFx0XHRcdDxpbWcgc3JjPSJodHRwczovL2dhbWUtY2RuLnBva2kuY29tL2xvYWRlcnMvdjIvc3RhdGljL3NwaW5uZXIvU3BhcmtsZV80LnN2ZyIgY2xhc3M9Imd3ZC1pbWctMXNyMyBnd2QtZ2VuLTJ1djhnd2RhbmltYXRpb24gZ3dkLWdycC0xM3RkIiBkYXRhLWd3ZC1ncnAtaWQ9IlNwYXJrbGVfNCI+XG5cdFx0XHRcdFx0PGltZyBzcmM9Imh0dHBzOi8vZ2FtZS1jZG4ucG9raS5jb20vbG9hZGVycy92Mi9zdGF0aWMvc3Bpbm5lci9TcGFya2xlXzUuc3ZnIiBjbGFzcz0iZ3dkLWltZy0xZmZuIGd3ZC1nZW4tMXg5N2d3ZGFuaW1hdGlvbiBnd2QtZ3JwLTEzdGQiIGRhdGEtZ3dkLWdycC1pZD0iU3BhcmtsZV81Ij5cblx0XHRcdFx0XHQ8aW1nIHNyYz0iaHR0cHM6Ly9nYW1lLWNkbi5wb2tpLmNvbS9sb2FkZXJzL3YyL3N0YXRpYy9zcGlubmVyL1NwYXJrbGVfNi5zdmciIGNsYXNzPSJnd2QtaW1nLTE2ZjMgZ3dkLWdlbi0xaTFlZ3dkYW5pbWF0aW9uIGd3ZC1ncnAtMTN0ZCIgZGF0YS1nd2QtZ3JwLWlkPSJTcGFya2xlXzYiPlxuXHRcdFx0XHRcdDxpbWcgc3JjPSJodHRwczovL2dhbWUtY2RuLnBva2kuY29tL2xvYWRlcnMvdjIvc3RhdGljL3NwaW5uZXIvU3BhcmtsZV83LnN2ZyIgY2xhc3M9Imd3ZC1pbWctMXJycyBnd2QtZ2VuLTFzYXBnd2RhbmltYXRpb24gZ3dkLWdycC0xM3RkIiBkYXRhLWd3ZC1ncnAtaWQ9IlNwYXJrbGVfNyI+XG5cdFx0XHRcdFx0PGltZyBzcmM9Imh0dHBzOi8vZ2FtZS1jZG4ucG9raS5jb20vbG9hZGVycy92Mi4wL3N0YXRpYy9oYW5kX2ZpbmdlcnNfaXNvbGF0ZWQuc3ZnIiBjbGFzcz0iZ3dkLWltZy0xZGhpIGd3ZC1nZW4tNXFvdGd3ZGFuaW1hdGlvbiBnd2QtZ3JwLTEzdGQiIGRhdGEtZ3dkLWdycC1pZD0iaGVhcnQiPlxuXHRcdFx0XHRcdDxpbWcgc3JjPSJodHRwczovL2dhbWUtY2RuLnBva2kuY29tL2xvYWRlcnMvdjIvc3RhdGljL3NwaW5uZXIvc2hhZG93X25ld18zLnN2ZyIgY2xhc3M9Imd3ZC1pbWctMWl6ZyBnd2QtZ2VuLWZhYWRnd2RhbmltYXRpb24gZ3dkLWdycC0xM3RkIiBkYXRhLWd3ZC1ncnAtaWQ9InNoYWRvd19uZXdfMyI+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cdFx0JywgdGhpcy5oaWRlKCksIHRoaXMudmlkZW9Db250YWluZXIuc2V0QXR0cmlidXRlKCJwbGF5c2lubGluZSIsICJwbGF5c2lubGluZSIpLCB0aGlzLnZpZGVvQ29udGFpbmVyLnNldEF0dHJpYnV0ZSgibXV0ZWQiLCAibXV0ZWQiKSwgdGhpcy5jb250YWluZXJEaXYuYXBwZW5kQ2hpbGQodGhpcy5pbnNpZGVDb250YWluZXIpLCB0aGlzLmNvbnRhaW5lckRpdi5hcHBlbmRDaGlsZCh0aGlzLnNwaW5uZXJDb250YWluZXIpLCB0aGlzLmluc2lkZUNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLnByb2dyZXNzQ29udGFpbmVyKSwgdGhpcy5pbnNpZGVDb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy52aWRlb0NvbnRhaW5lciksIHRoaXMuaW5zaWRlQ29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuYWRDb250YWluZXIpLCB0aGlzLmNvbnRhaW5lckRpdi5hcHBlbmRDaGlsZCh0aGlzLnBhdXNlQnV0dG9uKSwgdGhpcy5jb250YWluZXJEaXYuYXBwZW5kQ2hpbGQodGhpcy5zdGFydEFkQnV0dG9uKSwgdGhpcy5wcm9ncmVzc0NvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLnByb2dyZXNzQmFyKSwgdGhpcy53cmFwcGVyLmFwcGVuZENoaWxkKHRoaXMuY29udGFpbmVyRGl2KSwgdGhpcy53cmFwcGVyID09PSBkb2N1bWVudC5ib2R5KSB0aGlzLmNvbnRhaW5lckRpdi5jbGFzc0xpc3QuYWRkKCJwb2tpU2RrRml4ZWQiKTsKICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIHZhciB0ID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy53cmFwcGVyKS5wb3NpdGlvbjsKICAgICAgICAgICAgICAgICAgICB0ICYmIC0xICE9PSBbImFic29sdXRlIiwgImZpeGVkIiwgInJlbGF0aXZlIl0uaW5kZXhPZih0KSB8fCAodGhpcy53cmFwcGVyLnN0eWxlLnBvc2l0aW9uID0gInJlbGF0aXZlIikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgdAogICAgICAgIH0oKSwKICAgICAgICBIID0gITAsCiAgICAgICAgVyA9IHt9OwogICAgdmFyIFYgPSBbIkFUIiwgIkJFIiwgIkJHIiwgIkhSIiwgIkNZIiwgIkNaIiwgIkRLIiwgIkVFIiwgIkZJIiwgIkZSIiwgIkRFIiwgIkdSIiwgIkhVIiwgIklFIiwgIklUIiwgIkxWIiwgIkxUIiwgIkxVIiwgIk1UIiwgIk5MIiwgIlBMIiwgIlBUIiwgIlJPIiwgIlNLIiwgIlNJIiwgIkVTIiwgIlNFIiwgIkdCIiwgIklTIiwgIkxJIiwgIk5PIl0sCiAgICAgICAgcSA9IFsiVVMiXSwKICAgICAgICBLID0gWyJaWiJdOwoKICAgIGZ1bmN0aW9uIEoodCkgewogICAgICAgIHJldHVybiBWLmluY2x1ZGVzKHQpCiAgICB9CgogICAgZnVuY3Rpb24gWSh0KSB7CiAgICAgICAgcmV0dXJuIEsuaW5jbHVkZXModCkKICAgIH0KICAgIHZhciAkID0gZnVuY3Rpb24odCwgbiwgZSwgaSkgewogICAgICAgICAgICByZXR1cm4gbmV3KGUgfHwgKGUgPSBQcm9taXNlKSkoKGZ1bmN0aW9uKHIsIG8pIHsKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEodCkgewogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGQoaS5uZXh0KHQpKQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbyh0KQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzKHQpIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBkKGkudGhyb3codCkpCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICAgICAgICAgICAgICBvKHQpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGQodCkgewogICAgICAgICAgICAgICAgICAgIHZhciBuOwogICAgICAgICAgICAgICAgICAgIHQuZG9uZSA/IHIodC52YWx1ZSkgOiAobiA9IHQudmFsdWUsIG4gaW5zdGFuY2VvZiBlID8gbiA6IG5ldyBlKChmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHQobikKICAgICAgICAgICAgICAgICAgICB9KSkpLnRoZW4oYSwgcykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGQoKGkgPSBpLmFwcGx5KHQsIG4gfHwgW10pKS5uZXh0KCkpCiAgICAgICAgICAgIH0pKQogICAgICAgIH0sCiAgICAgICAgdHQgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgICAgIHZhciBlLCBpLCByLCBvLCBhID0gewogICAgICAgICAgICAgICAgbGFiZWw6IDAsCiAgICAgICAgICAgICAgICBzZW50OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoMSAmIHJbMF0pIHRocm93IHJbMV07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJbMV0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB0cnlzOiBbXSwKICAgICAgICAgICAgICAgIG9wczogW10KICAgICAgICAgICAgfTsKICAgICAgICAgICAgcmV0dXJuIG8gPSB7CiAgICAgICAgICAgICAgICBuZXh0OiBzKDApLAogICAgICAgICAgICAgICAgdGhyb3c6IHMoMSksCiAgICAgICAgICAgICAgICByZXR1cm46IHMoMikKICAgICAgICAgICAgfSwgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIChvW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzCiAgICAgICAgICAgIH0pLCBvOwoKICAgICAgICAgICAgZnVuY3Rpb24gcyhvKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24ocykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihvKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoOyBhOykgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlID0gMSwgaSAmJiAociA9IDIgJiBvWzBdID8gaS5yZXR1cm4gOiBvWzBdID8gaS50aHJvdyB8fCAoKHIgPSBpLnJldHVybikgJiYgci5jYWxsKGkpLCAwKSA6IGkubmV4dCkgJiYgIShyID0gci5jYWxsKGksIG9bMV0pKS5kb25lKSByZXR1cm4gcjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoaSA9IDAsIHIgJiYgKG8gPSBbMiAmIG9bMF0sIHIudmFsdWVdKSwgb1swXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBvOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhLmxhYmVsKyssIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBvWzFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9uZTogITEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubGFiZWwrKywgaSA9IG9bMV0sIG8gPSBbMF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbyA9IGEub3BzLnBvcCgpLCBhLnRyeXMucG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHIgPSBhLnRyeXMsIChyID0gci5sZW5ndGggPiAwICYmIHJbci5sZW5ndGggLSAxXSkgfHwgNiAhPT0gb1swXSAmJiAyICE9PSBvWzBdKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgzID09PSBvWzBdICYmICghciB8fCBvWzFdID4gclswXSAmJiBvWzFdIDwgclszXSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubGFiZWwgPSBvWzFdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoNiA9PT0gb1swXSAmJiBhLmxhYmVsIDwgclsxXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5sYWJlbCA9IHJbMV0sIHIgPSBvOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAociAmJiBhLmxhYmVsIDwgclsyXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5sYWJlbCA9IHJbMl0sIGEub3BzLnB1c2gobyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJbMl0gJiYgYS5vcHMucG9wKCksIGEudHJ5cy5wb3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBuLmNhbGwodCwgYSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbyA9IFs2LCB0XSwgaSA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSByID0gMAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICg1ICYgb1swXSkgdGhyb3cgb1sxXTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBvWzBdID8gb1sxXSA6IHZvaWQgMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbmU6ICEwCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KFtvLCBzXSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgbnQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgZnVuY3Rpb24gdCh0KSB7CiAgICAgICAgICAgICAgICB2YXIgbiA9IHRoaXM7CiAgICAgICAgICAgICAgICB0aGlzLmJhbm5lclRpbWVvdXQgPSBudWxsLCB0aGlzLmFsbG93ZWRUb1BsYXlBZCA9ICExLCB0aGlzLnJ1bm5pbmdBZCA9ICExLCB0aGlzLmN1cnJlbnRXaWR0aCA9IDY0MCwgdGhpcy5jdXJyZW50SGVpZ2h0ID0gNDgwLCB0aGlzLmN1cnJlbnRSZXF1ZXN0SXNNdXRlZCA9ICExLCB0aGlzLnZvbHVtZSA9IDEsIHRoaXMuY2FuV2VBdXRvUGxheVdpdGhTb3VuZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAkKG4sIHZvaWQgMCwgdm9pZCAwLCAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0dCh0aGlzLCAoZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0LmxhYmVsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuYmxhbmtWaWRlbykgcmV0dXJuIFsyLCAhMV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQubGFiZWwgPSAxOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQudHJ5cy5wdXNoKFsxLCAzLCAsIDRdKSwgWzQsIHRoaXMuYmxhbmtWaWRlby5wbGF5KCldOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuc2VudCgpLCBbMiwgITBdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQuc2VudCgpLCBbMiwgITFdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyXQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgICAgIH0sIHRoaXMudmlkZW9FbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBva2lTREtWaWRlb0NvbnRhaW5lciIpLCB0aGlzLmFkc01hbmFnZXIgPSBudWxsLCB0aGlzLnZvbHVtZSA9IHQsIHRoaXMuaW5pdEFkRGlzcGxheUNvbnRhaW5lcigpLCB0aGlzLmluaXRCbGFua1ZpZGVvKCksIHRoaXMuaW5pdEFkc0xvYWRlcigpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHQucHJvdG90eXBlLmluaXRBZERpc3BsYXlDb250YWluZXIgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHRoaXMuYWREaXNwbGF5Q29udGFpbmVyIHx8ICh0aGlzLmFkRGlzcGxheUNvbnRhaW5lciA9IG5ldyBnb29nbGUuaW1hLkFkRGlzcGxheUNvbnRhaW5lcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicG9raVNES0FkQ29udGFpbmVyIiksIHRoaXMudmlkZW9FbGVtZW50KSkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuaW5pdEJsYW5rVmlkZW8gPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHRoaXMuYmxhbmtWaWRlbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInZpZGVvIiksIHRoaXMuYmxhbmtWaWRlby5zZXRBdHRyaWJ1dGUoInBsYXlzaW5saW5lIiwgInBsYXlzaW5saW5lIik7CiAgICAgICAgICAgICAgICB2YXIgdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNvdXJjZSIpOwogICAgICAgICAgICAgICAgdC5zcmMgPSAiZGF0YTp2aWRlby9tcDQ7YmFzZTY0LCBBQUFBSEdaMGVYQk5ORllnQUFBQ0FHbHpiMjFwYzI4eVlYWmpNUUFBQUFobWNtVmxBQUFHRjIxa1lYVGVCQUFBYkdsaVptRmhZeUF4TGpJNEFBQkNBSk1nQkRJQVJ3QUFBckVHQmYvL3JkeEY2YjNtMlVpM2xpellJTmtqN3U5NE1qWTBJQzBnWTI5eVpTQXhORElnY2pJZ09UVTJZemhrT0NBdElFZ3VNalkwTDAxUVJVY3ROQ0JCVmtNZ1kyOWtaV01nTFNCRGIzQjViR1ZtZENBeU1EQXpMVEl3TVRRZ0xTQm9kSFJ3T2k4dmQzZDNMblpwWkdWdmJHRnVMbTl5Wnk5NE1qWTBMbWgwYld3Z0xTQnZjSFJwYjI1ek9pQmpZV0poWXowd0lISmxaajB6SUdSbFlteHZZMnM5TVRvd09qQWdZVzVoYkhselpUMHdlREU2TUhneE1URWdiV1U5YUdWNElITjFZbTFsUFRjZ2NITjVQVEVnY0hONVgzSmtQVEV1TURBNk1DNHdNQ0J0YVhobFpGOXlaV1k5TVNCdFpWOXlZVzVuWlQweE5pQmphSEp2YldGZmJXVTlNU0IwY21Wc2JHbHpQVEVnT0hnNFpHTjBQVEFnWTNGdFBUQWdaR1ZoWkhwdmJtVTlNakVzTVRFZ1ptRnpkRjl3YzJ0cGNEMHhJR05vY205dFlWOXhjRjl2Wm1aelpYUTlMVElnZEdoeVpXRmtjejAySUd4dmIydGhhR1ZoWkY5MGFISmxZV1J6UFRFZ2MyeHBZMlZrWDNSb2NtVmhaSE05TUNCdWNqMHdJR1JsWTJsdFlYUmxQVEVnYVc1MFpYSnNZV05sWkQwd0lHSnNkWEpoZVY5amIyMXdZWFE5TUNCamIyNXpkSEpoYVc1bFpGOXBiblJ5WVQwd0lHSm1jbUZ0WlhNOU1DQjNaV2xuYUhSd1BUQWdhMlY1YVc1MFBUSTFNQ0JyWlhscGJuUmZiV2x1UFRJMUlITmpaVzVsWTNWMFBUUXdJR2x1ZEhKaFgzSmxabkpsYzJnOU1DQnlZMTlzYjI5cllXaGxZV1E5TkRBZ2NtTTlZM0ptSUcxaWRISmxaVDB4SUdOeVpqMHlNeTR3SUhGamIyMXdQVEF1TmpBZ2NYQnRhVzQ5TUNCeGNHMWhlRDAyT1NCeGNITjBaWEE5TkNCMlluWmZiV0Y0Y21GMFpUMDNOamdnZG1KMlgySjFabk5wZW1VOU16QXdNQ0JqY21aZmJXRjRQVEF1TUNCdVlXeGZhSEprUFc1dmJtVWdabWxzYkdWeVBUQWdhWEJmY21GMGFXODlNUzQwTUNCaGNUMHhPakV1TURBQWdBQUFBRlpsaUlRTDhtS0FBS3ZNbkp5Y25KeWNuSnljblhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhpRUFTWkFDR1FBamdDRUFTWkFDR1FBamdBQUFBQWRCbWpnWDRHU0FJUUJKa0FJWkFDT0FBQUFBQjBHYVZBWDRHU0FoQUVtUUFoa0FJNEFoQUVtUUFoa0FJNEFBQUFBR1FacGdMOERKSVFCSmtBSVpBQ09BSVFCSmtBSVpBQ09BQUFBQUJrR2FnQy9BeVNFQVNaQUNHUUFqZ0FBQUFBWkJtcUF2d01raEFFbVFBaGtBSTRBaEFFbVFBaGtBSTRBQUFBQUdRWnJBTDhESklRQkprQUlaQUNPQUFBQUFCa0dhNEMvQXlTRUFTWkFDR1FBamdDRUFTWkFDR1FBamdBQUFBQVpCbXdBdndNa2hBRW1RQWhrQUk0QUFBQUFHUVpzZ0w4REpJUUJKa0FJWkFDT0FJUUJKa0FJWkFDT0FBQUFBQmtHYlFDL0F5U0VBU1pBQ0dRQWpnQ0VBU1pBQ0dRQWpnQUFBQUFaQm0yQXZ3TWtoQUVtUUFoa0FJNEFBQUFBR1FadUFMOERKSVFCSmtBSVpBQ09BSVFCSmtBSVpBQ09BQUFBQUJrR2JvQy9BeVNFQVNaQUNHUUFqZ0FBQUFBWkJtOEF2d01raEFFbVFBaGtBSTRBaEFFbVFBaGtBSTRBQUFBQUdRWnZnTDhESklRQkprQUlaQUNPQUFBQUFCa0dhQUMvQXlTRUFTWkFDR1FBamdDRUFTWkFDR1FBamdBQUFBQVpCbWlBdndNa2hBRW1RQWhrQUk0QWhBRW1RQWhrQUk0QUFBQUFHUVpwQUw4REpJUUJKa0FJWkFDT0FBQUFBQmtHYVlDL0F5U0VBU1pBQ0dRQWpnQ0VBU1pBQ0dRQWpnQUFBQUFaQm1vQXZ3TWtoQUVtUUFoa0FJNEFBQUFBR1FacWdMOERKSVFCSmtBSVpBQ09BSVFCSmtBSVpBQ09BQUFBQUJrR2F3Qy9BeVNFQVNaQUNHUUFqZ0FBQUFBWkJtdUF2d01raEFFbVFBaGtBSTRBaEFFbVFBaGtBSTRBQUFBQUdRWnNBTDhESklRQkprQUlaQUNPQUFBQUFCa0diSUMvQXlTRUFTWkFDR1FBamdDRUFTWkFDR1FBamdBQUFBQVpCbTBBdndNa2hBRW1RQWhrQUk0QWhBRW1RQWhrQUk0QUFBQUFHUVp0Z0w4REpJUUJKa0FJWkFDT0FBQUFBQmtHYmdDdkF5U0VBU1pBQ0dRQWpnQ0VBU1pBQ0dRQWpnQUFBQUFaQm02QW53TWtoQUVtUUFoa0FJNEFoQUVtUUFoa0FJNEFoQUVtUUFoa0FJNEFoQUVtUUFoa0FJNEFBQUFodWJXOXZkZ0FBQUd4dGRtaGtBQUFBQUFBQUFBQUFBQUFBQUFBRDZBQUFCRGNBQVFBQUFRQUFBQUFBQUFBQUFBQUFBQUVBQUFBQUFBQUFBQUFBQUFBQUFBQUJBQUFBQUFBQUFBQUFBQUFBQUFCQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBd0FBQXpCMGNtRnJBQUFBWEhScmFHUUFBQUFEQUFBQUFBQUFBQUFBQUFBQkFBQUFBQUFBQStrQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFFQUFBQUFBQUFBQUFBQUFBQUFBQUFCQUFBQUFBQUFBQUFBQUFBQUFBQkFBQUFBQUxBQUFBQ1FBQUFBQUFBa1pXUjBjd0FBQUJ4bGJITjBBQUFBQUFBQUFBRUFBQVBwQUFBQUFBQUJBQUFBQUFLb2JXUnBZUUFBQUNCdFpHaGtBQUFBQUFBQUFBQUFBQUFBQUFCMU1BQUFkVTVWeEFBQUFBQUFMV2hrYkhJQUFBQUFBQUFBQUhacFpHVUFBQUFBQUFBQUFBQUFBQUJXYVdSbGIwaGhibVJzWlhJQUFBQUNVMjFwYm1ZQUFBQVVkbTFvWkFBQUFBRUFBQUFBQUFBQUFBQUFBQ1JrYVc1bUFBQUFIR1J5WldZQUFBQUFBQUFBQVFBQUFBeDFjbXdnQUFBQUFRQUFBaE56ZEdKc0FBQUFyM04wYzJRQUFBQUFBQUFBQVFBQUFKOWhkbU14QUFBQUFBQUFBQUVBQUFBQUFBQUFBQUFBQUFBQUFBQUFBTEFBa0FCSUFBQUFTQUFBQUFBQUFBQUJBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUdQLy9BQUFBTFdGMlkwTUJRc0FOLytFQUZXZEN3QTNaQXNUc0JFQUFBUHBBQURxWUE4VUtrZ0VBQldqTGc4c2dBQUFBSEhWMWFXUnJhRUR5WHlSUHhibzVwUnZQQXlQekFBQUFBQUFBQUJoemRIUnpBQUFBQUFBQUFBRUFBQUFlQUFBRDZRQUFBQlJ6ZEhOekFBQUFBQUFBQUFFQUFBQUJBQUFBSEhOMGMyTUFBQUFBQUFBQUFRQUFBQUVBQUFBQkFBQUFBUUFBQUl4emRITjZBQUFBQUFBQUFBQUFBQUFlQUFBRER3QUFBQXNBQUFBTEFBQUFDZ0FBQUFvQUFBQUtBQUFBQ2dBQUFBb0FBQUFLQUFBQUNnQUFBQW9BQUFBS0FBQUFDZ0FBQUFvQUFBQUtBQUFBQ2dBQUFBb0FBQUFLQUFBQUNnQUFBQW9BQUFBS0FBQUFDZ0FBQUFvQUFBQUtBQUFBQ2dBQUFBb0FBQUFLQUFBQUNnQUFBQW9BQUFBS0FBQUFpSE4wWTI4QUFBQUFBQUFBSGdBQUFFWUFBQU5uQUFBRGV3QUFBNWdBQUFPMEFBQUR4d0FBQStNQUFBUDJBQUFFRWdBQUJDVUFBQVJCQUFBRVhRQUFCSEFBQUFTTUFBQUVud0FBQkxzQUFBVE9BQUFFNmdBQUJRWUFBQVVaQUFBRk5RQUFCVWdBQUFWa0FBQUZkd0FBQlpNQUFBV21BQUFGd2dBQUJkNEFBQVh4QUFBR0RRQUFCR2gwY21GckFBQUFYSFJyYUdRQUFBQURBQUFBQUFBQUFBQUFBQUFDQUFBQUFBQUFCRGNBQUFBQUFBQUFBQUFBQUFFQkFBQUFBQUVBQUFBQUFBQUFBQUFBQUFBQUFBQUJBQUFBQUFBQUFBQUFBQUFBQUFCQUFBQUFBQUFBQUFBQUFBQUFBQUFrWldSMGN3QUFBQnhsYkhOMEFBQUFBQUFBQUFFQUFBUWtBQUFEY0FBQkFBQUFBQVBnYldScFlRQUFBQ0J0Wkdoa0FBQUFBQUFBQUFBQUFBQUFBQUM3Z0FBQXlrQlZ4QUFBQUFBQUxXaGtiSElBQUFBQUFBQUFBSE52ZFc0QUFBQUFBQUFBQUFBQUFBQlRiM1Z1WkVoaGJtUnNaWElBQUFBRGkyMXBibVlBQUFBUWMyMW9aQUFBQUFBQUFBQUFBQUFBSkdScGJtWUFBQUFjWkhKbFpnQUFBQUFBQUFBQkFBQUFESFZ5YkNBQUFBQUJBQUFEVDNOMFltd0FBQUJuYzNSelpBQUFBQUFBQUFBQkFBQUFWMjF3TkdFQUFBQUFBQUFBQVFBQUFBQUFBQUFBQUFJQUVBQUFBQUM3Z0FBQUFBQUFNMlZ6WkhNQUFBQUFBNENBZ0NJQUFnQUVnSUNBRkVBVkJiallBQXU0QUFBQURjb0ZnSUNBQWhHUUJvQ0FnQUVDQUFBQUlITjBkSE1BQUFBQUFBQUFBZ0FBQURJQUFBUUFBQUFBQVFBQUFrQUFBQUZVYzNSell3QUFBQUFBQUFBYkFBQUFBUUFBQUFFQUFBQUJBQUFBQWdBQUFBSUFBQUFCQUFBQUF3QUFBQUVBQUFBQkFBQUFCQUFBQUFJQUFBQUJBQUFBQmdBQUFBRUFBQUFCQUFBQUJ3QUFBQUlBQUFBQkFBQUFDQUFBQUFFQUFBQUJBQUFBQ1FBQUFBSUFBQUFCQUFBQUNnQUFBQUVBQUFBQkFBQUFDd0FBQUFJQUFBQUJBQUFBRFFBQUFBRUFBQUFCQUFBQURnQUFBQUlBQUFBQkFBQUFEd0FBQUFFQUFBQUJBQUFBRUFBQUFBSUFBQUFCQUFBQUVRQUFBQUVBQUFBQkFBQUFFZ0FBQUFJQUFBQUJBQUFBRkFBQUFBRUFBQUFCQUFBQUZRQUFBQUlBQUFBQkFBQUFGZ0FBQUFFQUFBQUJBQUFBRndBQUFBSUFBQUFCQUFBQUdBQUFBQUVBQUFBQkFBQUFHUUFBQUFJQUFBQUJBQUFBR2dBQUFBRUFBQUFCQUFBQUd3QUFBQUlBQUFBQkFBQUFIUUFBQUFFQUFBQUJBQUFBSGdBQUFBSUFBQUFCQUFBQUh3QUFBQVFBQUFBQkFBQUE0SE4wYzNvQUFBQUFBQUFBQUFBQUFETUFBQUFhQUFBQUNRQUFBQWtBQUFBSkFBQUFDUUFBQUFrQUFBQUpBQUFBQ1FBQUFBa0FBQUFKQUFBQUNRQUFBQWtBQUFBSkFBQUFDUUFBQUFrQUFBQUpBQUFBQ1FBQUFBa0FBQUFKQUFBQUNRQUFBQWtBQUFBSkFBQUFDUUFBQUFrQUFBQUpBQUFBQ1FBQUFBa0FBQUFKQUFBQUNRQUFBQWtBQUFBSkFBQUFDUUFBQUFrQUFBQUpBQUFBQ1FBQUFBa0FBQUFKQUFBQUNRQUFBQWtBQUFBSkFBQUFDUUFBQUFrQUFBQUpBQUFBQ1FBQUFBa0FBQUFKQUFBQUNRQUFBQWtBQUFBSkFBQUFDUUFBQUFrQUFBQ01jM1JqYndBQUFBQUFBQUFmQUFBQUxBQUFBMVVBQUFOeUFBQURoZ0FBQTZJQUFBTytBQUFEMFFBQUErMEFBQVFBQUFBRUhBQUFCQzhBQUFSTEFBQUVad0FBQkhvQUFBU1dBQUFFcVFBQUJNVUFBQVRZQUFBRTlBQUFCUkFBQUFVakFBQUZQd0FBQlZJQUFBVnVBQUFGZ1FBQUJaMEFBQVd3QUFBRnpBQUFCZWdBQUFYN0FBQUdGd0FBQUdKMVpIUmhBQUFBV20xbGRHRUFBQUFBQUFBQUlXaGtiSElBQUFBQUFBQUFBRzFrYVhKaGNIQnNBQUFBQUFBQUFBQUFBQUFBTFdsc2MzUUFBQUFscVhSdmJ3QUFBQjFrWVhSaEFBQUFBUUFBQUFCTVlYWm1OVFV1TXpNdU1UQXciLCB0aGlzLmJsYW5rVmlkZW8uYXBwZW5kQ2hpbGQodCkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuaW5pdEFkc0xvYWRlciA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFyIHQgPSB0aGlzOwogICAgICAgICAgICAgICAgdGhpcy5hZHNMb2FkZXIgfHwgKHRoaXMuYWRzTG9hZGVyID0gbmV3IGdvb2dsZS5pbWEuQWRzTG9hZGVyKHRoaXMuYWREaXNwbGF5Q29udGFpbmVyKSwgdGhpcy5hZHNMb2FkZXIuZ2V0U2V0dGluZ3MoKS5zZXRWcGFpZE1vZGUoZ29vZ2xlLmltYS5JbWFTZGtTZXR0aW5ncy5WcGFpZE1vZGUuSU5TRUNVUkUpLCB0aGlzLmFkc0xvYWRlci5nZXRTZXR0aW5ncygpLnNldERpc2FibGVDdXN0b21QbGF5YmFja0ZvcklPUzEwUGx1cyghMCksIHRoaXMuYWRzTG9hZGVyLmFkZEV2ZW50TGlzdGVuZXIoZ29vZ2xlLmltYS5BZHNNYW5hZ2VyTG9hZGVkRXZlbnQuVHlwZS5BRFNfTUFOQUdFUl9MT0FERUQsIHRoaXMub25BZHNNYW5hZ2VyTG9hZGVkLCAhMSwgdGhpcyksIHRoaXMuYWRzTG9hZGVyLmFkZEV2ZW50TGlzdGVuZXIoZ29vZ2xlLmltYS5BZEVycm9yRXZlbnQuVHlwZS5BRF9FUlJPUiwgdGhpcy5vbkFkTG9hZGVyRXJyb3IsICExLCB0aGlzKSwgdGhpcy52aWRlb0VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigib25lbmRlZCIsIChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5hZHNMb2FkZXIuY29udGVudENvbXBsZXRlKCkKICAgICAgICAgICAgICAgIH0pKSkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUucmVxdWVzdEFkID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgcmV0dXJuICQodGhpcywgdm9pZCAwLCB2b2lkIDAsIChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgbjsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHQodGhpcywgKGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChlLmxhYmVsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucnVubmluZ0FkID8gWzJdIDogKHRoaXMucnVubmluZ0FkID0gITAsIHRoaXMuYWREaXNwbGF5Q29udGFpbmVyLmluaXRpYWxpemUoKSwgdGhpcy52aWRlb0VsZW1lbnQuc3JjID0gIiIsIChuID0gbmV3IGdvb2dsZS5pbWEuQWRzUmVxdWVzdCkuYWRUYWdVcmwgPSB0LCBuLmxpbmVhckFkU2xvdFdpZHRoID0gdGhpcy5jdXJyZW50V2lkdGgsIG4ubGluZWFyQWRTbG90SGVpZ2h0ID0gdGhpcy5jdXJyZW50SGVpZ2h0LCBuLm5vbkxpbmVhckFkU2xvdFdpZHRoID0gdGhpcy5jdXJyZW50V2lkdGgsIG4ubm9uTGluZWFyQWRTbG90SGVpZ2h0ID0gdGhpcy5jdXJyZW50SGVpZ2h0LCBuLmZvcmNlTm9uTGluZWFyRnVsbFNsb3QgPSAhMCwgWzQsIHRoaXMuY2FuV2VBdXRvUGxheVdpdGhTb3VuZCgpXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUuc2VudCgpID8gKG4uc2V0QWRXaWxsUGxheU11dGVkKCExKSwgdGhpcy5jdXJyZW50UmVxdWVzdElzTXV0ZWQgPSAhMSkgOiAobi5zZXRBZFdpbGxQbGF5TXV0ZWQoITApLCB0aGlzLmN1cnJlbnRSZXF1ZXN0SXNNdXRlZCA9ICEwKSwgdGhpcy5hbGxvd2VkVG9QbGF5QWQgPSAhMCwgdGhpcy5hZHNMb2FkZXIucmVxdWVzdEFkcyhuKSwgWzJdCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICAgICAgICAgICAgICB2b2lkIDAgPT09IGUgJiYgKGUgPSBnb29nbGUuaW1hLlZpZXdNb2RlLk5PUk1BTCksIHRoaXMuY3VycmVudFdpZHRoID0gdCwgdGhpcy5jdXJyZW50SGVpZ2h0ID0gbiwgdGhpcy5hZHNNYW5hZ2VyICYmIHRoaXMuYWRzTWFuYWdlci5yZXNpemUodCwgbiwgZSkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUub25BZHNNYW5hZ2VyTG9hZGVkID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdmFyIG4gPSBuZXcgZ29vZ2xlLmltYS5BZHNSZW5kZXJpbmdTZXR0aW5nczsKICAgICAgICAgICAgICAgIG4uZW5hYmxlUHJlbG9hZGluZyA9ICEwLCBuLnJlc3RvcmVDdXN0b21QbGF5YmFja1N0YXRlT25BZEJyZWFrQ29tcGxldGUgPSAhMCwgbi5taW1lVHlwZXMgPSB6KCkgfHwgRSgpIHx8IHgoKSA/IFsidmlkZW8vbXA0Il0gOiBbInZpZGVvL21wNCIsICJ2aWRlby93ZWJtIiwgInZpZGVvL29nZyJdLCB0aGlzLmFkc01hbmFnZXIgPSB0LmdldEFkc01hbmFnZXIodGhpcy52aWRlb0VsZW1lbnQsIG4pLCB0aGlzLmFkc01hbmFnZXIuc2V0Vm9sdW1lKE1hdGgubWF4KDAsIE1hdGgubWluKDEsIHRoaXMudm9sdW1lKSkpLCB0aGlzLmN1cnJlbnRSZXF1ZXN0SXNNdXRlZCAmJiB0aGlzLmFkc01hbmFnZXIuc2V0Vm9sdW1lKDApLCB0aGlzLmFsbG93ZWRUb1BsYXlBZCA/ICh0aGlzLmF0dGFjaEFkRXZlbnRzKCksIGYuZGlzcGF0Y2hFdmVudChBLmFkcy5yZWFkeSkpIDogdGhpcy50ZWFyRG93bigpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLnNldFZvbHVtZSA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHRoaXMudm9sdW1lID0gdCwgdGhpcy5hZHNNYW5hZ2VyICYmIHRoaXMuYWRzTWFuYWdlci5zZXRWb2x1bWUoTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgdGhpcy52b2x1bWUpKSkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuc3RhcnRQbGF5YmFjayA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmFkc01hbmFnZXIuaW5pdCh0aGlzLmN1cnJlbnRXaWR0aCwgdGhpcy5jdXJyZW50SGVpZ2h0LCBnb29nbGUuaW1hLlZpZXdNb2RlLk5PUk1BTCksIHRoaXMuYWRzTWFuYWdlci5zdGFydCgpCiAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy52aWRlb0VsZW1lbnQucGxheSgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLnN0YXJ0SU9TUGxheWJhY2sgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHRoaXMuYWRzTWFuYWdlci5zdGFydCgpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLnN0b3BQbGF5YmFjayA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgZi5kaXNwYXRjaEV2ZW50KEEuYWRzLnN0b3BwZWQpLCB0aGlzLnRlYXJEb3duKCkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUucmVzdW1lQWQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIGYuZGlzcGF0Y2hFdmVudChBLmFkcy52aWRlby5yZXN1bWVkKSwgdGhpcy5hZHNNYW5hZ2VyICYmIHRoaXMuYWRzTWFuYWdlci5yZXN1bWUoKQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS50ZWFyRG93biA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdGhpcy5hZHNNYW5hZ2VyICYmICh0aGlzLmFkc01hbmFnZXIuc3RvcCgpLCB0aGlzLmFkc01hbmFnZXIuZGVzdHJveSgpLCB0aGlzLmFkc01hbmFnZXIgPSBudWxsKSwgbnVsbCAhPT0gdGhpcy5iYW5uZXJUaW1lb3V0ICYmIChjbGVhclRpbWVvdXQodGhpcy5iYW5uZXJUaW1lb3V0KSwgdGhpcy5iYW5uZXJUaW1lb3V0ID0gbnVsbCksIHRoaXMuYWRzTG9hZGVyICYmICh0aGlzLmFkc0xvYWRlci5jb250ZW50Q29tcGxldGUoKSwgdGhpcy5hZHNMb2FkZXIuZGVzdHJveSgpLCB0aGlzLmFkc0xvYWRlciA9IG51bGwsIHRoaXMuaW5pdEFkc0xvYWRlcigpKSwgdGhpcy5ydW5uaW5nQWQgPSAhMQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5hdHRhY2hBZEV2ZW50cyA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFyIHQgPSB0aGlzLAogICAgICAgICAgICAgICAgICAgIG4gPSBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZTsKICAgICAgICAgICAgICAgIHRoaXMuYWRzTWFuYWdlci5hZGRFdmVudExpc3RlbmVyKGdvb2dsZS5pbWEuQWRFcnJvckV2ZW50LlR5cGUuQURfRVJST1IsIHRoaXMub25BZEVycm9yLCAhMSwgdGhpcyksIFtuLkFEX1BST0dSRVNTLCBuLkFMTF9BRFNfQ09NUExFVEVELCBuLkNMSUNLLCBuLkNPTVBMRVRFLCBuLklNUFJFU1NJT04sIG4uUEFVU0VELCBuLlNLSVBQRUQsIG4uU1RBUlRFRCwgbi5VU0VSX0NMT1NFLCBuLkFEX0JVRkZFUklOR10uZm9yRWFjaCgoZnVuY3Rpb24obikgewogICAgICAgICAgICAgICAgICAgIHQuYWRzTWFuYWdlci5hZGRFdmVudExpc3RlbmVyKG4sIHQub25BZEV2ZW50LCAhMSwgdCkKICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5vbkFkRXZlbnQgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICB2YXIgbiA9IHRoaXMsCiAgICAgICAgICAgICAgICAgICAgZSA9IHQuZ2V0QWQoKTsKICAgICAgICAgICAgICAgIHN3aXRjaCAodC50eXBlKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5BRF9QUk9HUkVTUzoKICAgICAgICAgICAgICAgICAgICAgICAgZi5kaXNwYXRjaEV2ZW50KEEuYWRzLnZpZGVvLnByb2dyZXNzLCB0LmdldEFkRGF0YSgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5TVEFSVEVEOgogICAgICAgICAgICAgICAgICAgICAgICB0LnJlbWFpbmluZ1RpbWUgPSB0aGlzLmFkc01hbmFnZXIuZ2V0UmVtYWluaW5nVGltZSgpLCB0LnJlbWFpbmluZ1RpbWUgPD0gMCAmJiAodC5yZW1haW5pbmdUaW1lID0gMTUpLCBlLmlzTGluZWFyKCkgfHwgKHRoaXMuYmFubmVyVGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGYuZGlzcGF0Y2hFdmVudChBLmFkcy5jb21wbGV0ZWQsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXdhcmRBbGxvd2VkOiAhIXQucmV3YXJkQWxsb3dlZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksIG4udGVhckRvd24oKQogICAgICAgICAgICAgICAgICAgICAgICB9KSwgMWUzICogKHQucmVtYWluaW5nVGltZSArIDEpKSksIGYuZGlzcGF0Y2hFdmVudChBLmFkcy5zdGFydGVkLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGl2ZUlkOiBlLmdldENyZWF0aXZlSWQoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkSWQ6IGUuZ2V0QWRJZCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IGUuZ2V0RHVyYXRpb24oKQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5DT01QTEVURToKICAgICAgICAgICAgICAgICAgICAgICAgZi5kaXNwYXRjaEV2ZW50KEEuYWRzLmNvbXBsZXRlZCwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV3YXJkQWxsb3dlZDogITAKICAgICAgICAgICAgICAgICAgICAgICAgfSksIHRoaXMudGVhckRvd24oKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5BTExfQURTX0NPTVBMRVRFRDoKICAgICAgICAgICAgICAgICAgICBjYXNlIGdvb2dsZS5pbWEuQWRFdmVudC5UeXBlLlVTRVJfQ0xPU0U6CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGVhckRvd24oKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5QQVVTRUQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYWRzTWFuYWdlci5wYXVzZSgpLCBmLmRpc3BhdGNoRXZlbnQoQS5hZHMudmlkZW8ucGF1c2VkKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5BRF9CVUZGRVJJTkc6CiAgICAgICAgICAgICAgICAgICAgICAgIGYuZGlzcGF0Y2hFdmVudChBLmFkcy52aWRlby5idWZmZXJpbmcpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIGdvb2dsZS5pbWEuQWRFdmVudC5UeXBlLkNMSUNLOgogICAgICAgICAgICAgICAgICAgICAgICBmLmRpc3BhdGNoRXZlbnQoQS5hZHMudmlkZW8uY2xpY2tlZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGUuU0tJUFBFRDoKICAgICAgICAgICAgICAgICAgICAgICAgZi5kaXNwYXRjaEV2ZW50KEEuYWRzLnNraXBwZWQpLCBmLmRpc3BhdGNoRXZlbnQoQS5hZHMuY29tcGxldGVkKSwgZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAmJiBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5JTVBSRVNTSU9OOgogICAgICAgICAgICAgICAgICAgICAgICBmLmRpc3BhdGNoRXZlbnQoQS5hZHMuaW1wcmVzc2lvbiwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNlclZhbHVlSW5kaWNhdG9yOiBaKGYuZ2V0RGF0YUFubm90YXRpb25zKCkucG9zaXRpb24gPT09IEEuYWRzLnBvc2l0aW9uLnJld2FyZGVkID8gInJld2FyZGVkIiA6ICJ2aWRlbyIpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLm9uQWRMb2FkZXJFcnJvciA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHRoaXMudGVhckRvd24oKTsKICAgICAgICAgICAgICAgIHZhciBuID0gdC5nZXRFcnJvciAmJiB0LmdldEVycm9yKCkudG9TdHJpbmcoKSB8fCAiVW5rbm93biI7CiAgICAgICAgICAgICAgICBmLmRpc3BhdGNoRXZlbnQoQS5hZHMudmlkZW8ubG9hZGVyRXJyb3IsIHsKICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBuCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5vbkFkRXJyb3IgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICB0aGlzLnRlYXJEb3duKCk7CiAgICAgICAgICAgICAgICB2YXIgbiA9IHQuZ2V0RXJyb3IgJiYgdC5nZXRFcnJvcigpLnRvU3RyaW5nKCkgfHwgIlVua25vd24iOwogICAgICAgICAgICAgICAgZi5kaXNwYXRjaEV2ZW50KEEuYWRzLnZpZGVvLmVycm9yLCB7CiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogbgogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUubXV0ZUFkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2b2lkIDAgIT09IHRoaXMuYWRzTWFuYWdlciAmJiBudWxsICE9IHRoaXMuYWRzTWFuYWdlciAmJiB0aGlzLmFkc01hbmFnZXIuc2V0Vm9sdW1lKDApCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLmlzQWRSdW5uaW5nID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5ydW5uaW5nQWQKICAgICAgICAgICAgfSwgdAogICAgICAgIH0oKSwKICAgICAgICBldCA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChmdW5jdGlvbihuLCBlKSB7CiAgICAgICAgICAgICAgICB2YXIgaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpOwogICAgICAgICAgICAgICAgaS50eXBlID0gInRleHQvamF2YXNjcmlwdCIsIGkuYXN5bmMgPSAhMCwgaS5zcmMgPSB0OwogICAgICAgICAgICAgICAgdmFyIHIgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICBpLnJlYWR5U3RhdGUgJiYgImxvYWRlZCIgIT09IGkucmVhZHlTdGF0ZSAmJiAiY29tcGxldGUiICE9PSBpLnJlYWR5U3RhdGUgfHwgKG4oKSwgaS5vbmxvYWQgPSBudWxsLCBpLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGwpCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgaS5vbmxvYWQgPSByLCBpLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IHIsIGkub25lcnJvciA9IGUsIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoaSkKICAgICAgICAgICAgfSkpCiAgICAgICAgfSwKICAgICAgICBpdCA9IGZ1bmN0aW9uKHQsIG4sIGUsIGkpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyhlIHx8IChlID0gUHJvbWlzZSkpKChmdW5jdGlvbihyLCBvKSB7CiAgICAgICAgICAgICAgICBmdW5jdGlvbiBhKHQpIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBkKGkubmV4dCh0KSkKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG8odCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gcyh0KSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgZChpLnRocm93KHQpKQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbyh0KQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBkKHQpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgbjsKICAgICAgICAgICAgICAgICAgICB0LmRvbmUgPyByKHQudmFsdWUpIDogKG4gPSB0LnZhbHVlLCBuIGluc3RhbmNlb2YgZSA/IG4gOiBuZXcgZSgoZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICB0KG4pCiAgICAgICAgICAgICAgICAgICAgfSkpKS50aGVuKGEsIHMpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkKChpID0gaS5hcHBseSh0LCBuIHx8IFtdKSkubmV4dCgpKQogICAgICAgICAgICB9KSkKICAgICAgICB9LAogICAgICAgIHJ0ID0gZnVuY3Rpb24odCwgbikgewogICAgICAgICAgICB2YXIgZSwgaSwgciwgbywgYSA9IHsKICAgICAgICAgICAgICAgIGxhYmVsOiAwLAogICAgICAgICAgICAgICAgc2VudDogZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKDEgJiByWzBdKSB0aHJvdyByWzFdOwogICAgICAgICAgICAgICAgICAgIHJldHVybiByWzFdCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgdHJ5czogW10sCiAgICAgICAgICAgICAgICBvcHM6IFtdCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHJldHVybiBvID0gewogICAgICAgICAgICAgICAgbmV4dDogcygwKSwKICAgICAgICAgICAgICAgIHRocm93OiBzKDEpLAogICAgICAgICAgICAgICAgcmV0dXJuOiBzKDIpCiAgICAgICAgICAgIH0sICJmdW5jdGlvbiIgPT0gdHlwZW9mIFN5bWJvbCAmJiAob1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcwogICAgICAgICAgICB9KSwgbzsKCiAgICAgICAgICAgIGZ1bmN0aW9uIHMobykgewogICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHMpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24obykgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSkgdGhyb3cgbmV3IFR5cGVFcnJvcigiR2VuZXJhdG9yIGlzIGFscmVhZHkgZXhlY3V0aW5nLiIpOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKDsgYTspIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZSA9IDEsIGkgJiYgKHIgPSAyICYgb1swXSA/IGkucmV0dXJuIDogb1swXSA/IGkudGhyb3cgfHwgKChyID0gaS5yZXR1cm4pICYmIHIuY2FsbChpKSwgMCkgOiBpLm5leHQpICYmICEociA9IHIuY2FsbChpLCBvWzFdKSkuZG9uZSkgcmV0dXJuIHI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGkgPSAwLCByICYmIChvID0gWzIgJiBvWzBdLCByLnZhbHVlXSksIG9bMF0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByID0gbzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYS5sYWJlbCsrLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogb1sxXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbmU6ICExCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmxhYmVsKyssIGkgPSBvWzFdLCBvID0gWzBdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBhLm9wcy5wb3AoKSwgYS50cnlzLnBvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShyID0gYS50cnlzLCAociA9IHIubGVuZ3RoID4gMCAmJiByW3IubGVuZ3RoIC0gMV0pIHx8IDYgIT09IG9bMF0gJiYgMiAhPT0gb1swXSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoMyA9PT0gb1swXSAmJiAoIXIgfHwgb1sxXSA+IHJbMF0gJiYgb1sxXSA8IHJbM10pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmxhYmVsID0gb1sxXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDYgPT09IG9bMF0gJiYgYS5sYWJlbCA8IHJbMV0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubGFiZWwgPSByWzFdLCByID0gbzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHIgJiYgYS5sYWJlbCA8IHJbMl0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubGFiZWwgPSByWzJdLCBhLm9wcy5wdXNoKG8pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByWzJdICYmIGEub3BzLnBvcCgpLCBhLnRyeXMucG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvID0gbi5jYWxsKHQsIGEpCiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBbNiwgdF0sIGkgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gciA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoNSAmIG9bMF0pIHRocm93IG9bMV07CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogb1swXSA/IG9bMV0gOiB2b2lkIDAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lOiAhMAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfShbbywgc10pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9OwogICAgdmFyIG90ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHZhciB0ID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lOwogICAgICAgICAgICAiLyIgIT09IHRbMF0gJiYgKHQgPSAiLyIgKyB0KTsKICAgICAgICAgICAgdmFyIG4gPSBlbmNvZGVVUklDb21wb25lbnQod2luZG93LmxvY2F0aW9uLnByb3RvY29sICsgIi8vIiArIHdpbmRvdy5sb2NhdGlvbi5ob3N0ICsgdCArIHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpLAogICAgICAgICAgICAgICAgZSA9IGVuY29kZVVSSUNvbXBvbmVudChkb2N1bWVudC5yZWZlcnJlcik7CiAgICAgICAgICAgIHJldHVybiBmZXRjaCgiIiwgewogICAgICAgICAgICAgICAgbWV0aG9kOiAiR0VUIiwKICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAiQ29udGVudC1UeXBlIjogInRleHQvcGxhaW4iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLnRoZW4oKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBpdCh2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG47CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJ0KHRoaXMsIChmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZS5sYWJlbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0LnN0YXR1cyA+PSAyMDAgJiYgdC5zdGF0dXMgPCA0MDAgPyBbNCwgdC5qc29uKCldIDogWzMsIDJdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAobiA9IGUuc2VudCgpKS5nYW1lX2lkID8gWzIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZUlkOiBuLmdhbWVfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkVGltaW5nOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVyb2xsOiBuLmFkX3NldHRpbmdzLnByZXJvbGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lUGVyVHJ5OiBuLmFkX3NldHRpbmdzLnRpbWVfcGVyX3RyeSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVCZXR3ZWVuQWRzOiBuLmFkX3NldHRpbmdzLnRpbWVfYmV0d2Vlbl9hZHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydEFkc0FmdGVyOiBuLmFkX3NldHRpbmdzLnN0YXJ0X2Fkc19hZnRlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfV0gOiBbMiwgdm9pZCAwXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyB0CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICB9KSkuY2F0Y2goKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0KHRoaXMsIHZvaWQgMCwgdm9pZCAwLCAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuLCBlLCBpLCByLCBvLCBhLCBzLCBkLCBjLCB1LCBsLCBBOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcnQodGhpcywgKGZ1bmN0aW9uKG0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAobS5sYWJlbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG0udHJ5cy5wdXNoKFswLCAzLCAsIDRdKSwgIi8iICE9PSAobiA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSlbMF0gJiYgKG4gPSAiLyIgKyBuKSwgciA9IChpID0gSlNPTikuc3RyaW5naWZ5LCBvID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYzogInNkay1wNGQtZXJyb3IiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmU6IDcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgYSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGs6ICJlcnJvciIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZCA9IChzID0gSlNPTikuc3RyaW5naWZ5LCBjID0gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB0LnN0YXR1cwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAodSA9IHQuanNvbikgPyBbNCwgdC5qc29uKCldIDogWzMsIDJdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdSA9IG0uc2VudCgpLCBtLmxhYmVsID0gMjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlID0gci5hcHBseShpLCBbKG8uZCA9IFsoYS52ID0gZC5hcHBseShzLCBbKGMuanNvbiA9IHUsIGMuYm9keSA9IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBocmVmOiB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgKyAiLy8iICsgd2luZG93LmxvY2F0aW9uLmhvc3QgKyBuICsgd2luZG93LmxvY2F0aW9uLnNlYXJjaAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSksIGMubmFtZSA9IHQubmFtZSwgYy5tZXNzYWdlID0gdC5tZXNzYWdlLCBjKV0pLCBhKV0sIG8pXSksIGwgPSAiIiwgbmF2aWdhdG9yLnNlbmRCZWFjb24pIG5hdmlnYXRvci5zZW5kQmVhY29uKGwsIGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoQSA9IG5ldyBYTUxIdHRwUmVxdWVzdCkub3BlbigiUE9TVCIsIGwsICEwKSwgQS5zZW5kKGUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHt9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMywgNF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbS5zZW50KCksIFszLCA0XTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbMl0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSkpCiAgICAgICAgICAgICAgICAgICAgfSkpCiAgICAgICAgICAgICAgICB9KHQpCiAgICAgICAgICAgIH0pKQogICAgICAgIH0sCiAgICAgICAgYXQgPSBmdW5jdGlvbih0LCBuLCBlLCBpKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcoZSB8fCAoZSA9IFByb21pc2UpKSgoZnVuY3Rpb24ociwgbykgewogICAgICAgICAgICAgICAgZnVuY3Rpb24gYSh0KSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgZChpLm5leHQodCkpCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICAgICAgICAgICAgICBvKHQpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIHModCkgewogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGQoaS50aHJvdyh0KSkKICAgICAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG8odCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gZCh0KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG47CiAgICAgICAgICAgICAgICAgICAgdC5kb25lID8gcih0LnZhbHVlKSA6IChuID0gdC52YWx1ZSwgbiBpbnN0YW5jZW9mIGUgPyBuIDogbmV3IGUoKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdChuKQogICAgICAgICAgICAgICAgICAgIH0pKSkudGhlbihhLCBzKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZCgoaSA9IGkuYXBwbHkodCwgbiB8fCBbXSkpLm5leHQoKSkKICAgICAgICAgICAgfSkpCiAgICAgICAgfSwKICAgICAgICBzdCA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgdmFyIGUsIGksIHIsIG8sIGEgPSB7CiAgICAgICAgICAgICAgICBsYWJlbDogMCwKICAgICAgICAgICAgICAgIHNlbnQ6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIGlmICgxICYgclswXSkgdGhyb3cgclsxXTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gclsxXQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHRyeXM6IFtdLAogICAgICAgICAgICAgICAgb3BzOiBbXQogICAgICAgICAgICB9OwogICAgICAgICAgICByZXR1cm4gbyA9IHsKICAgICAgICAgICAgICAgIG5leHQ6IHMoMCksCiAgICAgICAgICAgICAgICB0aHJvdzogcygxKSwKICAgICAgICAgICAgICAgIHJldHVybjogcygyKQogICAgICAgICAgICB9LCAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgKG9bU3ltYm9sLml0ZXJhdG9yXSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMKICAgICAgICAgICAgfSksIG87CgogICAgICAgICAgICBmdW5jdGlvbiBzKG8pIHsKICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihzKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKG8pIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUpIHRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yICg7IGE7KSB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUgPSAxLCBpICYmIChyID0gMiAmIG9bMF0gPyBpLnJldHVybiA6IG9bMF0gPyBpLnRocm93IHx8ICgociA9IGkucmV0dXJuKSAmJiByLmNhbGwoaSksIDApIDogaS5uZXh0KSAmJiAhKHIgPSByLmNhbGwoaSwgb1sxXSkpLmRvbmUpIHJldHVybiByOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChpID0gMCwgciAmJiAobyA9IFsyICYgb1swXSwgci52YWx1ZV0pLCBvWzBdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgciA9IG87CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEubGFiZWwrKywgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG9bMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lOiAhMQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5sYWJlbCsrLCBpID0gb1sxXSwgbyA9IFswXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvID0gYS5vcHMucG9wKCksIGEudHJ5cy5wb3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEociA9IGEudHJ5cywgKHIgPSByLmxlbmd0aCA+IDAgJiYgcltyLmxlbmd0aCAtIDFdKSB8fCA2ICE9PSBvWzBdICYmIDIgIT09IG9bMF0pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDMgPT09IG9bMF0gJiYgKCFyIHx8IG9bMV0gPiByWzBdICYmIG9bMV0gPCByWzNdKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5sYWJlbCA9IG9bMV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICg2ID09PSBvWzBdICYmIGEubGFiZWwgPCByWzFdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmxhYmVsID0gclsxXSwgciA9IG87CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyICYmIGEubGFiZWwgPCByWzJdKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhLmxhYmVsID0gclsyXSwgYS5vcHMucHVzaChvKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgclsyXSAmJiBhLm9wcy5wb3AoKSwgYS50cnlzLnBvcCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbyA9IG4uY2FsbCh0LCBhKQogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvID0gWzYsIHRdLCBpID0gMAogICAgICAgICAgICAgICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IHIgPSAwCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDUgJiBvWzBdKSB0aHJvdyBvWzFdOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG9bMF0gPyBvWzFdIDogdm9pZCAwLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9uZTogITAKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0oW28sIHNdKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICBmdW5jdGlvbiBkdCgpIHsKICAgICAgICByZXR1cm4gYXQodGhpcywgdm9pZCAwLCBQcm9taXNlLCAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHZhciB0OwogICAgICAgICAgICByZXR1cm4gc3QodGhpcywgKGZ1bmN0aW9uKG4pIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAobi5sYWJlbCkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4udHJ5cy5wdXNoKFswLCAzLCAsIDRdKSwgWzQsIGZldGNoKCIiLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICJHRVQiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAidGV4dC9wbGFpbiIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSldOwogICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCBuLnNlbnQoKS5qc29uKCldOwogICAgICAgICAgICAgICAgICAgIGNhc2UgMjoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyLCBuLnNlbnQoKS5JU09dOwogICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQgPSBuLnNlbnQoKSwgY29uc29sZS5lcnJvcih0KSwgWzIsICJaWiJdOwogICAgICAgICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KSkKICAgICAgICB9KSkKICAgIH0KICAgIHZhciBjdCA9IGUoNjcpLAogICAgICAgIHV0ID0gZnVuY3Rpb24odCwgbiwgZSwgaSkgewogICAgICAgICAgICByZXR1cm4gbmV3KGUgfHwgKGUgPSBQcm9taXNlKSkoKGZ1bmN0aW9uKHIsIG8pIHsKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGEodCkgewogICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGQoaS5uZXh0KHQpKQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbyh0KQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzKHQpIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBkKGkudGhyb3codCkpCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICAgICAgICAgICAgICBvKHQpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGQodCkgewogICAgICAgICAgICAgICAgICAgIHZhciBuOwogICAgICAgICAgICAgICAgICAgIHQuZG9uZSA/IHIodC52YWx1ZSkgOiAobiA9IHQudmFsdWUsIG4gaW5zdGFuY2VvZiBlID8gbiA6IG5ldyBlKChmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHQobikKICAgICAgICAgICAgICAgICAgICB9KSkpLnRoZW4oYSwgcykKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGQoKGkgPSBpLmFwcGx5KHQsIG4gfHwgW10pKS5uZXh0KCkpCiAgICAgICAgICAgIH0pKQogICAgICAgIH0sCiAgICAgICAgbHQgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgICAgIHZhciBlLCBpLCByLCBvLCBhID0gewogICAgICAgICAgICAgICAgbGFiZWw6IDAsCiAgICAgICAgICAgICAgICBzZW50OiBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoMSAmIHJbMF0pIHRocm93IHJbMV07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJbMV0KICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB0cnlzOiBbXSwKICAgICAgICAgICAgICAgIG9wczogW10KICAgICAgICAgICAgfTsKICAgICAgICAgICAgcmV0dXJuIG8gPSB7CiAgICAgICAgICAgICAgICBuZXh0OiBzKDApLAogICAgICAgICAgICAgICAgdGhyb3c6IHMoMSksCiAgICAgICAgICAgICAgICByZXR1cm46IHMoMikKICAgICAgICAgICAgfSwgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIChvW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzCiAgICAgICAgICAgIH0pLCBvOwoKICAgICAgICAgICAgZnVuY3Rpb24gcyhvKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24ocykgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihvKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlKSB0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoOyBhOykgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlID0gMSwgaSAmJiAociA9IDIgJiBvWzBdID8gaS5yZXR1cm4gOiBvWzBdID8gaS50aHJvdyB8fCAoKHIgPSBpLnJldHVybikgJiYgci5jYWxsKGkpLCAwKSA6IGkubmV4dCkgJiYgIShyID0gci5jYWxsKGksIG9bMV0pKS5kb25lKSByZXR1cm4gcjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoaSA9IDAsIHIgJiYgKG8gPSBbMiAmIG9bMF0sIHIudmFsdWVdKSwgb1swXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBvOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhLmxhYmVsKyssIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBvWzFdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9uZTogITEKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubGFiZWwrKywgaSA9IG9bMV0sIG8gPSBbMF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbyA9IGEub3BzLnBvcCgpLCBhLnRyeXMucG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHIgPSBhLnRyeXMsIChyID0gci5sZW5ndGggPiAwICYmIHJbci5sZW5ndGggLSAxXSkgfHwgNiAhPT0gb1swXSAmJiAyICE9PSBvWzBdKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgzID09PSBvWzBdICYmICghciB8fCBvWzFdID4gclswXSAmJiBvWzFdIDwgclszXSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEubGFiZWwgPSBvWzFdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoNiA9PT0gb1swXSAmJiBhLmxhYmVsIDwgclsxXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5sYWJlbCA9IHJbMV0sIHIgPSBvOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAociAmJiBhLmxhYmVsIDwgclsyXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYS5sYWJlbCA9IHJbMl0sIGEub3BzLnB1c2gobyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJbMl0gJiYgYS5vcHMucG9wKCksIGEudHJ5cy5wb3AoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBuLmNhbGwodCwgYSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbyA9IFs2LCB0XSwgaSA9IDAKICAgICAgICAgICAgICAgICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSByID0gMAogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICg1ICYgb1swXSkgdGhyb3cgb1sxXTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBvWzBdID8gb1sxXSA6IHZvaWQgMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbmU6ICEwCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KFtvLCBzXSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgQXQgPSAhMSwKICAgICAgICBtdCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gdXQodm9pZCAwLCB2b2lkIDAsIHZvaWQgMCwgKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFyIHQsIG4sIGU7CiAgICAgICAgICAgICAgICByZXR1cm4gbHQodGhpcywgKGZ1bmN0aW9uKGkpIHsKICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGkubGFiZWwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEF0KSByZXR1cm4gWzJdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaS5sYWJlbCA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpLnRyeXMucHVzaChbMSwgNCwgLCA1XSksIFs0LCBmZXRjaCgiLi90b3VjaENvbnRyb2xsZXJDb25maWcuanNvbiIpXTsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFs0LCBpLnNlbnQoKS5qc29uKCldOwogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHQgPSBpLnNlbnQoKSkgJiYgKChuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0IikpLnNyYyA9ICIvL2dhbWUtY2RuLnBva2kuY29tL3NjcmlwdHMvdG91Y2hPdmVybGF5Q29udHJvbGxlci5qcyIsIG4ub25sb2FkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IHdpbmRvdy5PdmVybGF5Q29udHJvbGxlcihkb2N1bWVudC5ib2R5LCB0KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChuKSwgQXQgPSAhMCksIFszLCA1XTsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUgPSBpLnNlbnQoKSwgY29uc29sZS5sb2coZSksIFszLCA1XTsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsyXQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICB9KSkKICAgICAgICB9LAogICAgICAgIGZ0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGZvciAodmFyIHQgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxZTMpLCBuID0gIiIsIGUgPSAwOyBlIDwgNDsgZSsrKSBuID0gU3RyaW5nLmZyb21DaGFyQ29kZSgyNTUgJiB0KSArIG4sIHQgPj49IDg7CiAgICAgICAgICAgIGlmICh3aW5kb3cuY3J5cHRvICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMgJiYgVWludDMyQXJyYXkpIHsKICAgICAgICAgICAgICAgIHZhciBpID0gbmV3IFVpbnQzMkFycmF5KDEyKTsKICAgICAgICAgICAgICAgIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMoaSk7CiAgICAgICAgICAgICAgICBmb3IgKGUgPSAwOyBlIDwgMTI7IGUrKykgbiArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDI1NSAmIGlbZV0pCiAgICAgICAgICAgIH0gZWxzZQogICAgICAgICAgICAgICAgZm9yIChlID0gMDsgZSA8IDEyOyBlKyspIG4gKz0gU3RyaW5nLmZyb21DaGFyQ29kZShNYXRoLmZsb29yKDI1NiAqIE1hdGgucmFuZG9tKCkpKTsKICAgICAgICAgICAgcmV0dXJuIGJ0b2EobikucmVwbGFjZSgvXCsvZywgIi0iKS5yZXBsYWNlKC9cLy9nLCAiXyIpLnJlcGxhY2UoLz0vZywgIiIpCiAgICAgICAgfSwKICAgICAgICBwdCA9ICExLAogICAgICAgIGd0ID0gbmV3IE1hcCwKICAgICAgICBodCA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgaWYgKCF0KSByZXR1cm4gbnVsbDsKICAgICAgICAgICAgZm9yICh2YXIgbiA9IDAsIGUgPSBBcnJheS5mcm9tKHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgicG9raS1hZC1zbG90IikpOyBuIDwgZS5sZW5ndGg7IG4rKykgewogICAgICAgICAgICAgICAgdmFyIGkgPSBlW25dLAogICAgICAgICAgICAgICAgICAgIHIgPSBndC5nZXQoaS5pZCk7CiAgICAgICAgICAgICAgICBpZiAocikgcmV0dXJuIHIuaWQKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbnVsbAogICAgICAgIH0sCiAgICAgICAgd3QgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgICAgIHZhciBlID0gaHQodCksCiAgICAgICAgICAgICAgICBpID0gZ3QuZ2V0KGUgfHwgIiIpIHx8IG51bGw7CiAgICAgICAgICAgIGlmIChpKSB7CiAgICAgICAgICAgICAgICB2YXIgciA9IG4uc3BsaXQoIngiKS5tYXAoKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQodCwgMTApCiAgICAgICAgICAgICAgICB9KSkgfHwgWzAsIDBdOwogICAgICAgICAgICAgICAgaWYgKGkud2lkdGggPT09IHJbMF0gJiYgaS5oZWlnaHQgPT09IHJbMV0pIHJldHVybiBpLmlkOwogICAgICAgICAgICAgICAgeXQodCkKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgbyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHZhciBuID0gdC5zcGxpdCgieCIpLm1hcCgoZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQodCwgMTApCiAgICAgICAgICAgICAgICAgICAgfSkpLAogICAgICAgICAgICAgICAgICAgIGUgPSAiLzIxNjgyMTk4NjA3L2RlYnVnLWRpc3BsYXkvZGVidWctZGlzcGxheS0iICsgdCwKICAgICAgICAgICAgICAgICAgICBpID0gImRlc2t0b3AiOwogICAgICAgICAgICAgICAgRSgpICYmIChpID0gIm1vYmlsZSIpLCB4KCkgJiYgKGkgPSAidGFibGV0Iik7CiAgICAgICAgICAgICAgICB2YXIgciA9IHBhcnNlSW50KFQoInNpdGVfaWQiKSwgMTApIHx8IDA7CiAgICAgICAgICAgICAgICByZXR1cm4gcHQgfHwgKGUgPSBrdC5HZXRJc1Bva2lJRnJhbWUoKSA/ICIvMjE2ODIxOTg2MDcvIiArIGkgKyAiX2luZ2FtZV8iICsgdCArICIvIiArIHIgKyAiXyIgKyBpICsgIl9pbmdhbWVfIiArIHQgOiAiLzIxNjgyMTk4NjA3L2V4dGVybmFsXyIgKyBpICsgIl9kaXNwbGF5X2luZ2FtZS9leHRlcm5hbF8iICsgaSArICJfaW5nYW1lXyIgKyB0KSwgewogICAgICAgICAgICAgICAgICAgIGlkOiAicG9raS0iICsgZnQoKSwKICAgICAgICAgICAgICAgICAgICBhZFVuaXRQYXRoOiBlLAogICAgICAgICAgICAgICAgICAgIHNpemU6IHQsCiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IG5bMF0sCiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBuWzFdLAogICAgICAgICAgICAgICAgICAgIHJlZnJlc2g6ICExCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0obik7CiAgICAgICAgICAgIHJldHVybiBndC5zZXQoby5pZCwgbyksIGdvb2dsZXRhZy5jbWQucHVzaCgoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIgbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgICAgICAgICAgbi5pZCA9IG8uaWQsIG4uY2xhc3NOYW1lID0gInBva2ktYWQtc2xvdCIsIG4uc3R5bGUud2lkdGggPSBvLndpZHRoICsgInB4Iiwgbi5zdHlsZS5oZWlnaHQgPSBvLmhlaWdodCArICJweCIsIG4uc2V0QXR0cmlidXRlKCJkYXRhLXBva2ktYWQtc2l6ZSIsIG8uc2l6ZSksIHQuYXBwZW5kQ2hpbGQobiksIHQuc2V0QXR0cmlidXRlKCJkYXRhLXBva2ktYWQtaWQiLCBvLmlkKSwgby5ncHRTbG90ID0gZ29vZ2xldGFnLmRlZmluZVNsb3Qoby5hZFVuaXRQYXRoLCBbby53aWR0aCwgby5oZWlnaHRdLCBvLmlkKS5hZGRTZXJ2aWNlKGdvb2dsZXRhZy5wdWJhZHMoKSksIGdvb2dsZXRhZy5lbmFibGVTZXJ2aWNlcygpLCBndC5zZXQoby5pZCwgbykKICAgICAgICAgICAgfSkpLCBvLmlkCiAgICAgICAgfSwKICAgICAgICB5dCA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgZ29vZ2xldGFnLmNtZC5wdXNoKChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHZhciBuLCBlID0gaHQodCksCiAgICAgICAgICAgICAgICAgICAgaSA9IGd0LmdldChlIHx8ICIiKSB8fCBudWxsOwogICAgICAgICAgICAgICAgaSAmJiBpLmdwdFNsb3QgJiYgKHkudHJhY2soQS50cmFja2luZy5zY3JlZW4uZGVzdHJveUFkLCB7CiAgICAgICAgICAgICAgICAgICAgb3Bwb3J0dW5pdHlJZDogaS5vcHBvcnR1bml0eUlkCiAgICAgICAgICAgICAgICB9KSwgZ29vZ2xldGFnLmRlc3Ryb3lTbG90cyhbaS5ncHRTbG90XSksIG51bGwgPT09IChuID0gdC5xdWVyeVNlbGVjdG9yKCJkaXYjIiArIGkuaWQpKSB8fCB2b2lkIDAgPT09IG4gfHwgbi5yZW1vdmUoKSwgdC5yZW1vdmVBdHRyaWJ1dGUoImRhdGEtcG9raS1hZC1pZCIpLCBndC5kZWxldGUoaS5pZCkpCiAgICAgICAgICAgIH0pKQogICAgICAgIH0sCiAgICAgICAgdnQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuICh2dCA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgbiwgZSA9IDEsIGkgPSBhcmd1bWVudHMubGVuZ3RoOyBlIDwgaTsgZSsrKQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHIgaW4gbiA9IGFyZ3VtZW50c1tlXSkgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG4sIHIpICYmICh0W3JdID0gbltyXSk7CiAgICAgICAgICAgICAgICByZXR1cm4gdAogICAgICAgICAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpCiAgICAgICAgfSwKICAgICAgICBidCA9IHsKICAgICAgICAgICAgZ2FtZUlkOiBUKCJnYW1lX2lkIiksCiAgICAgICAgICAgIHZlcnNpb25JZDogVCgiZ2FtZV92ZXJzaW9uX2lkIikKICAgICAgICB9LAogICAgICAgIGt0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGZ1bmN0aW9uIHQoKSB7CiAgICAgICAgICAgICAgICB0aGlzLmF1dG9TdGFydE9uUmVhZHkgPSAhMSwgdGhpcy5jcml0ZXJpYSA9IHt9LCB0aGlzLmRlYnVnSXNPdmVyd3JpdHRlbiA9ICExLCB0aGlzLmhhbmRsZXJzID0ge30sIHRoaXMuaW5pdGlhbGl6aW5nUHJvbWlzZSA9IG51bGwsIHRoaXMuaXNJbml0aWFsaXplZCA9ICExLCB0aGlzLnByb2dyYW1tYXRpY0Fkc0VuYWJsZWQgPSAhMCwgdGhpcy5zZGtCb290ZWQgPSAhMSwgdGhpcy5zZGtJbWFFcnJvciA9ICExLCB0aGlzLnN0YXJ0QWRFbmFibGVkID0gITEsIHRoaXMuc3RhcnRTdGFydEFkc0FmdGVyVGltZXJPbkluaXQgPSAhMSwgdGhpcy5pbml0T3B0aW9ucyA9IHt9LCB0aGlzLmZvcmNlRGlzYWJsZUNvbW1lcmNpYWxCcmVhayA9ICExLCB0aGlzLmRlYnVnID0gITEsIHRoaXMuYWRSZWFkeSA9ICExLCB0aGlzLmRlYnVnVG91Y2hPdmVybGF5Q29udHJvbGxlciA9ICExLCB0aGlzLnNldFBsYXllckFnZSA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICB0ICYmIGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEgpIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0LCBuKQogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBIID0gITEsIFdbdF0gPSBuCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBXW3RdID0gbgogICAgICAgICAgICAgICAgICAgIH0oInBsYXllckFnZSIsIHQpCiAgICAgICAgICAgICAgICB9LCB0aGlzLnRvZ2dsZU5vblBlcnNvbmFsaXplZCA9IGZ1bmN0aW9uKG4pIHsKICAgICAgICAgICAgICAgICAgICB0Lm5vblBlcnNvbmFsaXplZCA9IG4KICAgICAgICAgICAgICAgIH0sIHRoaXMuc2V0Q29uc2VudFN0cmluZyA9IGZ1bmN0aW9uKG4pIHsKICAgICAgICAgICAgICAgICAgICB0LmNvbnNlbnRTdHJpbmcgPSBuCiAgICAgICAgICAgICAgICB9LCB0aGlzLnNka05vdEJvb3RlZEJ1dENhbGxlZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIlRoZSBQb2tpIFNESyBoYXMgbm90IHlldCBiZWVuIGluaXRpYWxpemVkIikKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB2YXIgbiA9IFQoInBva2lEZWJ1ZyIpOwogICAgICAgICAgICAgICAgIiIgIT09IG4gJiYgKHRoaXMuc2V0RGVidWcoInRydWUiID09PSBuKSwgdGhpcy5kZWJ1Z0lzT3ZlcndyaXR0ZW4gPSAhMCkKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdC5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIGlmICh2b2lkIDAgPT09IHQgJiYgKHQgPSB7fSksICJ1bmRlZmluZWQiICE9IHR5cGVvZiB3aW5kb3cpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IHQub25SZWFkeSwKICAgICAgICAgICAgICAgICAgICAgICAgZSA9IHZvaWQgMCA9PT0gbiA/IG51bGwgOiBuLAogICAgICAgICAgICAgICAgICAgICAgICBpID0gdC5vbkFkYmxvY2tlZCwKICAgICAgICAgICAgICAgICAgICAgICAgciA9IHZvaWQgMCA9PT0gaSA/IG51bGwgOiBpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmluaXRPcHRpb25zID0gdCwgZSAmJiB0aGlzLnJlZ2lzdGVySGFuZGxlcigib25SZWFkeSIsIGUpLCByICYmIHRoaXMucmVnaXN0ZXJIYW5kbGVyKCJvbkFkYmxvY2tlZCIsIHIpLCB0aGlzLmlzSW5pdGlhbGl6ZWQgPyBjb25zb2xlLmVycm9yKCJQb2tpIFNESyBoYXMgYWxyZWFkeSBiZWVuIGluaXRpYWxpemVkIikgOiAodGhpcy5pbml0aWFsaXppbmdQcm9taXNlIHx8ICh0aGlzLmluaXRpYWxpemluZ1Byb21pc2UgPSB0aGlzLmxhenlMb2FkSW5pdCgpKSwgdGhpcy5pbml0aWFsaXppbmdQcm9taXNlKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5sYXp5TG9hZEluaXQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHZhciBuLCBlID0gdGhpcywKICAgICAgICAgICAgICAgICAgICBpID0gdGhpcy5pbml0T3B0aW9ucywKICAgICAgICAgICAgICAgICAgICByID0gaS5hZFRhZ1VybCwKICAgICAgICAgICAgICAgICAgICBvID0gaS5hZFRpbWluZywKICAgICAgICAgICAgICAgICAgICBhID0gdm9pZCAwID09PSBvID8ge30gOiBvLAogICAgICAgICAgICAgICAgICAgIHMgPSBpLmN1c3RvbUNyaXRlcmlhLAogICAgICAgICAgICAgICAgICAgIGQgPSB2b2lkIDAgPT09IHMgPyB7fSA6IHMsCiAgICAgICAgICAgICAgICAgICAgYyA9IGkuZGVidWcsCiAgICAgICAgICAgICAgICAgICAgdSA9IHZvaWQgMCAhPT0gYyAmJiBjLAogICAgICAgICAgICAgICAgICAgIGwgPSBpLnByZWJpZCwKICAgICAgICAgICAgICAgICAgICBtID0gdm9pZCAwID09PSBsID8ge30gOiBsLAogICAgICAgICAgICAgICAgICAgIHAgPSBpLmE5LAogICAgICAgICAgICAgICAgICAgIGcgPSB2b2lkIDAgPT09IHAgPyB7fSA6IHAsCiAgICAgICAgICAgICAgICAgICAgaCA9IGkudm9sdW1lLAogICAgICAgICAgICAgICAgICAgIHcgPSB2b2lkIDAgPT09IGggPyAxIDogaCwKICAgICAgICAgICAgICAgICAgICBiID0gaS53YXRlcmZhbGxSZXRyaWVzLAogICAgICAgICAgICAgICAgICAgIGsgPSBpLndyYXBwZXIsCiAgICAgICAgICAgICAgICAgICAgUyA9IHZvaWQgMCA9PT0gayA/IGRvY3VtZW50LmJvZHkgOiBrLAogICAgICAgICAgICAgICAgICAgIHogPSBwYXJzZUludChUKCJzaXRlX2lkIiksIDEwKSB8fCAwOwogICAgICAgICAgICAgICAgd2luZG93Lmdvb2dsZXRhZyA9IHdpbmRvdy5nb29nbGV0YWcgfHwgewogICAgICAgICAgICAgICAgICAgIGNtZDogW10KICAgICAgICAgICAgICAgIH0sIHRoaXMuc2V0dXBEZWZhdWx0RXZlbnRzKCksIHkuc2V0dXBEZWZhdWx0RXZlbnRzKCksIG4gPSBtLCB3aW5kb3cucGJqcyA9IHdpbmRvdy5wYmpzIHx8IHt9LCB3aW5kb3cucGJqcy5xdWUgPSB3aW5kb3cucGJqcy5xdWUgfHwgW10sIHdpbmRvdy5wYmpzLnF1ZS5wdXNoKChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB3aW5kb3cucGJqcy5hZGRBZFVuaXRzKG4uYWRVbml0cyB8fCBMKSwgd2luZG93LnBianMuc2V0Q29uZmlnKEIoQih7fSwgaiksIG4uY29uZmlnKSksIHdpbmRvdy5wYmpzLmJpZGRlclNldHRpbmdzID0gewogICAgICAgICAgICAgICAgICAgICAgICBkaXN0cmljdG06IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpZENwbUFkanVzdG1lbnQ6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLjg1ICogdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICByaWNoYXVkaWVuY2U6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpZENwbUFkanVzdG1lbnQ6IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLjkgKiB0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICB2YXIgQyA9IHZ0KHt9LCB2KTsKICAgICAgICAgICAgICAgIHIgPyAodC5pc1Bva2lQbGF0Zm9ybSA9ICEwLCBDID0gdnQodnQoe30sIEMpLCB7CiAgICAgICAgICAgICAgICAgICAgYWRUYWdVcmw6IHIsCiAgICAgICAgICAgICAgICAgICAgY3VzdG9tQ3JpdGVyaWE6IGQsCiAgICAgICAgICAgICAgICAgICAgYWRUaW1pbmc6IGEKICAgICAgICAgICAgICAgIH0pKSA6IHQuaXNQb2tpUGxhdGZvcm0gPSAhMTsKICAgICAgICAgICAgICAgIHZhciBJID0gb3Q7CiAgICAgICAgICAgICAgICAodC5pc1Bva2lQbGF0Zm9ybSB8fCB0aGlzLmRlYnVnKSAmJiAoSSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB2YXIgXyA9IGR0LAogICAgICAgICAgICAgICAgICAgIFAgPSB0aGlzLmluaXRPcHRpb25zLmNvdW50cnkgfHwgVCgiY291bnRyeSIpOwogICAgICAgICAgICAgICAgcmV0dXJuIFAgJiYgKF8gPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFApCiAgICAgICAgICAgICAgICB9KSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsIHRoaXMucmVzaXplLmJpbmQodGhpcyksICExKSwgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIm1lc3NhZ2UiLCB0aGlzLm9uTWVzc2FnZS5iaW5kKHRoaXMpLCAhMSksIHRoaXMuZGVidWdJc092ZXJ3cml0dGVuIHx8IHRoaXMuc2V0RGVidWcodGhpcy5kZWJ1ZyB8fCB1KSwgdGhpcy5kZWJ1Z1RvdWNoT3ZlcmxheUNvbnRyb2xsZXIgJiYgKEUoKSB8fCB4KCkpICYmIG10KCksIFByb21pc2UuYWxsKFtJKCksIF8oKSwgCiAgICAgICAgICAgICAgICBldCgiIiksIAogICAgICAgICAgICAgICAgZXQoIiIpLCAKICAgICAgICAgICAgICAgIGV0KGN0LmEpLCAKICAgICAgICAgICAgICAgIGV0KCIiKV0pLmNhdGNoKChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICBmLmRpc3BhdGNoRXZlbnQoQS5hZGJsb2NrZWQpCiAgICAgICAgICAgICAgICB9KSkudGhlbigoZnVuY3Rpb24obikgewogICAgICAgICAgICAgICAgICAgIGlmICh2b2lkIDAgIT09IG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBuWzBdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgciA9IG5bMV0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvID0gdnQodnQoe30sIEMpLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyeTogcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidC5nYW1lSWQgfHwgKGJ0LmdhbWVJZCA9IGkuZ2FtZUlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsiN2ZiMWZkNDUtMjRjZS00YWRlLWI1YzQtOWVlNTVlYzk5NTI2Il0uaW5jbHVkZXMoYnQuZ2FtZUlkKSAmJiAoRSgpIHx8IHgoKSkgJiYgbXQoKSwgby5hZFRpbWluZyA9IGkuYWRUaW1pbmcsIG8uY3VzdG9tQ3JpdGVyaWEgPSB2dCh2dCh7fSwgby5jdXN0b21Dcml0ZXJpYSksIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwNGRfZ2FtZV9pZDogYnQuZ2FtZUlkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGUuZGVidWcgJiYgKG8uYWRUaW1pbmcuc3RhcnRBZHNBZnRlciA9IDApLCBlLmVuYWJsZVNldHRpbmdzKG8pOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IEooZS5jb3VudHJ5KTsKICAgICAgICAgICAgICAgICAgICAgICAgYSAmJiAodC5HZXRJc1Bva2lQbGF0Zm9ybSgpIHx8IHQuR2V0SXNQb2tpSUZyYW1lKCkpICYmIE0oKSwgZS5wbGF5ZXJTa2luID0gbmV3IFEoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdyYXBwZXI6IFMKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBlLmltYSA9IG5ldyBudCh3KSwgZS5wbGF5ZXJTa2luLnNldHVwRXZlbnRzKGUpLCBlLnN0YXJ0U3RhcnRBZHNBZnRlclRpbWVyT25Jbml0ICYmIGUuYWRUaW1pbmdzLnN0YXJ0U3RhcnRBZHNBZnRlclRpbWVyKCksIGUud2F0ZXJmYWxsID0gbmV3IEcoZS5pbWEsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1pbmc6IGUuYWRUaW1pbmdzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsUmV0cmllczogYiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZFRhZ1VybDogby5hZFRhZ1VybCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXRlSUQ6IHoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCB3aW5kb3cuZ29vZ2xldGFnLmNtZC5wdXNoKChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZ29vZ2xldGFnLnB1YmFkcygpLmFkZEV2ZW50TGlzdGVuZXIoInNsb3RSZW5kZXJFbmRlZCIsIChmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuID0gdC5zbG90LmdldFNsb3RFbGVtZW50SWQoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBndC5nZXQobik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgJiYgZS5ncHRTbG90ICYmIHkudHJhY2soQS50cmFja2luZy5hZHMuZGlzcGxheS5pbXByZXNzaW9uLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBlLnNpemUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHBvcnR1bml0eUlkOiBlLm9wcG9ydHVuaXR5SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZFVuaXRQYXRoOiBlLmFkVW5pdFBhdGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSksIHdpbmRvdy5nb29nbGV0YWcucHViYWRzKCkuYWRkRXZlbnRMaXN0ZW5lcigiaW1wcmVzc2lvblZpZXdhYmxlIiwgKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSB0LnNsb3QuZ2V0U2xvdEVsZW1lbnRJZCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IGd0LmdldChuKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZSAmJiBlLmdwdFNsb3QgJiYgeS50cmFjayhBLnRyYWNraW5nLmFkcy5kaXNwbGF5LnZpZXdhYmxlLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBlLnNpemUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHBvcnR1bml0eUlkOiBlLm9wcG9ydHVuaXR5SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZFVuaXRQYXRoOiBlLmFkVW5pdFBhdGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuYXBzdGFnICYmIHdpbmRvdy5hcHN0YWcuaW5pdCh0LnNldHRpbmdzIHx8IEIoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdWJJRDogImUzMmYxNDIzLTI4YmMtNDNlZC04YWIwLTVhZTZiNDQ0OWNmOCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkU2VydmVyOiAiZ29vZ2xldGFnIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlkZW9BZFNlcnZlcjogIkRGUCIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCBuID8gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZHByOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbXBUaW1lb3V0OiAxZTQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gOiB7fSksIChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUiA9ICEwLCB0LmNhbGxiYWNrICYmIHQuY2FsbGJhY2soKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfShnLCBhKSwgZS5pc0luaXRpYWxpemVkID0gITAsIGYuZGlzcGF0Y2hFdmVudChBLnJlYWR5KQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5yZXF1ZXN0QWQgPSBmdW5jdGlvbihuKSB7CiAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXM7CiAgICAgICAgICAgICAgICB2b2lkIDAgPT09IG4gJiYgKG4gPSB7fSk7CiAgICAgICAgICAgICAgICB2YXIgaSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHZhciBpID0gbi5hdXRvU3RhcnQsCiAgICAgICAgICAgICAgICAgICAgICAgIHIgPSB2b2lkIDAgPT09IGkgfHwgaSwKICAgICAgICAgICAgICAgICAgICAgICAgbyA9IG4uY3VzdG9tQ3JpdGVyaWEsCiAgICAgICAgICAgICAgICAgICAgICAgIGEgPSB2b2lkIDAgPT09IG8gPyB7fSA6IG8sCiAgICAgICAgICAgICAgICAgICAgICAgIHMgPSBuLm9uRmluaXNoLAogICAgICAgICAgICAgICAgICAgICAgICBkID0gdm9pZCAwID09PSBzID8gbnVsbCA6IHMsCiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBuLm9uU3RhcnQsCiAgICAgICAgICAgICAgICAgICAgICAgIHUgPSB2b2lkIDAgPT09IGMgPyBudWxsIDogYywKICAgICAgICAgICAgICAgICAgICAgICAgbCA9IG4ucG9zaXRpb24sCiAgICAgICAgICAgICAgICAgICAgICAgIG0gPSB2b2lkIDAgPT09IGwgPyBudWxsIDogbDsKICAgICAgICAgICAgICAgICAgICBpZiAoZS5hdXRvU3RhcnRPblJlYWR5ID0gITEgIT09IHIsIGQgJiYgZS5yZWdpc3RlckhhbmRsZXIoIm9uRmluaXNoIiwgZCksIHUgJiYgZS5yZWdpc3RlckhhbmRsZXIoIm9uU3RhcnQiLCB1KSwgZS5mb3JjZURpc2FibGVDb21tZXJjaWFsQnJlYWsgJiYgW0EuYWRzLnBvc2l0aW9uLm1pZHJvbGwsIEEuYWRzLnBvc2l0aW9uLnByZXJvbGxdLmluY2x1ZGVzKG0pKSBkICYmIGQoKTsKICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlLnNka0Jvb3RlZCkgcmV0dXJuIGYuZGlzcGF0Y2hFdmVudChBLmFkcy5lcnJvciwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIlJlcXVlc3RpbmcgYWQgb24gdW5ib290ZWQgU0RLIgogICAgICAgICAgICAgICAgICAgICAgICB9KSwgdm9pZCBlLnNka05vdEJvb3RlZEJ1dENhbGxlZCgpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZS5zZGtJbWFFcnJvcikgZi5kaXNwYXRjaEV2ZW50KEEuYWRzLmVycm9yLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAiQWRibG9ja2VyIGhhcyBiZWVuIGRldGVjdGVkIgogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIUUoKSAmJiAheCgpIHx8IG0gPT09IEEuYWRzLnBvc2l0aW9uLnJld2FyZGVkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT09IG0gJiYgcChtLCBBLmFkcy5wb3NpdGlvbikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUuaW1hLmlzQWRSdW5uaW5nKCkgfHwgZS53YXRlcmZhbGwuaXNSdW5uaW5nKCkpIGYuZGlzcGF0Y2hFdmVudChBLmFkcy5idXN5KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChlLmFkUmVhZHkpIGYuZGlzcGF0Y2hFdmVudChBLmFkcy5yZWFkeSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG0gIT09IEEuYWRzLnBvc2l0aW9uLnByZXJvbGwgfHwgZS5hZFRpbWluZ3MucHJlcm9sbFBvc3NpYmxlKCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobSA9PT0gQS5hZHMucG9zaXRpb24ucmV3YXJkZWQgfHwgZS5hZFRpbWluZ3MucmVxdWVzdFBvc3NpYmxlKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZyA9IHZ0KHZ0KHZ0KHt9LCBlLmdlbmVyaWNDcml0ZXJpYSgpKSwgZS5jcml0ZXJpYSksIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IG0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodC5pc1Bva2lQbGF0Zm9ybSB8fCBtID09PSBBLmFkcy5wb3NpdGlvbi5yZXdhcmRlZCkgJiYgKGcgPSB2dCh2dCh7fSwgZyksIGEpKSwgZS5wbGF5ZXJTa2luLnNob3dXaXRoT3BhY2l0eSgpLCBlLnJlc2l6ZSgpLCBlLndhdGVyZmFsbC5zdGFydChnLCBtKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGYuZGlzcGF0Y2hFdmVudChBLmFkcy5saW1pdCwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbjogQS5pbmZvLm1lc3NhZ2VzLnRpbWVMaW1pdAogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgZi5kaXNwYXRjaEV2ZW50KEEuYWRzLmxpbWl0LCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb246IEEuaW5mby5tZXNzYWdlcy5wcmVyb2xsTGltaXQKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgY29uc29sZS5lcnJvcigiUE9LSS1TREs6IEludmFsaWQgcG9zaXRpb24iKTsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBmLmRpc3BhdGNoRXZlbnQoQS5hZHMuZXJyb3IsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbjogIkludGVyc3RpdGlhbHMgYXJlIGRpc2FibGVkIG9uIG1vYmlsZSIKICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgdGhpcy5pc0luaXRpYWxpemVkID8gaSgpIDogdGhpcy5sYXp5TG9hZEluaXQoKS50aGVuKGkpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLmRpc3BsYXlBZCA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgICAgIHZhciBlID0gdGhpcywKICAgICAgICAgICAgICAgICAgICBpID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGYuY2xlYXJBbm5vdGF0aW9ucygpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaSA9IGZ0KCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByID0gQS5hZHMucG9zaXRpb24uZGlzcGxheTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZS5zZGtCb290ZWQpIHJldHVybiBmLmRpc3BhdGNoRXZlbnQoQS5hZHMuZXJyb3IsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAiUmVxdWVzdGluZyBhZCBvbiB1bmJvb3RlZCBTREsiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiByCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwgdm9pZCBlLnNka05vdEJvb3RlZEJ1dENhbGxlZCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUuc2RrSW1hRXJyb3IpIGYuZGlzcGF0Y2hFdmVudChBLmFkcy5lcnJvciwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAiQWRibG9ja2VyIGhhcyBiZWVuIGRldGVjdGVkIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEgZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAhIShFKCkgfHwgeCgpIHx8IFsiOTcweDI1MCIsICIzMDB4MjUwIiwgIjcyOHg5MCIsICIxNjB4NjAwIiwgIjMyMHg1MCJdLmluY2x1ZGVzKHQpKSAmJiAhKChFKCkgfHwgeCgpKSAmJiAhWyIzMjB4NTAiXS5pbmNsdWRlcyh0KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0obikpIHJldHVybiBmLmRpc3BhdGNoRXZlbnQoQS5hZHMuZXJyb3IsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYXNvbjogIkRpc3BsYXkgc2l6ZSAiICsgbiArICIgaXMgbm90IHN1cHBvcnRlZCBvbiB0aGlzIGRldmljZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG8gPSB2dCh2dCh7fSwgZS5nZW5lcmljQ3JpdGVyaWEoKSksIGUuY3JpdGVyaWEpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYSA9IHd0KHQsIG4pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhIGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvb2dsZXRhZy5jbWQucHVzaCgoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUsIGkgPSBndC5nZXQodCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSAmJiBpLmdwdFNsb3QgJiYgKG51bGwgPT09IChlID0gaS5ncHRTbG90KSB8fCB2b2lkIDAgPT09IGUgfHwgZS5jbGVhclRhcmdldGluZygpLCBPYmplY3Qua2V5cyhuKS5mb3JFYWNoKChmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsID09PSAoZSA9IGkuZ3B0U2xvdCkgfHwgdm9pZCAwID09PSBlIHx8IGUuc2V0VGFyZ2V0aW5nKHQsIG5bdF0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0oYSwgbyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvb2dsZXRhZy5jbWQucHVzaCgoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBndC5nZXQodCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZSAmJiBlLmdwdFNsb3QgJiYgKGUub3Bwb3J0dW5pdHlJZCA9IG4sIHkudHJhY2soQS50cmFja2luZy5hZHMuZGlzcGxheS5yZXF1ZXN0ZWQsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogZS5zaXplLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHBvcnR1bml0eUlkOiBlLm9wcG9ydHVuaXR5SWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkVW5pdFBhdGg6IGUuYWRVbml0UGF0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBlLnJlZnJlc2ggJiYgZS5ncHRTbG90ID8gZ29vZ2xldGFnLnB1YmFkcygpLnJlZnJlc2goW2UuZ3B0U2xvdF0pIDogKGdvb2dsZXRhZy5kaXNwbGF5KGUuaWQpLCBlLnJlZnJlc2ggPSAhMCwgZ3Quc2V0KGUuaWQsIGUpKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KGEsIGkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBmLmRpc3BhdGNoRXZlbnQoQS5hZHMuZXJyb3IsIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAiUHJvdmlkZWQgY29udGFpbmVyIGRvZXMgbm90IGV4aXN0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGYuZGlzcGF0Y2hFdmVudChBLmFkcy5lcnJvciwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIk5vIGFkIHNpemUgZ2l2ZW4sIHVzYWdlOiBkaXNwbGF5QWQoPGNvbnRhaW5lcj4sIDxzaXplPikiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IHIKICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgdGhpcy5pc0luaXRpYWxpemVkID8gaSgpIDogdGhpcy5sYXp5TG9hZEluaXQoKS50aGVuKGkpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLmRlc3Ryb3lBZCA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHZhciBuID0gdGhpcywKICAgICAgICAgICAgICAgICAgICBlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbi5zZGtCb290ZWQpIHJldHVybiBmLmRpc3BhdGNoRXZlbnQoQS5hZHMuZGlzcGxheUVycm9yLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAiQXR0ZW1wdGluZyBkZXN0cm95QWQgb24gdW5ib290ZWQgU0RLIgogICAgICAgICAgICAgICAgICAgICAgICB9KSwgdm9pZCBuLnNka05vdEJvb3RlZEJ1dENhbGxlZCgpOwogICAgICAgICAgICAgICAgICAgICAgICBuLnNka0ltYUVycm9yID8gZi5kaXNwYXRjaEV2ZW50KEEuYWRzLmRpc3BsYXlFcnJvciwgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIkFkYmxvY2tlciBoYXMgYmVlbiBkZXRlY3RlZCIKICAgICAgICAgICAgICAgICAgICAgICAgfSkgOiAodCA9IHQgfHwgZG9jdW1lbnQuYm9keSwgeXQodCkpCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIHRoaXMuaXNJbml0aWFsaXplZCA/IGUoKSA6IHRoaXMubGF6eUxvYWRJbml0KCkudGhlbihlKQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5zdGFydFN0YXJ0QWRzQWZ0ZXJUaW1lciA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdGhpcy5zZGtCb290ZWQgJiYgIXRoaXMuc2RrSW1hRXJyb3IgPyB0aGlzLmFkVGltaW5ncy5zdGFydFN0YXJ0QWRzQWZ0ZXJUaW1lcigpIDogdGhpcy5zdGFydFN0YXJ0QWRzQWZ0ZXJUaW1lck9uSW5pdCA9ICEwCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLmVuYWJsZVNldHRpbmdzID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdGhpcy5jcml0ZXJpYSA9IHZ0KHt9LCB0LmN1c3RvbUNyaXRlcmlhKSwgdGhpcy5hZFRpbWluZ3MgPSBuZXcgayh0LmFkVGltaW5nKSwgdGhpcy5jb3VudHJ5ID0gdC5jb3VudHJ5CiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLnRvZ2dsZVBsYXllckFkdmVydGlzaW5nQ29uc2VudCA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIGlmICh0KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG4sIGUgPSBwYXJzZUludChmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUgpIHJldHVybiBXW3RdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLmdldEl0ZW0odCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gV1t0XQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KCJwbGF5ZXJBZ2UiKSwgMTApIHx8IDAsCiAgICAgICAgICAgICAgICAgICAgICAgIGkgPSB0aGlzLmNvdW50cnksCiAgICAgICAgICAgICAgICAgICAgICAgIHIgPSBKKGkpLAogICAgICAgICAgICAgICAgICAgICAgICBvID0gKG4gPSBpLCBxLmluY2x1ZGVzKG4pKSwKICAgICAgICAgICAgICAgICAgICAgICAgYSA9IFkoaSk7CiAgICAgICAgICAgICAgICAgICAgKHIgfHwgbyB8fCBZKSAmJiAociAmJiBlIDw9IDEyIHx8IG8gJiYgZSA8PSAxNiB8fCBhICYmIGUgPD0gMTYpID8gdGhpcy5kaXNhYmxlUHJvZ3JhbW1hdGljKCk6IHRoaXMuZW5hYmxlUHJvZ3JhbW1hdGljKCkKICAgICAgICAgICAgICAgIH0gZWxzZSB0aGlzLmRpc2FibGVQcm9ncmFtbWF0aWMoKQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5kaXNhYmxlUHJvZ3JhbW1hdGljID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB0LmNoaWxkRGlyZWN0ZWQgPSAhMCwgdGhpcy5wcm9ncmFtbWF0aWNBZHNFbmFibGVkID0gITEKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuZW5hYmxlUHJvZ3JhbW1hdGljID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB0LmNoaWxkRGlyZWN0ZWQgPSAhMSwgdGhpcy5wcm9ncmFtbWF0aWNBZHNFbmFibGVkID0gITAKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuZ2V0UHJvZ3JhbW1hdGljQWRzRW5hYmxlZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvZ3JhbW1hdGljQWRzRW5hYmxlZAogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5zZXREZWJ1ZyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHZhciBuID0gdGhpczsKICAgICAgICAgICAgICAgIHRoaXMuZGVidWdJc092ZXJ3cml0dGVuID8gdCAmJiB5LnRyYWNrKEEudHJhY2tpbmcuZGVidWdUcnVlSW5Qcm9kdWN0aW9uKSA6ICh5LnNldERlYnVnKHQpLCBmLnNldERlYnVnKHQpLCB0aGlzLndhdGVyZmFsbCA/IHRoaXMud2F0ZXJmYWxsLnNldERlYnVnKHQpIDogZi5hZGRFdmVudExpc3RlbmVyKEEucmVhZHksIChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICBuLndhdGVyZmFsbCAmJiBuLndhdGVyZmFsbC5zZXREZWJ1Zyh0KQogICAgICAgICAgICAgICAgfSkpLCBwdCA9IHQsIHRoaXMuZGVidWcgPSB0KQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5yZXNpemUgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHZhciB0ID0gdGhpczsKICAgICAgICAgICAgICAgIGlmICghdGhpcy5zZGtCb290ZWQpIHJldHVybiB0aGlzLnNka05vdEJvb3RlZEJ1dENhbGxlZCgpOwogICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNka0ltYUVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSB0aGlzLnBsYXllclNraW4uZ2V0VmlkZW9Cb3VuZHMoKTsKICAgICAgICAgICAgICAgICAgICAwICE9PSBuLndpZHRoICYmIDAgIT09IG4uaGVpZ2h0ID8gdGhpcy5pbWEucmVzaXplKG4ud2lkdGgsIG4uaGVpZ2h0KSA6IHNldFRpbWVvdXQoKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgICAgICB0LnJlc2l6ZSgpCiAgICAgICAgICAgICAgICAgICAgfSksIDEwMCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUub25NZXNzYWdlID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgaWYgKCJzdHJpbmciID09IHR5cGVvZiB0LmRhdGEudHlwZSkgc3dpdGNoICh0LmRhdGEudHlwZSkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgInRvZ2dsZU5vblBlcnNvbmFsaXplZCI6CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlTm9uUGVyc29uYWxpemVkKCEoIXQuZGF0YS5jb250ZW50IHx8ICF0LmRhdGEuY29udGVudC5ub25QZXJzb25hbGl6ZWQpKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAic2V0UGVyc29uYWxpemVkQURDb25zZW50IjoKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVOb25QZXJzb25hbGl6ZWQoISh0LmRhdGEuY29udGVudCAmJiB0LmRhdGEuY29udGVudC5jb25zZW50KSksIHRoaXMuc2V0Q29uc2VudFN0cmluZyh0LmRhdGEuY29udGVudCA/IHQuZGF0YS5jb250ZW50LmNvbnNlbnRTdHJpbmcgOiAiIik7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgImZvcmNlRGlzYWJsZUNvbW1lcmNpYWxCcmVhayI6CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZm9yY2VEaXNhYmxlQ29tbWVyY2lhbEJyZWFrID0gITAKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuc3RhcnRBZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNka0Jvb3RlZCkgcmV0dXJuIHRoaXMuc2RrTm90Qm9vdGVkQnV0Q2FsbGVkKCk7CiAgICAgICAgICAgICAgICB0aGlzLnNka0ltYUVycm9yIHx8ICh0aGlzLmFkUmVhZHkgPyAodGhpcy5wbGF5ZXJTa2luLnNob3coKSwgdGhpcy5yZXNpemUoKSwgdGhpcy5pbWEuc3RhcnRQbGF5YmFjaygpKSA6IGYuZGlzcGF0Y2hFdmVudChBLmFkcy5lcnJvciwgewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICJObyBhZHMgcmVhZHkgdG8gc3RhcnQiCiAgICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuc3RhcnRBZENsaWNrZWQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICJ1bmRlZmluZWQiICE9IHR5cGVvZiBuYXZpZ2F0b3IgJiYgLyhpUGFkfGlQaG9uZXxpUG9kKS9naS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpICYmIHRoaXMuc3RhcnRBZEVuYWJsZWQgJiYgKHRoaXMuc3RhcnRBZEVuYWJsZWQgPSAhMSwgdGhpcy5wbGF5ZXJTa2luLmhpZGVTdGFydEFkQnV0dG9uKCksIHRoaXMuaW1hLnN0YXJ0SU9TUGxheWJhY2soKSkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuc3RvcEFkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc2RrQm9vdGVkKSByZXR1cm4gdGhpcy5zZGtOb3RCb290ZWRCdXRDYWxsZWQoKTsKICAgICAgICAgICAgICAgIHRoaXMuc2RrSW1hRXJyb3IgfHwgKHRoaXMud2F0ZXJmYWxsLnN0b3BXYXRlcmZhbGwoKSwgdGhpcy5pbWEuc3RvcFBsYXliYWNrKCksIHRoaXMucGxheWVyU2tpbi5oaWRlKCkpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLnJlc3VtZUFkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuc2RrQm9vdGVkKSByZXR1cm4gdGhpcy5zZGtOb3RCb290ZWRCdXRDYWxsZWQoKTsKICAgICAgICAgICAgICAgIHRoaXMuc2RrSW1hRXJyb3IgfHwgKHRoaXMucGxheWVyU2tpbi5oaWRlUGF1c2VCdXR0b24oKSwgdGhpcy5pbWEucmVzdW1lQWQoKSkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuc2tpcEFkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB0aGlzLnN0b3BBZCgpLCB0aGlzLmNhbGxIYW5kbGVyKCJvbkZpbmlzaCIsIHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiBBLmFkcy5jb21wbGV0ZWQsCiAgICAgICAgICAgICAgICAgICAgcmV3YXJkQWxsb3dlZDogITAKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLm11dGVBZCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgaWYgKCF0aGlzLnNka0Jvb3RlZCkgcmV0dXJuIHRoaXMuc2RrTm90Qm9vdGVkQnV0Q2FsbGVkKCk7CiAgICAgICAgICAgICAgICB0aGlzLnNka0ltYUVycm9yIHx8IHRoaXMuaW1hLm11dGVBZCgpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLnJlZ2lzdGVySGFuZGxlciA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlcnNbdF0gPSBuCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLmNhbGxIYW5kbGVyID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgbiA9IFtdLCBlID0gMTsgZSA8IGFyZ3VtZW50cy5sZW5ndGg7IGUrKykgbltlIC0gMV0gPSBhcmd1bWVudHNbZV07CiAgICAgICAgICAgICAgICAiZnVuY3Rpb24iID09IHR5cGVvZiB0aGlzLmhhbmRsZXJzW3RdICYmIHRoaXMuaGFuZGxlcnNbdF0obikKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuc2V0dXBEZWZhdWx0RXZlbnRzID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICB2YXIgdCA9IHRoaXM7CiAgICAgICAgICAgICAgICBmLmFkZEV2ZW50TGlzdGVuZXIoQS5yZWFkeSwgKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHQuc2RrQm9vdGVkID0gITAsIHQuY2FsbEhhbmRsZXIoIm9uUmVhZHkiKQogICAgICAgICAgICAgICAgfSkpLCBmLmFkZEV2ZW50TGlzdGVuZXIoQS5hZGJsb2NrZWQsIChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB0LnNka0Jvb3RlZCA9ICEwLCB0LnNka0ltYUVycm9yID0gITAsIHQuY2FsbEhhbmRsZXIoIm9uQWRibG9ja2VkIikKICAgICAgICAgICAgICAgIH0pKSwgZi5hZGRFdmVudExpc3RlbmVyKEEuYWRzLnJlYWR5LCAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdC5hZFJlYWR5ID0gITAsIHQuYXV0b1N0YXJ0T25SZWFkeSAmJiB0LnN0YXJ0QWQoKQogICAgICAgICAgICAgICAgfSkpLCBmLmFkZEV2ZW50TGlzdGVuZXIoQS5hZHMuc3RhcnRlZCwgKGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHQucGxheWVyU2tpbi5oaWRlU3Bpbm5lcigpLCB0LmNhbGxIYW5kbGVyKCJvblN0YXJ0IiwgewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBBLmFkcy5saW1pdAogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9KSksIGYuYWRkRXZlbnRMaXN0ZW5lcihBLmFkcy52aWRlby5wYXVzZWQsIChmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB0LnBsYXllclNraW4uc2hvd1BhdXNlQnV0dG9uKCkKICAgICAgICAgICAgICAgIH0pKSwgZi5hZGRFdmVudExpc3RlbmVyKEEuYWRzLmxpbWl0LCAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdC5jYWxsSGFuZGxlcigib25GaW5pc2giLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IEEuYWRzLmxpbWl0LAogICAgICAgICAgICAgICAgICAgICAgICByZXdhcmRBbGxvd2VkOiAhMQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9KSksIGYuYWRkRXZlbnRMaXN0ZW5lcihBLmFkcy5zdG9wcGVkLCAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdC5jYWxsSGFuZGxlcigib25GaW5pc2giLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IEEuYWRzLnN0b3BwZWQsCiAgICAgICAgICAgICAgICAgICAgICAgIHJld2FyZEFsbG93ZWQ6ICExCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0pKSwgZi5hZGRFdmVudExpc3RlbmVyKEEuYWRzLmVycm9yLCAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdC5jYWxsSGFuZGxlcigib25GaW5pc2giLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IEEuYWRzLmVycm9yLAogICAgICAgICAgICAgICAgICAgICAgICByZXdhcmRBbGxvd2VkOiAhMQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9KSksIGYuYWRkRXZlbnRMaXN0ZW5lcihBLmFkcy5idXN5LCAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgdC5jYWxsSGFuZGxlcigib25GaW5pc2giLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IEEuYWRzLmJ1c3ksCiAgICAgICAgICAgICAgICAgICAgICAgIHJld2FyZEFsbG93ZWQ6ICExCiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0pKSwgZi5hZGRFdmVudExpc3RlbmVyKEEuYWRzLmNvbXBsZXRlZCwgKGZ1bmN0aW9uKG4pIHsKICAgICAgICAgICAgICAgICAgICB0LmNhbGxIYW5kbGVyKCJvbkZpbmlzaCIsIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogQS5hZHMuY29tcGxldGVkLAogICAgICAgICAgICAgICAgICAgICAgICByZXdhcmRBbGxvd2VkOiAhIW4ucmV3YXJkQWxsb3dlZAogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9KSksIFtBLmFkcy5saW1pdCwgQS5hZHMuc3RvcHBlZCwgQS5hZHMuZXJyb3IsIEEuYWRzLmJ1c3ksIEEuYWRzLmNvbXBsZXRlZF0uZm9yRWFjaCgoZnVuY3Rpb24obikgewogICAgICAgICAgICAgICAgICAgIGYuYWRkRXZlbnRMaXN0ZW5lcihuLCAoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHQucGxheWVyU2tpbiAmJiB0LnBsYXllclNraW4uaGlkZSgpLCB0LmFkUmVhZHkgPSAhMQogICAgICAgICAgICAgICAgICAgIH0pKQogICAgICAgICAgICAgICAgfSkpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLmdlbmVyaWNDcml0ZXJpYSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdmFyIHQgPSB7fSwKICAgICAgICAgICAgICAgICAgICBuID0gZW5jb2RlVVJJQ29tcG9uZW50KFQoInRhZyIpIHx8ICIiKSwKICAgICAgICAgICAgICAgICAgICBlID0gZW5jb2RlVVJJQ29tcG9uZW50KFQoInNpdGVfaWQiKSB8fCAiIiksCiAgICAgICAgICAgICAgICAgICAgaSA9IGVuY29kZVVSSUNvbXBvbmVudChUKCJleHBlcmltZW50IikgfHwgIiIpLAogICAgICAgICAgICAgICAgICAgIHIgPSBlbmNvZGVVUklDb21wb25lbnQoVCgiY2F0ZWdvcmllcyIpIHx8ICIiKTsKICAgICAgICAgICAgICAgIHJldHVybiB0LnRhZyA9IG4sIHQudGFnX3NpdGUgPSBuICsgInwiICsgZSwgdC5zaXRlX2lkID0gZSwgdC5leHBlcmltZW50ID0gaSwgdC5jYXRlZ29yaWVzID0gciwgdGhpcy5wcm9ncmFtbWF0aWNBZHNFbmFibGVkIHx8ICh0LmRpc2FibGVfcHJvZ3JhbW1hdGljID0gMSksIHQKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuc2V0Vm9sdW1lID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdGhpcy5pbWEgJiYgdGhpcy5pbWEuc2V0Vm9sdW1lKHQpCiAgICAgICAgICAgIH0sIHQuR2V0SXNQb2tpUGxhdGZvcm0gPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0LmlzUG9raVBsYXRmb3JtCiAgICAgICAgICAgIH0sIHQuR2V0SXNQb2tpSUZyYW1lID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gKHBhcnNlSW50KFQoInNpdGVfaWQiKSwgMTApIHx8IDApID4gMAogICAgICAgICAgICB9LCB0LmNoaWxkRGlyZWN0ZWQgPSAhMSwgdC5pc1Bva2lQbGF0Zm9ybSA9ICExLCB0Lm5vblBlcnNvbmFsaXplZCA9ICExLCB0LmNvbnNlbnRTdHJpbmcgPSAiIiwgdAogICAgICAgIH0oKTsKCiAgICBmdW5jdGlvbiBTdCh0KSB7CiAgICAgICAgc3dpdGNoIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCkpIHsKICAgICAgICAgICAgY2FzZSAiW29iamVjdCBFcnJvcl0iOgogICAgICAgICAgICBjYXNlICJbb2JqZWN0IEV4Y2VwdGlvbl0iOgogICAgICAgICAgICBjYXNlICJbb2JqZWN0IERPTUV4Y2VwdGlvbl0iOgogICAgICAgICAgICAgICAgcmV0dXJuICEwOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBFcnJvcgogICAgICAgIH0KICAgIH0KICAgIHZhciBFdCA9IGRvY3VtZW50LmxvY2F0aW9uLmhvc3RuYW1lOwogICAgRXQuZW5kc1dpdGgoInBva2ktZ2RuLmNvbSIpICYmIChFdCA9ICJwb2tpLWdkbi5jb20iKTsKICAgIHZhciB4dCwgVHQgPSBEYXRlLm5vdygpLAogICAgICAgIHp0ID0gKHh0ID0gbmV3IFJlZ0V4cCgicG9raV9lcnJ1aWQiICsgIj0oW147XSspKD86O3wkKSIpLmV4ZWMoZG9jdW1lbnQuY29va2llKSkgPyB4dFsxXSA6ICIiOwoKICAgIGZ1bmN0aW9uIEN0KHQpIHsKICAgICAgICBpZiAoYnQuZ2FtZUlkICYmIGJ0LnZlcnNpb25JZCkgewogICAgICAgICAgICBpZiAoIShEYXRlLm5vdygpIDwgVHQpKSB7CiAgICAgICAgICAgICAgICB6dCB8fCBmdW5jdGlvbih0LCBuLCBlKSB7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuY29va2llID0gdCArICI9IiArIG4gKyAiOyBwYXRoPS87IHNhbWVzaXRlPWxheDsgbWF4LWFnZT0iICsgKGUgfHwgNjMwNzJlMykgKyAiOyBkb21haW49IiArIEV0CiAgICAgICAgICAgICAgICB9KCJwb2tpX2VycnVpZCIsIHp0ID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpKTsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG4gPSBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnaWQ6IGJ0LmdhbWVJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZDogYnQudmVyc2lvbklkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmU6IDcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuOiB0Lm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtOiB0Lm1lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzOiBKU09OLnN0cmluZ2lmeSh0LnN0YWNrKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVpOiB6dAogICAgICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICAgICAgZSA9ICJodHRwczovL3QucG9raS5pby9nZSI7CiAgICAgICAgICAgICAgICAgICAgaWYgKG5hdmlnYXRvci5zZW5kQmVhY29uKSBuYXZpZ2F0b3Iuc2VuZEJlYWNvbihlLCBuKTsKICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkgPSBuZXcgWE1MSHR0cFJlcXVlc3Q7CiAgICAgICAgICAgICAgICAgICAgICAgIGkub3BlbigiUE9TVCIsIGUsICEwKSwgaS5zZW5kKG4pCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIFR0ID0gRGF0ZS5ub3coKSArIDEwMAogICAgICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IodCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSBjb25zb2xlLmxvZyh0KQogICAgfQoKICAgIGZ1bmN0aW9uIEl0KHQpIHsKICAgICAgICByZXR1cm4gImZ1bmN0aW9uIiA9PSB0eXBlb2YgdAogICAgfQoKICAgIGZ1bmN0aW9uIF90KHQsIG4pIHsKICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsIG4pCiAgICB9CgogICAgZnVuY3Rpb24gQnQodCwgbiwgZSkgewogICAgICAgIGlmIChudWxsICE9IHQpIHsKICAgICAgICAgICAgdmFyIGkgPSB0W25dOwogICAgICAgICAgICBpICYmIGkuX19wb2tpX18gfHwgKHRbbl0gPSBlKGkpLCB0W25dLl9fcG9raV9fID0gITAsIHRbbl0uX19vcmlnX18gPSBpKQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBQdCh0KSB7CiAgICAgICAgaWYgKCFJdCh0KSkgcmV0dXJuIHQ7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKHQuX19wb2tpX18pIHJldHVybiB0OwogICAgICAgICAgICBpZiAodC5fX3Bva2lfd3JhcHBlcl9fKSByZXR1cm4gdC5fX3Bva2lfd3JhcHBlcl9fCiAgICAgICAgfSBjYXRjaCAobikgewogICAgICAgICAgICByZXR1cm4gdAogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gbigpIHsKICAgICAgICAgICAgZm9yICh2YXIgbiA9IFtdLCBlID0gYXJndW1lbnRzLmxlbmd0aDsgZS0tOykgbltlXSA9IFB0KGFyZ3VtZW50c1tlXSk7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICB2YXIgaSA9IHQuYXBwbHkodGhpcywgbik7CiAgICAgICAgICAgICAgICByZXR1cm4gd2luZG93LnBva2lMYXN0Q2F0Y2ggPSBudWxsLCBpCiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgIHRocm93IHdpbmRvdy5wb2tpTGFzdENhdGNoID0gdCwgdAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZvciAodmFyIGUgaW4gdCkgX3QodCwgZSkgJiYgKG5bZV0gPSB0W2VdKTsKICAgICAgICByZXR1cm4gbi5wcm90b3R5cGUgPSB0LnByb3RvdHlwZSwgdC5fX3Bva2lfd3JhcHBlcl9fID0gbiwgbi5fX3Bva2lfXyA9ICEwLCBuLl9fb3JpZ19fID0gdCwgbgogICAgfQoKICAgIGZ1bmN0aW9uIER0KHQpIHsKICAgICAgICByZXR1cm4gZnVuY3Rpb24obiwgZSkgewogICAgICAgICAgICBmb3IgKHZhciBpID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGgpLCByID0gMDsgciA8IGkubGVuZ3RoOyArK3IpIGlbcl0gPSBhcmd1bWVudHNbcl07CiAgICAgICAgICAgIHZhciBvID0gaVswXTsKICAgICAgICAgICAgcmV0dXJuIEl0KG8pICYmIChpWzBdID0gUHQobykpLCB0LmFwcGx5ID8gdC5hcHBseSh0aGlzLCBpKSA6IHQoaVswXSwgaVsxXSkKICAgICAgICB9CiAgICB9CiAgICBpZiAoInVuZGVmaW5lZCIgIT0gdHlwZW9mIHdpbmRvdykgewogICAgICAgIGwuYS5yZW1vdGVGZXRjaGluZyA9ICExLCBsLmEucmVwb3J0LnN1YnNjcmliZSgoZnVuY3Rpb24odCkgewogICAgICAgICAgICBpZiAoIlNjcmlwdCBlcnJvci4iID09PSB0Lm1lc3NhZ2UgJiYgd2luZG93LnBva2lMYXN0Q2F0Y2gpIHsKICAgICAgICAgICAgICAgIHZhciBuID0gd2luZG93LnBva2lMYXN0Q2F0Y2g7CiAgICAgICAgICAgICAgICB3aW5kb3cucG9raUxhc3RDYXRjaCA9IG51bGwsIGwuYS5yZXBvcnQobikKICAgICAgICAgICAgfSBlbHNlIEN0KHQpCiAgICAgICAgfSkpLCB3aW5kb3cub251bmhhbmRsZWRyZWplY3Rpb24gPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgIFN0KHQucmVhc29uKSA/IGwuYS5yZXBvcnQodC5yZWFzb24pIDogQ3QoewogICAgICAgICAgICAgICAgbmFtZTogInVuaGFuZGxlZHJlamVjdGlvbiIsCiAgICAgICAgICAgICAgICBtZXNzYWdlOiBKU09OLnN0cmluZ2lmeSh0LnJlYXNvbikKICAgICAgICAgICAgfSkKICAgICAgICB9OwogICAgICAgICJiZDZiZGQ5ZS0zM2E5LTExZWEtYTA4YS1hY2RlNDgwMDExMjIiID09PSBidC5nYW1lSWQgJiYgKFsiRXZlbnRUYXJnZXQiLCAiV2luZG93IiwgIk5vZGUiLCAiQXBwbGljYXRpb25DYWNoZSIsICJBdWRpb1RyYWNrTGlzdCIsICJDaGFubmVsTWVyZ2VyTm9kZSIsICJDcnlwdG9PcGVyYXRpb24iLCAiRXZlbnRTb3VyY2UiLCAiRmlsZVJlYWRlciIsICJIVE1MVW5rbm93bkVsZW1lbnQiLCAiSURCRGF0YWJhc2UiLCAiSURCUmVxdWVzdCIsICJJREJUcmFuc2FjdGlvbiIsICJLZXlPcGVyYXRpb24iLCAiTWVkaWFDb250cm9sbGVyIiwgIk1lc3NhZ2VQb3J0IiwgIk1vZGFsV2luZG93IiwgIk5vdGlmaWNhdGlvbiIsICJTVkdFbGVtZW50SW5zdGFuY2UiLCAiU2NyZWVuIiwgIlRleHRUcmFjayIsICJUZXh0VHJhY2tDdWUiLCAiVGV4dFRyYWNrTGlzdCIsICJXZWJTb2NrZXQiLCAiV2ViU29ja2V0V29ya2VyIiwgIldvcmtlciIsICJYTUxIdHRwUmVxdWVzdCIsICJYTUxIdHRwUmVxdWVzdEV2ZW50VGFyZ2V0IiwgIlhNTEh0dHBSZXF1ZXN0VXBsb2FkIl0uZm9yRWFjaCgoZnVuY3Rpb24odCkgewogICAgICAgICAgICByZXR1cm4gbiA9IHQsIHZvaWQoKGUgPSB3aW5kb3dbbl0gJiYgd2luZG93W25dLnByb3RvdHlwZSkgJiYgZS5oYXNPd25Qcm9wZXJ0eSAmJiBlLmhhc093blByb3BlcnR5KCJhZGRFdmVudExpc3RlbmVyIikgJiYgKEJ0KGUsICJhZGRFdmVudExpc3RlbmVyIiwgKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihuLCBlLCBpLCByKSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgZSAmJiBlLmhhbmRsZUV2ZW50ICYmIChlLmhhbmRsZUV2ZW50ID0gUHQoZS5oYW5kbGVFdmVudCkpCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkge30KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5jYWxsKHRoaXMsIG4sIFB0KGUpLCBpLCByKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KSksIEJ0KGUsICJyZW1vdmVFdmVudExpc3RlbmVyIiwgKGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihuLCBlLCBpLCByKSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgZSA9IGUgJiYgKGUuX19wb2tpX3dyYXBwZXJfXyA/IGUuX19wb2tpX3dyYXBwZXJfXyA6IGUpCiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkge30KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5jYWxsKHRoaXMsIG4sIGUsIGksIHIpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pKSkpOwogICAgICAgICAgICB2YXIgbiwgZQogICAgICAgIH0pKSwgQnQod2luZG93LCAic2V0VGltZW91dCIsIER0KSwgQnQod2luZG93LCAic2V0SW50ZXJ2YWwiLCBEdCksIHZvaWQgMCAhPT0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSAmJiBCdCh3aW5kb3csICJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCAoZnVuY3Rpb24odCkgewogICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24obikgewogICAgICAgICAgICAgICAgcmV0dXJuIHQoUHQobikpCiAgICAgICAgICAgIH0KICAgICAgICB9KSkpCiAgICB9CiAgICB2YXIgTHQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgcmV0dXJuIChMdCA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgZm9yICh2YXIgbiwgZSA9IDEsIGkgPSBhcmd1bWVudHMubGVuZ3RoOyBlIDwgaTsgZSsrKQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHIgaW4gbiA9IGFyZ3VtZW50c1tlXSkgT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG4sIHIpICYmICh0W3JdID0gbltyXSk7CiAgICAgICAgICAgICAgICByZXR1cm4gdAogICAgICAgICAgICB9KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpCiAgICAgICAgfSwKICAgICAgICBPdCA9IG5ldyhmdW5jdGlvbigpIHsKICAgICAgICAgICAgZnVuY3Rpb24gdCgpIHsKICAgICAgICAgICAgICAgIHZhciB0ID0gdGhpczsKICAgICAgICAgICAgICAgIHRoaXMuZ2FtZVN0YXJ0ZWQgPSAhMSwgdGhpcy5TREsgPSBuZXcga3QsIHRoaXMuZ2FtZXBsYXlTdGFydENvdW50ZXIgPSAwLCB0aGlzLmdhbWVwbGF5U3RvcENvdW50ZXIgPSAwLCB0aGlzLmluaXQgPSBmdW5jdGlvbihuKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZvaWQgMCA9PT0gbiAmJiAobiA9IHt9KSwgbmV3IFByb21pc2UoKGZ1bmN0aW9uKGUsIGkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbiAmJiBuLmFkVGFnVXJsICYmIHdpbmRvdyAmJiAod2luZG93Ll9fSW50ZXJuYWxTREsgPSB0LlNESyksIHQuU0RLLmluaXQoTHQoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb25SZWFkeTogZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQWRibG9ja2VkOiBpCiAgICAgICAgICAgICAgICAgICAgICAgIH0sIG4pKSwgZy5zZW5kTWVzc2FnZShBLm1lc3NhZ2Uuc2RrRGV0YWlscywgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmVyc2lvbjogIjIuMTUwLjAiCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgfSkpCiAgICAgICAgICAgICAgICB9LCB0aGlzLmluaXRXaXRoVmlkZW9IQiA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB0LmluaXQoKQogICAgICAgICAgICAgICAgfSwgdGhpcy5nYW1lTG9hZGluZ1Byb2dyZXNzID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgIHZhciBuID0ge307CiAgICAgICAgICAgICAgICAgICAgdm9pZCAwICE9PSB0LnBlcmNlbnRhZ2VEb25lICYmIChuLnBlcmNlbnRhZ2VEb25lID0gTnVtYmVyKHQucGVyY2VudGFnZURvbmUpKSwgdm9pZCAwICE9PSB0LmtiTG9hZGVkICYmIChuLmtiTG9hZGVkID0gTnVtYmVyKHQua2JMb2FkZWQpKSwgdm9pZCAwICE9PSB0LmtiVG90YWwgJiYgKG4ua2JUb3RhbCA9IE51bWJlcih0LmtiVG90YWwpKSwgdm9pZCAwICE9PSB0LmZpbGVOYW1lTG9hZGVkICYmIChuLmZpbGVOYW1lTG9hZGVkID0gU3RyaW5nKHQuZmlsZU5hbWVMb2FkZWQpKSwgdm9pZCAwICE9PSB0LmZpbGVzTG9hZGVkICYmIChuLmZpbGVzTG9hZGVkID0gTnVtYmVyKHQuZmlsZXNMb2FkZWQpKSwgdm9pZCAwICE9PSB0LmZpbGVzVG90YWwgJiYgKG4uZmlsZXNUb3RhbCA9IE51bWJlcih0LmZpbGVzVG90YWwpKSwgeS50cmFjayhBLnRyYWNraW5nLnNjcmVlbi5nYW1lTG9hZGluZ1Byb2dyZXNzLCBuKQogICAgICAgICAgICAgICAgfSwgdGhpcy5nYW1lTG9hZGluZ1N0YXJ0ID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgeS50cmFjayhBLnRyYWNraW5nLnNjcmVlbi5nYW1lTG9hZGluZ1N0YXJ0ZWQpCiAgICAgICAgICAgICAgICB9LCB0aGlzLmdhbWVMb2FkaW5nRmluaXNoZWQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB5LnRyYWNrKEEudHJhY2tpbmcuc2NyZWVuLmdhbWVMb2FkaW5nRmluaXNoZWQpCiAgICAgICAgICAgICAgICB9LCB0aGlzLmdhbWVwbGF5U3RhcnQgPSBmdW5jdGlvbihuKSB7CiAgICAgICAgICAgICAgICAgICAgdC5nYW1lcGxheVN0YXJ0Q291bnRlcisrLCB0LmdhbWVTdGFydGVkIHx8ICh0LmdhbWVTdGFydGVkID0gITAsIHkudHJhY2soQS50cmFja2luZy5zY3JlZW4uZmlyc3RSb3VuZCksIHQuU0RLLnN0YXJ0U3RhcnRBZHNBZnRlclRpbWVyKCkpLCB5LnRyYWNrKEEudHJhY2tpbmcuc2NyZWVuLmdhbWVwbGF5U3RhcnQsIEx0KEx0KHt9LCBuKSwgewogICAgICAgICAgICAgICAgICAgICAgICBwbGF5SWQ6IHQuZ2FtZXBsYXlTdGFydENvdW50ZXIKICAgICAgICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgICAgIH0sIHRoaXMuZ2FtZUludGVyYWN0aXZlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgeS50cmFjayhBLnRyYWNraW5nLnNjcmVlbi5nYW1lSW50ZXJhY3RpdmUpCiAgICAgICAgICAgICAgICB9LCB0aGlzLmdhbWVwbGF5U3RvcCA9IGZ1bmN0aW9uKG4pIHsKICAgICAgICAgICAgICAgICAgICB0LmdhbWVwbGF5U3RvcENvdW50ZXIrKywgeS50cmFjayhBLnRyYWNraW5nLnNjcmVlbi5nYW1lcGxheVN0b3AsIEx0KEx0KHt9LCBuKSwgewogICAgICAgICAgICAgICAgICAgICAgICBwbGF5SWQ6IHQuZ2FtZXBsYXlTdGFydENvdW50ZXIsCiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3BJZDogdC5nYW1lcGxheVN0b3BDb3VudGVyCiAgICAgICAgICAgICAgICAgICAgfSkpCiAgICAgICAgICAgICAgICB9LCB0aGlzLnJvdW5kU3RhcnQgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICAgICAgdm9pZCAwID09PSB0ICYmICh0ID0gIiIpLCB0ID0gU3RyaW5nKHQpLCB5LnRyYWNrKEEudHJhY2tpbmcuc2NyZWVuLnJvdW5kU3RhcnQsIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWRlbnRpZmllcjogdAogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9LCB0aGlzLnJvdW5kRW5kID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgIHZvaWQgMCA9PT0gdCAmJiAodCA9ICIiKSwgdCA9IFN0cmluZyh0KSwgeS50cmFjayhBLnRyYWNraW5nLnNjcmVlbi5yb3VuZEVuZCwgewogICAgICAgICAgICAgICAgICAgICAgICBpZGVudGlmaWVyOiB0CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0sIHRoaXMuY3VzdG9tRXZlbnQgPSBmdW5jdGlvbihuLCBlLCBpKSB7CiAgICAgICAgICAgICAgICAgICAgdm9pZCAwID09PSBpICYmIChpID0ge30pLCBuICYmIGUgPyAobiA9IFN0cmluZyhuKSwgZSA9IFN0cmluZyhlKSwgaSA9IEx0KHt9LCBpKSwgeS50cmFjayhBLnRyYWNraW5nLmN1c3RvbSwgewogICAgICAgICAgICAgICAgICAgICAgICBldmVudE5vdW46IG4sCiAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50VmVyYjogZSwKICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnREYXRhOiBpCiAgICAgICAgICAgICAgICAgICAgfSkpIDogdC5lcnJvcigiY3VzdG9tRXZlbnQiLCAiY3VzdG9tRXZlbnQgbmVlZHMgYXQgbGVhc3QgYSBub3VuIGFuZCBhIHZlcmIiKQogICAgICAgICAgICAgICAgfSwgdGhpcy5jb21tZXJjaWFsQnJlYWsgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKGZ1bmN0aW9uKG4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB0LmdhbWVTdGFydGVkID8gQS5hZHMucG9zaXRpb24ubWlkcm9sbCA6IEEuYWRzLnBvc2l0aW9uLnByZXJvbGw7CiAgICAgICAgICAgICAgICAgICAgICAgIGYuY2xlYXJBbm5vdGF0aW9ucygpLCBmLnNldERhdGFBbm5vdGF0aW9ucyh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcHBvcnR1bml0eUlkOiBmdCgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGUKICAgICAgICAgICAgICAgICAgICAgICAgfSksIHkudHJhY2soQS50cmFja2luZy5zY3JlZW4uY29tbWVyY2lhbEJyZWFrKSwgdC5TREsucmVxdWVzdEFkKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgb25GaW5pc2g6IG4KICAgICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgICAgIH0sIHRoaXMucmV3YXJkZWRCcmVhayA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgoZnVuY3Rpb24obikgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IEEuYWRzLnBvc2l0aW9uLnJld2FyZGVkOwogICAgICAgICAgICAgICAgICAgICAgICBmLmNsZWFyQW5ub3RhdGlvbnMoKSwgZi5zZXREYXRhQW5ub3RhdGlvbnMoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3Bwb3J0dW5pdHlJZDogZnQoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBlCiAgICAgICAgICAgICAgICAgICAgICAgIH0pLCB5LnRyYWNrKEEudHJhY2tpbmcuc2NyZWVuLnJld2FyZGVkQnJlYWspLCB0LlNESy5yZXF1ZXN0QWQoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkZpbmlzaDogZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQubGVuZ3RoID4gMCA/IG4odFswXS5yZXdhcmRBbGxvd2VkKSA6IG4oITEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgfSkpCiAgICAgICAgICAgICAgICB9LCB0aGlzLmhhcHB5VGltZSA9IGZ1bmN0aW9uKG4pIHsKICAgICAgICAgICAgICAgICAgICB2b2lkIDAgPT09IG4gJiYgKG4gPSAxKSwgKChuID0gTnVtYmVyKG4pKSA8IDAgfHwgbiA+IDEpICYmIChuID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oMSwgbikpLCB0Lndhcm5pbmcoImhhcHB5VGltZSIsICJJbnRlbnNpdHkgc2hvdWxkIGJlIGEgdmFsdWUgYmV0d2VlbiAwIGFuZCAxLCBhZGp1c3RlZCB0byAiICsgbikpLCB5LnRyYWNrKEEudHJhY2tpbmcuc2NyZWVuLmhhcHB5VGltZSwgewogICAgICAgICAgICAgICAgICAgICAgICBpbnRlbnNpdHk6IG4KICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSwgdGhpcy5tdXRlQWQgPSBmdW5jdGlvbigpIHsKICAgICAgICAgICAgICAgICAgICB0LlNESy5tdXRlQWQoKQogICAgICAgICAgICAgICAgfSwgdGhpcy5zZXRQbGF5ZXJBZ2UgPSBmdW5jdGlvbihuKSB7CiAgICAgICAgICAgICAgICAgICAgeS50cmFjayhBLnRyYWNraW5nLnNldFBsYXllckFnZSwgewogICAgICAgICAgICAgICAgICAgICAgICBhZ2U6IG4KICAgICAgICAgICAgICAgICAgICB9KSwgbiAmJiB0LlNESy5zZXRQbGF5ZXJBZ2UobikKICAgICAgICAgICAgICAgIH0sIHRoaXMudG9nZ2xlUGxheWVyQWR2ZXJ0aXNpbmdDb25zZW50ID0gZnVuY3Rpb24obikgewogICAgICAgICAgICAgICAgICAgIHkudHJhY2soQS50cmFja2luZy50b2dnbGVQbGF5ZXJBZHZlcnRpc2luZ0NvbnNlbnQsIHsKICAgICAgICAgICAgICAgICAgICAgICAgZGlkQ29uc2VudDogbgogICAgICAgICAgICAgICAgICAgIH0pLCB0LlNESy50b2dnbGVQbGF5ZXJBZHZlcnRpc2luZ0NvbnNlbnQobiksIGcuc2VuZE1lc3NhZ2UoQS5tZXNzYWdlLnRvZ2dsZVByb2dyYW1tYXRpY0FkcywgewogICAgICAgICAgICAgICAgICAgICAgICBlbmFibGVkOiB0LlNESy5nZXRQcm9ncmFtbWF0aWNBZHNFbmFibGVkKCkKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgfSwgdGhpcy5sb2dFcnJvciA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgICAgICBTdCh0KSA/IHUucmVwb3J0KHQpIDogQ3QoewogICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAibG9nRXJyb3IiLAogICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBKU09OLnN0cmluZ2lmeSh0KQogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9LCB0aGlzLnNlbmRIaWdoc2NvcmUgPSBmdW5jdGlvbigpIHt9LCB0aGlzLnNldERlYnVnVG91Y2hPdmVybGF5Q29udHJvbGxlciA9IGZ1bmN0aW9uKG4pIHsKICAgICAgICAgICAgICAgICAgICB0LlNESy5kZWJ1Z1RvdWNoT3ZlcmxheUNvbnRyb2xsZXIgPSBuCiAgICAgICAgICAgICAgICB9LCB0aGlzLmdldExlYWRlcmJvYXJkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShbXSkKICAgICAgICAgICAgICAgIH0sIHRoaXMud2FybmluZyA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oIlBva2lTREsuIiArIHQgKyAiOiAiICsgbikKICAgICAgICAgICAgICAgIH0sIHRoaXMuZXJyb3IgPSBmdW5jdGlvbih0LCBuKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigiUG9raVNESy4iICsgdCArICI6ICIgKyBuKQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0LnByb3RvdHlwZS5zZXREZWJ1ZyA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHZvaWQgMCA9PT0gdCAmJiAodCA9ICEwKSwgdGhpcy5TREsuc2V0RGVidWcodCkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuZGlzYWJsZVByb2dyYW1tYXRpYyA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAgICAgdGhpcy5TREsuZGlzYWJsZVByb2dyYW1tYXRpYygpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLnRvZ2dsZU5vblBlcnNvbmFsaXplZCA9IGZ1bmN0aW9uKHQpIHsKICAgICAgICAgICAgICAgIHZvaWQgMCA9PT0gdCAmJiAodCA9ICExKSwgdGhpcy5TREsudG9nZ2xlTm9uUGVyc29uYWxpemVkKHQpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLnNldENvbnNlbnRTdHJpbmcgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICB0aGlzLlNESy5zZXRDb25zZW50U3RyaW5nKHQpCiAgICAgICAgICAgIH0sIHQucHJvdG90eXBlLmRpc3BsYXlBZCA9IGZ1bmN0aW9uKHQsIG4pIHsKICAgICAgICAgICAgICAgIHkudHJhY2soQS50cmFja2luZy5zY3JlZW4uZGlzcGxheUFkLCB7CiAgICAgICAgICAgICAgICAgICAgc2l6ZTogbgogICAgICAgICAgICAgICAgfSksIHRoaXMuU0RLLmRpc3BsYXlBZCh0LCBuKQogICAgICAgICAgICB9LCB0LnByb3RvdHlwZS5kZXN0cm95QWQgPSBmdW5jdGlvbih0KSB7CiAgICAgICAgICAgICAgICB0aGlzLlNESy5kZXN0cm95QWQodCkKICAgICAgICAgICAgfSwgdC5wcm90b3R5cGUuc2V0Vm9sdW1lID0gZnVuY3Rpb24odCkgewogICAgICAgICAgICAgICAgdGhpcy5TREsuc2V0Vm9sdW1lKHQpCiAgICAgICAgICAgIH0sIHQKICAgICAgICB9KCkpOwogICAgZm9yICh2YXIganQgaW4gT3QpIHdpbmRvdy5Qb2tpU0RLW2p0XSA9IE90W2p0XQp9XSk7"
            }(),
            i = document.createElement("script");
        i.setAttribute("src", r), i.setAttribute("type", "text/javascript"), i.onload = function() {
            return o.dequeue()
        }, document.head.appendChild(i)
    }
});
    </script>
  </head>
  <body>
    <script src="https://codehs.com/uploads/3fbb3b875331fe0c527094e5f3edb883"> </script>
  </body>
</html>